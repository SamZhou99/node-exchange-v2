(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f30a5c68"],{"04d1":function(t,e,i){var r=i("342f"),n=r.match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},"0b25":function(t,e,i){var r=i("da84"),n=i("5926"),a=i("50c4"),o=r.RangeError;t.exports=function(t){if(void 0===t)return 0;var e=n(t),i=a(e);if(e!==i)throw o("Wrong length or index");return i}},1448:function(t,e,i){var r=i("dfb9"),n=i("b6b7");t.exports=function(t,e){return r(n(t),e)}},"145e":function(t,e,i){"use strict";var r=i("7b0b"),n=i("23cb"),a=i("07fa"),o=Math.min;t.exports=[].copyWithin||function(t,e){var i=r(this),s=a(i),c=n(t,s),h=n(e,s),l=arguments.length>2?arguments[2]:void 0,u=o((void 0===l?s:n(l,s))-h,s-c),f=1;h<c&&c<h+u&&(f=-1,h+=u-1,c+=u-1);while(u-- >0)h in i?i[c]=i[h]:delete i[c],c+=f,h+=f;return i}},"170b":function(t,e,i){"use strict";var r=i("ebb5"),n=i("50c4"),a=i("23cb"),o=i("b6b7"),s=r.aTypedArray,c=r.exportTypedArrayMethod;c("subarray",(function(t,e){var i=s(this),r=i.length,c=a(t,r),h=o(i);return new h(i.buffer,i.byteOffset+c*i.BYTES_PER_ELEMENT,n((void 0===e?r:a(e,r))-c))}))},"182d":function(t,e,i){var r=i("da84"),n=i("f8cd"),a=r.RangeError;t.exports=function(t,e){var i=n(t);if(i%e)throw a("Wrong offset");return i}},"219c":function(t,e,i){"use strict";var r=i("da84"),n=i("e330"),a=i("d039"),o=i("59ed"),s=i("addb"),c=i("ebb5"),h=i("04d1"),l=i("d998"),u=i("2d00"),f=i("512ce"),d=r.Array,v=c.aTypedArray,p=c.exportTypedArrayMethod,y=r.Uint16Array,_=y&&n(y.prototype.sort),m=!!_&&!(a((function(){_(new y(2),null)}))&&a((function(){_(new y(2),{})}))),g=!!_&&!a((function(){if(u)return u<74;if(h)return h<67;if(l)return!0;if(f)return f<602;var t,e,i=new y(516),r=d(516);for(t=0;t<516;t++)e=t%4,i[t]=515-t,r[t]=t-2*e+3;for(_(i,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(i[t]!==r[t])return!0})),x=function(t){return function(e,i){return void 0!==t?+t(e,i)||0:i!==i?-1:e!==e?1:0===e&&0===i?1/e>0&&1/i<0?1:-1:e>i}};p("sort",(function(t){return void 0!==t&&o(t),g?_(this,t):s(v(this),x(t))}),!g||m)},"25a1":function(t,e,i){"use strict";var r=i("ebb5"),n=i("d58f").right,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("reduceRight",(function(t){var e=arguments.length;return n(a(this),t,e,e>1?arguments[1]:void 0)}))},2954:function(t,e,i){"use strict";var r=i("ebb5"),n=i("b6b7"),a=i("d039"),o=i("f36a"),s=r.aTypedArray,c=r.exportTypedArrayMethod,h=a((function(){new Int8Array(1).slice()}));c("slice",(function(t,e){var i=o(s(this),t,e),r=n(this),a=0,c=i.length,h=new r(c);while(c>a)h[a]=i[a++];return h}),h)},3280:function(t,e,i){"use strict";var r=i("ebb5"),n=i("2ba4"),a=i("e58c"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("lastIndexOf",(function(t){var e=arguments.length;return n(a,o(this),e>1?[t,arguments[1]]:[t])}))},"3a7b":function(t,e,i){"use strict";var r=i("ebb5"),n=i("b727").findIndex,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("findIndex",(function(t){return n(a(this),t,arguments.length>1?arguments[1]:void 0)}))},"3c5d":function(t,e,i){"use strict";var r=i("da84"),n=i("c65b"),a=i("ebb5"),o=i("07fa"),s=i("182d"),c=i("7b0b"),h=i("d039"),l=r.RangeError,u=r.Int8Array,f=u&&u.prototype,d=f&&f.set,v=a.aTypedArray,p=a.exportTypedArrayMethod,y=!h((function(){var t=new Uint8ClampedArray(2);return n(d,t,{length:1,0:3},1),3!==t[1]})),_=y&&a.NATIVE_ARRAY_BUFFER_VIEWS&&h((function(){var t=new u(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));p("set",(function(t){v(this);var e=s(arguments.length>1?arguments[1]:void 0,1),i=c(t);if(y)return n(d,this,i,e);var r=this.length,a=o(i),h=0;if(a+e>r)throw l("Wrong length");while(h<a)this[e+h]=i[h++]}),!y||_)},"3fcc":function(t,e,i){"use strict";var r=i("ebb5"),n=i("b727").map,a=i("b6b7"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("map",(function(t){return n(o(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(a(t))(e)}))}))},"4af0":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"futures"},[i("a-row",{attrs:{type:"flex"}},[i("a-col",{staticClass:"sp bg bg-h t-left",attrs:{flex:"220px"}},[i("a-row",{staticStyle:{height:"620px"}},[i("div",[t._v("USDT")]),i("table",{staticClass:"table-hover"},[i("thead",{staticClass:"list-title"},[i("td",{staticStyle:{width:"60px"}},[t._v("currency")]),i("td",{staticClass:"t-right list-sp",staticStyle:{width:"160px"}},[t._v("latest price")]),i("td",{staticClass:"t-right",staticStyle:{width:"auto"}},[t._v("increase")])]),i("tbody",{staticClass:"list-t"},t._l(this.list,(function(e){return i("tr",{key:e.id,on:{click:function(i){return t.onClickSymbol(e)}}},[i("td",[t._v(t._s(e.symbol))]),i("td",{staticClass:"t-right list-sp"},[t._v(t._s(e.priceUsd))]),i("td",{staticClass:"t-right list-sp",class:e.changePercent24Hr>0?"t-g":"t-r"},[t._v(t._s(e.changePercent24Hr))])])})),0)])]),i("a-row",[i("a-col",{attrs:{flex:"220px"}},[i("div",[t._v("杠杆账户")]),i("p",[t._v("杠杆交易在带来更多利润的同时，也蕴含巨大的风险，当市场出现急剧波动时，您的资产有被清算的风险。")]),this.g.userInfo?i("div",[i("div",[t._v(t._s(this.g.userInfo.account))]),i("div",[t._v("合约账户："+t._s(t.currContractUsdtAmount))])]):i("div",[i("a",[t._v("登录查看资产")])])])],1)],1),i("a-col",{staticClass:"sp bg t-left",attrs:{flex:"auto"}},[i("a-row",{staticStyle:{height:"480px",overflow:"hidden"},attrs:{type:"flex"}},[i("a-col",{attrs:{flex:"auto"}},[i("a-row",{staticClass:"t-left sp-2"},[i("a-col",[i("span",{staticClass:"symbol"},[t._v(t._s(t.symbolName)+"/USDT")]),i("span",{staticClass:"price t-g"},[t._v("$"+t._s(this.g.round(t.main.price,1,2)))]),i("span",{staticClass:"t-g",staticStyle:{"font-size":"0.25rem",width:"100px"}},[t._v(t._s(this.g.round(t.main.percent,2,2))+"% ")]),i("a-radio-group",{attrs:{"default-value":"1day","button-style":"solid",size:"small"},on:{change:t.onChangeKline},model:{value:t.radio.value,callback:function(e){t.$set(t.radio,"value",e)},expression:"radio.value"}},[i("a-radio-button",{staticClass:"radio-style",attrs:{value:"line"}},[t._v(" Line ")]),i("a-radio-button",{staticClass:"radio-style",attrs:{value:"1min"}},[t._v(" 1m ")]),i("a-radio-button",{staticClass:"radio-style",attrs:{value:"5min"}},[t._v(" 5m ")]),i("a-radio-button",{staticClass:"radio-style",attrs:{value:"15min"}},[t._v(" 15m ")]),i("a-radio-button",{staticClass:"radio-style",attrs:{value:"30min"}},[t._v(" 30m ")]),i("a-radio-button",{staticClass:"radio-style",attrs:{value:"60min"}},[t._v(" 1H ")]),i("a-radio-button",{staticClass:"radio-style",attrs:{value:"4hour"}},[t._v(" 4H ")]),i("a-radio-button",{staticClass:"radio-style",attrs:{value:"1day"}},[t._v(" 1D ")])],1)],1)],1),i("a-row",[i("div",[i("a-spin",{staticClass:"spin-content",attrs:{spinning:t.loading}},[i("div",{staticClass:"k-line-chart",attrs:{id:"custom-theme-k-line"}})])],1)])],1),i("a-col",{attrs:{flex:"300px"}},[i("a-col",{staticClass:"bg bg-h2 t-left"},[i("div",[t._v("Orderbook")]),i("table",{staticClass:"table-hover table-width100"},[i("thead",{staticClass:"list-title"},[i("td",{staticStyle:{width:"60px"}},[t._v("Price (USDT)")]),i("td",{staticClass:"t-right list-sp2",staticStyle:{width:"120px"}},[t._v("Amount ("+t._s(t.symbolName)+")")]),i("td",{staticClass:"t-right list-sp",staticStyle:{width:"auto"}},[t._v("Sum ("+t._s(t.symbolName)+")")])]),i("tbody",{staticClass:"list-t"},[t._l(this.orderbook_sell_list,(function(e,r){return i("tr",{key:e.id,staticClass:"pt-sell",style:{"background-size":e.percent+"% 100%"},attrs:{id:"s"+r},on:{click:function(i){return t.onClickOrderbook(e,"sell")}}},[i("td",{staticClass:"t-r"},[t._v(t._s(e.price))]),i("td",{staticClass:"t-right list-sp2"},[t._v(t._s(e.amount))]),i("td",{staticClass:"t-right list-sp"},[t._v(t._s(e.sum))])])})),i("tr",[i("td",{staticClass:"orderbook-bd",attrs:{colspan:"3"}},[i("div",{staticClass:"t-g",staticStyle:{"font-size":"1rem"}},[t._v(t._s(t.main.price)+" "),i("span",{staticClass:"t-gray",staticStyle:{"font-size":"0.75rem"}},[t._v("≈ "+t._s(t.main.price)+" USD")])])])]),t._l(this.orderbook_buy_list,(function(e,r){return i("tr",{key:e.id,staticClass:"pt-buy",style:{"background-size":e.percent+"% 100%"},attrs:{id:"b"+r},on:{click:function(i){return t.onClickOrderbook(e,"buy")}}},[i("td",{staticClass:"t-g",staticStyle:{width:"60px"}},[t._v(t._s(e.price))]),i("td",{staticClass:"t-right list-sp2"},[t._v(t._s(e.amount))]),i("td",{staticClass:"t-right list-sp"},[t._v(t._s(e.sum))])])}))],2)])])],1)],1),i("a-row",[i("div",[i("a-tabs",{staticStyle:{overflow:"hidden"},attrs:{"default-active-key":"1",tabBarStyle:{"border-bottom":"1px solid #091e45"},animated:!1},on:{change:t.onChangeCallback}},[i("a-tab-pane",{key:"1",attrs:{tab:"Market","force-render":""}},[i("a-row",[i("a-col",{staticStyle:{padding:"10px"},attrs:{span:12}},[i("a-input",{attrs:{type:"number","addon-before":"Buy Price","addon-after":"USDT","default-value":""},model:{value:t.currMarketBuyPrice,callback:function(e){t.currMarketBuyPrice=e},expression:"currMarketBuyPrice"}}),i("div",{staticStyle:{"padding-top":"15px"}},[i("a-input",{attrs:{"addon-before":"Buy Amount",type:"number","addon-after":t.symbolName,"default-value":""},model:{value:t.currMarketBuyAmount,callback:function(e){t.currMarketBuyAmount=e},expression:"currMarketBuyAmount"}})],1),i("a-slider",{attrs:{marks:t.slider.marks,"default-value":0,step:1},on:{change:t.onChangeBuySlider},model:{value:t.currMarketBuyLever,callback:function(e){t.currMarketBuyLever=e},expression:"currMarketBuyLever"}}),i("a-row",[i("a-col",{attrs:{span:2}},[t._v(" Sum ")]),i("a-col",{staticClass:"t-right"},[t._v(" "+t._s(t.currMarketBuySum)+" USDT ")]),i("a-col",[i("a-button",{attrs:{type:"primary",block:""}},[t._v("Buy")])],1)],1)],1),i("a-col",{staticStyle:{padding:"10px"},attrs:{span:12}},[i("a-input",{attrs:{type:"number","addon-before":"Sell Price","addon-after":"USDT","default-value":""},model:{value:t.currMarketSellPrice,callback:function(e){t.currMarketSellPrice=e},expression:"currMarketSellPrice"}}),i("div",{staticStyle:{"padding-top":"15px"}},[i("a-input",{attrs:{"addon-before":"Sell Amount",type:"number","addon-after":t.symbolName,"default-value":""},model:{value:t.currMarketSellAmount,callback:function(e){t.currMarketSellAmount=e},expression:"currMarketSellAmount"}})],1),i("a-slider",{attrs:{marks:t.slider.marks,"default-value":0,step:1},on:{change:t.onChangeSellSlider},model:{value:t.currMarketSellLever,callback:function(e){t.currMarketSellLever=e},expression:"currMarketSellLever"}}),i("a-row",[i("a-col",{attrs:{span:2}},[t._v(" Sum ")]),i("a-col",{staticClass:"t-right"},[t._v(" "+t._s(t.currMarketSellSum)+" USDT ")]),i("a-col",[i("a-button",{attrs:{type:"danger",block:""}},[t._v("Sell")])],1)],1)],1)],1)],1)],1)],1)])],1),i("a-col",{staticClass:"sp bg bg-h t-left",attrs:{flex:"300px"}},[i("div",[t._v("Market Trades")]),i("table",{staticClass:"table-width100"},[i("thead",{staticClass:"list-title"},[i("td",{staticStyle:{width:"60px"}},[t._v("Time")]),i("td",{staticClass:"t-right list-sp3",staticStyle:{width:"130px"}},[t._v("Price (USDT)")]),i("td",{staticClass:"t-right list-sp",staticStyle:{width:"auto"}},[t._v("Amount ("+t._s(t.symbolName)+")")])]),i("tbody",{staticClass:"list-t"},t._l(this.market_trades_list,(function(e){return i("tr",{key:e.id},[i("td",[t._v(t._s(e.time))]),i("td",{staticClass:"t-right list-sp3",class:"buy"==e.act?"t-g":"t-r"},[t._v(t._s(e.price))]),i("td",{staticClass:"t-right list-sp"},[t._v(t._s(e.amount))])])})),0)])])],1),i("a-row",{staticClass:"sp-2 bg t-left",attrs:{type:"flex"}},[i("a-col",{staticClass:"sp",attrs:{flex:"auto"}},[i("div",[i("div",[i("a-tabs",{staticClass:"tabs-bar",attrs:{"default-active-key":"1",tabBarStyle:{"border-bottom":"1px solid #091e45"}},on:{change:t.onChangeCallback}},[i("a-tab-pane",{key:"1",attrs:{tab:"当前委托"}},[i("table",{staticClass:"table-width100 t-b t-1r"},[i("tr",[i("td",[t._v("时间")]),i("td",[t._v("交易对")]),i("td",[t._v("方式")]),i("td",[t._v("方向")]),i("td",[t._v("价格(USDT)")]),i("td",[t._v("委托量")]),i("td",[t._v("已成交("+t._s(t.symbolName)+")")]),i("td",[t._v("成交均价")]),i("td",[t._v("成交额(USDT)")]),i("td",[t._v("状态")]),i("td",[t._v("操作")])]),i("tr",[i("td",{attrs:{colspan:"11"}},[i("a-empty",{attrs:{image:"//assets99.oss-cn-hongkong.aliyuncs.com/images/no-data.png","image-style":{height:"60px"}}})],1)])])]),i("a-tab-pane",{key:"2",attrs:{tab:"委托历史","force-render":""}},[i("table",{staticClass:"table-width100 t-b t-1r"},[i("tr",[i("td",[t._v("时间")]),i("td",[t._v("交易对")]),i("td",[t._v("方式")]),i("td",[t._v("方向")]),i("td",[t._v("价格(USDT)")]),i("td",[t._v("委托量")]),i("td",[t._v("已成交("+t._s(t.symbolName)+")")]),i("td",[t._v("成交均价")]),i("td",[t._v("成交额(USDT)")]),i("td",[t._v("状态")]),i("td",[t._v("操作")])]),i("tr",[i("td",{attrs:{colspan:"11"}},[i("a-empty",{attrs:{image:"//assets99.oss-cn-hongkong.aliyuncs.com/images/no-data.png","image-style":{height:"60px"}}})],1)])])])],1)],1)])])],1)],1)},n=[],a=(i("99af"),i("d3b7"),i("159b"),i("b0c0"),i("a434"),i("e9c4"),i("5cc6"),i("907a"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("a9e3"),i("c9fd")),o={name:"Futures",components:{},data:function(){return{loading:!1,ws:null,wsTemp:0,kLineChart:null,klineData:[],isUpdateKlineData:!1,symbol:"btcusdt",symbolName:"",size:100,main:{symbol:"",price:0,percent:0},tick:{open:0,close:0,percent:0},radio:{value:"1min"},slider:{marks:{0:{style:{color:"#999"},label:"0x"},25:{style:{color:"#999"},label:"25x"},50:{style:{color:"#999"},label:"50x"},75:{style:{color:"#999"},label:"75x"},100:{style:{color:"#999"},label:"100x"}}},menu:{current:["limit"]},list:[],orderbook_buy_list:[],orderbook_sell_list:[],market_trades_list:[],currMarketBuyPrice:0,currMarketBuyAmount:0,currMarketBuySum:0,currMarketBuyLever:0,currMarketSellPrice:0,currMarketSellAmount:0,currMarketSellSum:0,currMarketSellLever:0,currContractUsdtAmount:0,CronArr:[],isCronJobStop:!1,wsHuobi:null}},destroyed:function(){Object(a["dispose"])("custom-theme-k-line"),null!=this.ws&&(this.ws.close(),this.ws=null,clearTimeout(this.wsTemp)),this.isCronJobStop=!0},watch:{currMarketBuyPrice:function(){this.updateBuySum()},currMarketBuyAmount:function(){this.updateBuySum()},currMarketSellPrice:function(){this.updateSellSum()},currMarketSellAmount:function(){this.updateSellSum()}},methods:{onClickOrderbook:function(t,e){console.log("item",t,e)},onClickSymbol:function(t){console.log("item",t.symbol,t);var e=t.symbol.toLocaleLowerCase();this.$router.push("/futures?symbol=".concat(e,"usdt")),window.location.reload()},onChangeCallback:function(t){console.log(t)},onChangeBuySlider:function(t){this.updateBuySum()},onChangeSellSlider:function(t){this.updateSellSum()},onChangeKline:function(t){var e=this;console.log("checked = ".concat(t.target.value));var i=t.target.value;"line"!=i?(this.kLineChart.setStyleOptions({candle:{type:"candle_solid"}}),this.loading=!0,this.getKLineDataList(this.symbol,i,this.size,(function(t){e.loading=!1,e.klineData=t,e.kLineChart.applyNewData(e.klineData)}))):this.kLineChart.setStyleOptions({candle:{type:"area"}})},getKLineDataList:function(t,e,i,r){var n=this.g.apiUrl+"/api/kline?symbol=".concat(t,"&period=").concat(e,"&size=").concat(i);$.get(n,{},(function(t){var e=[];e=t.data.data.reverse(),e.forEach((function(t){t.timestamp=1e3*t.id,t.volume=t.vol})),r&&r(e)}))},updateBuySum:function(){this.currMarketBuyLever>0?this.currMarketBuySum=this.g.round(this.currMarketBuyPrice*this.currMarketBuyAmount/this.currMarketBuyLever,1,8):this.currMarketBuySum=this.g.round(this.currMarketBuyPrice*this.currMarketBuyAmount,1,8)},updateSellSum:function(){this.currMarketSellLever>0?(console.log(this.currMarketSellLever,this.g.round(this.currMarketSellPrice*this.currMarketSellAmount/this.currMarketSellLever,1,8)),this.currMarketSellSum=this.g.round(this.currMarketSellPrice*this.currMarketSellAmount/this.currMarketSellLever,1,8)):(console.log(this.currMarketSellLever,this.g.round(this.currMarketSellPrice*this.currMarketSellAmount,1,8)),this.currMarketSellSum=this.g.round(this.currMarketSellPrice*this.currMarketSellAmount,1,8))},updateCandlestick:function(t){var e=this;if(this.tick=t.tick,this.main.price=t.tick.close,this.main.percent=Math.round((this.tick.close-this.tick.open)/this.tick.close*1e4)/100,this.isUpdateKlineData){this.isUpdateKlineData=!1;var i={timestamp:t.ts,open:t.tick.close,close:t.tick.close,high:t.tick.close,low:t.tick.close,volume:100*Math.random()};return this.klineData.push(i),void this.getKLineDataList(this.symbol,this.radio.value,2,(function(t){e.klineData[e.klineData.length-1].volume=t[1].vol,e.klineData[e.klineData.length-2].volume=t[0].vol,e.kLineChart.updateData(i)}))}var r=this.klineData[this.klineData.length-1];r&&r.close&&(r.close=t.tick.close,r.high=Math.max(r.high,r.close),r.low=Math.min(r.low,r.close),r.volume=100*Math.random(),this.kLineChart.updateData(r))},updateMarketList:function(t,e){for(var i=0;i<this.list.length;i++){var r=this.list[i];if(r.name==t){r.priceUsd=this.g.round2(e.tick.close,4);break}}},updateBuySellList:function(t){for(var e=t.tick.data,i=0;i<e.length;i++){var r=e[i];r.id=this.g.round(1e8*Math.random(),1,8),r.amount=this.g.round(r.amount),r.sum=this.g.round(Math.random(),1),r.time=moment(r.ts).format("HH:mm:ss"),this.market_trades_list.pop(),this.market_trades_list.splice(0,0,r),"buy"==r.direction?(this.currMarketBuyPrice=c(this.orderbook_buy_list),this.orderbook_buy_list.pop(),this.orderbook_buy_list.splice(0,0,r),this.orderbook_buy_list=s(this.orderbook_buy_list)):"sell"==r.direction&&(this.currMarketSellPrice=h(this.orderbook_sell_list),this.orderbook_sell_list.pop(),this.orderbook_sell_list.splice(0,0,r),this.orderbook_sell_list=s(this.orderbook_sell_list))}},getPercent:function(t){var e=t.close-t.open,i=e/t.close*100,r=this.g.round(i,1,2),n=r;return r>0&&(n="+".concat(r)),n},initKLineChart:function(){var t=this;this.kLineChart=Object(a["init"])("custom-theme-k-line"),this.kLineChart.setStyleOptions(y("dark")),this.kLineChart.createTechnicalIndicator("VOL",!0),this.kLineChart.createTechnicalIndicator("MA",!1,{id:"candle_pane"}),this.kLineChart.setStyleOptions(_("")),this.loading=!0,this.getKLineDataList(this.symbol,this.radio.value,this.size,(function(e){t.loading=!1,t.klineData=e,t.kLineChart.applyNewData(t.klineData)}))},cronJobCallback:function(t){this.isCronJobStop||t==this.radio.value&&(this.isUpdateKlineData=!0)},initCronJob:function(t){var e=new CronJob("0 * * * * *",(function(){t&&t("1min")}));this.CronArr.push(e);var i=new CronJob("0 0/5 * * * *",(function(){t&&t("5min")}));this.CronArr.push(i);var r=new CronJob("0 0/15 * * * *",(function(){t&&t("15min")}));this.CronArr.push(r);var n=new CronJob("0 0/30 * * * *",(function(){t&&t("30min")}));this.CronArr.push(n);var a=new CronJob("0 0 0/1 * * *",(function(){t&&t("1h")}));this.CronArr.push(a);var o=new CronJob("0 0 0/4 * * *",(function(){t&&t("4h")}));this.CronArr.push(o);var s=new CronJob("0 0 0 1/1 * *",(function(){t&&t("1d")}));this.CronArr.push(s)},initWS:function(){var t=this;this.ws=new WebSocket("".concat(this.g.wsUrl,"/market.").concat(this.symbol,".ticker")),this.ws.onopen=function(){console.log("websocket init ...")},this.ws.onclose=function(){console.log("websocket close ..."),t.wsTemp=setTimeout((function(){null!=t.ws&&t.initWS()}),1e3)},this.ws.onmessage=function(e){var i=JSON.parse(e.data);"market.btcusdt.ticker"==i.ch&&void 0!=i.tick.close&&t.klineData.length>0&&(t.updateMarketList("btc",i),t.updateCandlestick(i))}},initWSHuobi:function(){var t=this,e=t.symbol,i={ticker:{sub:"market.".concat(e.toLocaleLowerCase(),".ticker")},trade_detail:{sub:"market.".concat(e.toLocaleLowerCase(),".trade.detail"),id:"id1"}},r=this.wsHuobi;r=new WebSocket("wss://api.huobi.pro/ws"),r.onopen=function(){console.log("huobi api connection open..."),r.send(JSON.stringify(i.ticker)),r.send(JSON.stringify(i.trade_detail))},r.onclose=function(){console.log("huobi api connection close...")},r.onmessage=function(i){var n=new FileReader;n.onload=function(){var i=pako.ungzip(new Uint8Array(n.result),{to:"string"});i=JSON.parse(i),i.ping?r.send(JSON.stringify({pong:i.ping})):i.ch=="market.".concat(e.toLocaleLowerCase(),".ticker")?(t.updateMarketList("btc",i),t.updateCandlestick(i)):i.ch=="market.".concat(e.toLocaleLowerCase(),".trade.detail")?t.updateBuySellList(i):console.log("huobi api ws data ： ",i)},n.readAsArrayBuffer(i.data)}},showListHuobi:function(t){var e=this;t.forEach((function(t){t.symbol=t.name.toLocaleUpperCase(),t.priceUsd=e.g.round2(t.close,4),t.changePercent24Hr=e.getPercent(t)})),this.list=t},initHuobiList:function(){var t=this,e=this.g.apiUrl+"/api/caches?key=huobi-market-tickers";$.get(e,(function(e){var i=e.data.value;t.showListHuobi(i)}))},initBuySellList:function(t){console.log("initBuySellList",t);for(var e=7,i=[],r=0;r<e;r++){var n={price:this.g.round2(this.g.random(t.close,t.close+2)),amount:this.g.round(Math.random(),1),sum:this.g.round(Math.random(),1),percent:0};i.push(n)}this.orderbook_sell_list=s(i),i=[];for(var a=0;a<e;a++){var o={price:this.g.round2(this.g.random(t.close-2,t.close)),amount:this.g.round(Math.random(),1),sum:this.g.round(Math.random(),1),percent:0};i.push(o)}this.orderbook_buy_list=s(i)},initTickerList:function(){for(var t=[],e=0;e<30;e++){var i={id:this.g.round(1e8*Math.random(),1,8),time:moment().format("HH:mm:ss"),price:this.g.round(Math.random(),1),amount:this.g.round(Math.random(),1),act:Math.floor(10*Math.random())>5?"buy":"sell"};t.push(i)}this.market_trades_list=t},initContractUsdtAmount:function(){var t=this;$.get("".concat(this.g.apiUrl,"/api/my/assets"),{user_id:this.g.userInfo.id},(function(e){t.currContractUsdtAmount=u(e.data.walletList,"usdt").contract_amount}))},init:function(){var t=this;this.symbol=this.g.getQueryVariable("symbol"),this.symbolName=this.symbol.substring(0,this.symbol.length-4).toLocaleUpperCase(),this.initKLineChart();var e=this.g.appWsData;this.showListHuobi(e),this.$EventBus.$on("appWsComplete",(function(e){t.showListHuobi(e)})),this.initWSHuobi(),this.initCronJob(this.cronJobCallback);var i=0;window.addEventListener("resize",(function(){clearTimeout(i),i=setTimeout((function(){t.kLineChart.resize()}),100)}));var r=l(e,this.symbolName.toLocaleLowerCase());this.initBuySellList(r),this.initTickerList(r),this.initContractUsdtAmount()}},mounted:function(){this.init()}};function s(t){for(var e=[],i=0,r=0;r<t.length;r++)i=Math.max(i,Number(t[r].sum));for(var n=0;n<t.length;n++){var a=t[n];a.percent=Math.round(a.sum/i*100),e.push(a)}return e}function c(t){for(var e=t[0].price,i=0;i<t.length;i++)e=Math.min(e,t[i].price);return e}function h(t){for(var e=t[0].price,i=0;i<t.length;i++)e=Math.max(e,t[i].price);return e}function l(t,e){for(var i=0;i<t.length;i++){var r=t[i];if(r.symbol.toLocaleLowerCase()==e.toLocaleLowerCase())return r}return null}function u(t,e){for(var i=0;i<t.length;i++){var r=t[i];if(r.name==e)return r}}document.addEventListener("visibilitychange",(function(){document.visibilityState}));var f="#929AA5",d="#202020",v="#333333",p="#373a40";function y(t){var e=f,i=d,r=v,n=v,a=p;return{grid:{horizontal:{color:i},vertical:{color:i}},candle:{priceMark:{high:{color:e},low:{color:e}},tooltip:{text:{color:e}}},technicalIndicator:{tooltip:{text:{color:e}}},xAxis:{axisLine:{color:r},tickLine:{color:r},tickText:{color:e}},yAxis:{axisLine:{color:r},tickLine:{color:r},tickText:{color:e}},separator:{color:r},crosshair:{horizontal:{line:{color:n},text:{backgroundColor:a}},vertical:{line:{color:n},text:{backgroundColor:a}}}}}function _(t){return{candle:{tooltip:{labels:"zh-CN"===t?["时间：","开：","收：","高：","低：","成交量："]:"zh-HK"===t?["時間：","開：","收：","高：","低：","成交量："]:["Time: ","Open: ","Close: ","High: ","Low: ","Volume: "]}}}}var m=o,g=(i("5a30"),i("2877")),x=Object(g["a"])(m,r,n,!1,null,"4e9e2dde",null);e["default"]=x.exports},"512ce":function(t,e,i){var r=i("342f"),n=r.match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},"5a30":function(t,e,i){"use strict";i("a3e4")},"5cc6":function(t,e,i){var r=i("74e8");r("Uint8",(function(t){return function(e,i,r){return t(this,e,i,r)}}))},"5f96":function(t,e,i){"use strict";var r=i("ebb5"),n=i("e330"),a=r.aTypedArray,o=r.exportTypedArrayMethod,s=n([].join);o("join",(function(t){return s(a(this),t)}))},"60bd":function(t,e,i){"use strict";var r=i("da84"),n=i("d039"),a=i("e330"),o=i("ebb5"),s=i("e260"),c=i("b622"),h=c("iterator"),l=r.Uint8Array,u=a(s.values),f=a(s.keys),d=a(s.entries),v=o.aTypedArray,p=o.exportTypedArrayMethod,y=l&&l.prototype,_=!n((function(){y[h].call([1])})),m=!!y&&y.values&&y[h]===y.values&&"values"===y.values.name,g=function(){return u(v(this))};p("entries",(function(){return d(v(this))}),_),p("keys",(function(){return f(v(this))}),_),p("values",g,_||!m,{name:"values"}),p(h,g,_||!m,{name:"values"})},"621a":function(t,e,i){"use strict";var r=i("da84"),n=i("e330"),a=i("83ab"),o=i("a981"),s=i("5e77"),c=i("9112"),h=i("e2cc"),l=i("d039"),u=i("19aa"),f=i("5926"),d=i("50c4"),v=i("0b25"),p=i("77a7"),y=i("e163"),_=i("d2bb"),m=i("241c").f,g=i("9bf2").f,x=i("81d5"),S=i("4dae"),k=i("d44e"),b=i("69f3"),w=s.PROPER,C=s.CONFIGURABLE,A=b.get,E=b.set,P="ArrayBuffer",M="DataView",T="prototype",I="Wrong length",O="Wrong index",D=r[P],L=D,R=L&&L[T],B=r[M],F=B&&B[T],z=Object.prototype,V=r.Array,N=r.RangeError,j=n(x),H=n([].reverse),Y=p.pack,W=p.unpack,U=function(t){return[255&t]},X=function(t){return[255&t,t>>8&255]},G=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},K=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Z=function(t){return Y(t,23,4)},J=function(t){return Y(t,52,8)},$=function(t,e){g(t[T],e,{get:function(){return A(this)[e]}})},q=function(t,e,i,r){var n=v(i),a=A(t);if(n+e>a.byteLength)throw N(O);var o=A(a.buffer).bytes,s=n+a.byteOffset,c=S(o,s,s+e);return r?c:H(c)},Q=function(t,e,i,r,n,a){var o=v(i),s=A(t);if(o+e>s.byteLength)throw N(O);for(var c=A(s.buffer).bytes,h=o+s.byteOffset,l=r(+n),u=0;u<e;u++)c[h+u]=l[a?u:e-u-1]};if(o){var tt=w&&D.name!==P;if(l((function(){D(1)}))&&l((function(){new D(-1)}))&&!l((function(){return new D,new D(1.5),new D(NaN),tt&&!C})))tt&&C&&c(D,"name",P);else{L=function(t){return u(this,R),new D(v(t))},L[T]=R;for(var et,it=m(D),rt=0;it.length>rt;)(et=it[rt++])in L||c(L,et,D[et]);R.constructor=L}_&&y(F)!==z&&_(F,z);var nt=new B(new L(2)),at=n(F.setInt8);nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||h(F,{setInt8:function(t,e){at(this,t,e<<24>>24)},setUint8:function(t,e){at(this,t,e<<24>>24)}},{unsafe:!0})}else L=function(t){u(this,R);var e=v(t);E(this,{bytes:j(V(e),0),byteLength:e}),a||(this.byteLength=e)},R=L[T],B=function(t,e,i){u(this,F),u(t,R);var r=A(t).byteLength,n=f(e);if(n<0||n>r)throw N("Wrong offset");if(i=void 0===i?r-n:d(i),n+i>r)throw N(I);E(this,{buffer:t,byteLength:i,byteOffset:n}),a||(this.buffer=t,this.byteLength=i,this.byteOffset=n)},F=B[T],a&&($(L,"byteLength"),$(B,"buffer"),$(B,"byteLength"),$(B,"byteOffset")),h(F,{getInt8:function(t){return q(this,1,t)[0]<<24>>24},getUint8:function(t){return q(this,1,t)[0]},getInt16:function(t){var e=q(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=q(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return K(q(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return K(q(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return W(q(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return W(q(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Q(this,1,t,U,e)},setUint8:function(t,e){Q(this,1,t,U,e)},setInt16:function(t,e){Q(this,2,t,X,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Q(this,2,t,X,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Q(this,4,t,G,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Q(this,4,t,G,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Q(this,4,t,Z,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Q(this,8,t,J,e,arguments.length>2?arguments[2]:void 0)}});k(L,P),k(B,M),t.exports={ArrayBuffer:L,DataView:B}},"649e":function(t,e,i){"use strict";var r=i("ebb5"),n=i("b727").some,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("some",(function(t){return n(a(this),t,arguments.length>1?arguments[1]:void 0)}))},"68f9":function(t,e,i){
/**
 * @license
 * KLineChart v8.3.1
 * Copyright (c) 2019 lihu.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */
!function(t,i){i(e)}(0,(function(t){"use strict";var e={name:"BBI",shortName:"BBI",series:"price",precision:2,calcParams:[3,6,12,24],shouldCheckParamCount:!0,shouldOhlc:!0,plots:[{key:"bbi",title:"BBI: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=Math.max.apply(null,i),n=[],a=[];return t.map((function(e,o){var s={},c=e.close;if(i.forEach((function(e,i){n[i]=(n[i]||0)+c,e-1>o||(a[i]=n[i]/e,n[i]-=t[o-(e-1)].close)})),o>=r-1){var h=0;a.forEach((function(t){h+=t})),s.bbi=h/4}return s}))}},i={name:"DMA",shortName:"DMA",calcParams:[10,50,10],plots:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=Math.max(i[0],i[1]),n=0,a=0,o=0,s=[];return t.forEach((function(e,c){var h,l,u={},f=e.close;if(n+=f,a+=f,i[0]-1>c||(h=n/i[0],n-=t[c-(i[0]-1)].close),i[1]-1>c||(l=a/i[1],a-=t[c-(i[1]-1)].close),c>=r-1){var d=h-l;u.dma=d,o+=d,r+i[2]-2>c||(u.ama=o/i[2],o-=s[c-(i[2]-1)].dma)}s.push(u)})),s}},r={name:"DMI",shortName:"DMI",calcParams:[14,6],plots:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=0,n=0,a=0,o=0,s=0,c=0,h=0,l=0,u=[];return t.forEach((function(e,f){var d={},v=t[f-1]||e,p=v.close,y=e.high,_=e.low,m=y-_,g=Math.abs(y-p),x=Math.abs(p-_),S=y-v.high,k=v.low-_,b=Math.max(Math.max(m,g),x),w=S>0&&S>k?S:0,C=k>0&&k>S?k:0;if(r+=b,n+=w,a+=C,f>=i[0]-1){f>i[0]-1?(o=o-o/i[0]+b,s=s-s/i[0]+w,c=c-c/i[0]+C):(o=r,s=n,c=a);var A=0,E=0;0!==o&&(A=100*s/o,E=100*c/o),d.pdi=A,d.mdi=E;var P=0;E+A!==0&&(P=Math.abs(E-A)/(E+A)*100),h+=P,2*i[0]-2>f||(d.adx=l=f>2*i[0]-2?(l*(i[0]-1)+P)/i[0]:h/i[0],2*i[0]+i[1]-3>f||(d.adxr=(u[f-(i[1]-1)].adx+l)/2))}u.push(d)})),u}},n={name:"MACD",shortName:"MACD",calcParams:[12,26,9],plots:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,color:function(t,e){var i=(t.current.technicalIndicatorData||{}).macd;return i>0?e.bar.upColor:0>i?e.bar.downColor:e.bar.noChangeColor},isStroke:function(t){return(t.current.technicalIndicatorData||{}).macd>(t.prev.technicalIndicatorData||{}).macd}}],calcTechnicalIndicator:function(t,e){var i,r,n=e.params,a=0,o=0,s=0,c=0,h=Math.max(n[0],n[1]);return t.map((function(t,e){var l={},u=t.close;return a+=u,n[0]-1>e||(i=e>n[0]-1?(2*u+(n[0]-1)*i)/(n[0]+1):a/n[0]),n[1]-1>e||(r=e>n[1]-1?(2*u+(n[1]-1)*r)/(n[1]+1):a/n[1]),h-1>e||(l.dif=o=i-r,s+=o,h+n[2]-2>e||(l.macd=2*(o-(c=e>h+n[2]-2?(2*o+c*(n[2]-1))/(n[2]+1):s/n[2])),l.dea=c)),l}))}},a={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],plots:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=Math.ceil(i[1]/2.5+1),n=Math.ceil(i[2]/2.5+1),a=Math.ceil(i[3]/2.5+1),o=Math.ceil(i[4]/2.5+1),s=0,c=[],h=0,l=[],u=0,f=[],d=0,v=[],p=[];return t.forEach((function(e,y){var _={},m=t[y-1]||e,g=(m.high+m.close+m.low+m.open)/4,x=Math.max(0,e.high-g),S=Math.max(0,g-e.low);i[0]-1>y||(_.cr=0!==S?x/S*100:0,s+=_.cr,h+=_.cr,u+=_.cr,d+=_.cr,i[0]+i[1]-2>y||(c.push(s/i[1]),i[0]+i[1]+r-3>y||(_.ma1=c[c.length-1-r]),s-=p[y-(i[1]-1)].cr),i[0]+i[2]-2>y||(l.push(h/i[2]),i[0]+i[2]+n-3>y||(_.ma2=l[l.length-1-n]),h-=p[y-(i[2]-1)].cr),i[0]+i[3]-2>y||(f.push(u/i[3]),i[0]+i[3]+a-3>y||(_.ma3=f[f.length-1-a]),u-=p[y-(i[3]-1)].cr),i[0]+i[4]-2>y||(v.push(d/i[4]),i[0]+i[4]+o-3>y||(_.ma4=v[v.length-1-o]),d-=p[y-(i[4]-1)].cr)),p.push(_)})),p}},o={name:"AO",shortName:"AO",calcParams:[5,34],shouldCheckParamCount:!0,plots:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,color:function(t,e){return(t.current.technicalIndicatorData||{}).ao>(t.prev.technicalIndicatorData||{}).ao?e.bar.upColor:e.bar.downColor},isStroke:function(t){return(t.current.technicalIndicatorData||{}).ao>(t.prev.technicalIndicatorData||{}).ao}}],calcTechnicalIndicator:function(t,e){var i=e.params,r=Math.max(i[0],i[1]),n=0,a=0,o=0,s=0;return t.map((function(e,c){var h={},l=(e.low+e.high)/2;if(n+=l,a+=l,c>=i[0]-1){o=n/i[0];var u=t[c-(i[0]-1)];n-=(u.low+u.high)/2}if(c>=i[1]-1){s=a/i[1];var f=t[c-(i[1]-1)];a-=(f.low+f.high)/2}return r-1>c||(h.ao=o-s),h}))}},s={name:"CCI",shortName:"CCI",calcParams:[20],plots:[{key:"cci",title:"CCI: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=i[0]-1,n=0,a=[];return t.map((function(e,o){var s={},c=(e.high+e.low+e.close)/3;if(n+=c,a.push(c),o>=r){var h=n/i[0],l=a.slice(o-r,o+1),u=0;l.forEach((function(t){u+=Math.abs(t-h)}));var f=u/i[0];s.cci=0!==f?(c-h)/f/.015:0,n-=(t[o-r].high+t[o-r].low+t[o-r].close)/3}return s}))}},c={name:"RSI",shortName:"RSI",calcParams:[6,12,24],shouldCheckParamCount:!1,plots:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var i=e.params,r=e.plots,n=[],a=[];return t.map((function(e,o){var s={},c=e.close-(t[o-1]||e).close;return i.forEach((function(e,i){if(c>0?n[i]=(n[i]||0)+c:a[i]=(a[i]||0)+Math.abs(c),o>=e-1){s[r[i].key]=0!==a[i]?100-100/(1+n[i]/a[i]):0;var h=t[o-(e-1)],l=h.close-(t[o-e]||h).close;l>0?n[i]-=l:a[i]-=Math.abs(l)}})),s}))}};function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;return t.forEach((function(t){e=Math.max(t.high,e),i=Math.min(t.low,i)})),{hn:e,ln:i}}var l={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],plots:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=[];return t.forEach((function(e,n){var a={},o=e.close;if(n>=i[0]-1){var s=h(t.slice(n-(i[0]-1),n+1)),c=s.ln,l=s.hn-c;a.k=((i[1]-1)*(r[n-1].k||50)+(o-c)/(0===l?1:l)*100)/i[1],a.d=((i[2]-1)*(r[n-1].d||50)+a.k)/i[2],a.j=3*a.k-2*a.d}r.push(a)})),r}},u={name:"WR",shortName:"WR",calcParams:[6,10,14],shouldCheckParamCount:!1,plots:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var i=e.params,r=e.plots;return t.map((function(e,n){var a={},o=e.close;return i.forEach((function(e,i){var s=e-1;if(n>=s){var c=h(t.slice(n-s,n+1)),l=c.hn,u=l-c.ln;a[r[i].key]=0===u?0:(o-l)/u*100}})),a}))}},f={name:"BOLL",shortName:"BOLL",calcParams:[20,{value:2,allowDecimal:!0}],precision:2,shouldOhlc:!0,plots:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=i[0]-1,n=0;return t.map((function(e,a){var o={};if(n+=e.close,a>=r){o.mid=n/i[0];var s=function(t,e){var i=t.length,r=0;t.forEach((function(t){var i=t.close-e;r+=i*i}));var n=r>0,a=Math.sqrt((r=Math.abs(r))/i);return n?a:-1*a}(t.slice(a-r,a+1),o.mid);o.up=o.mid+i[1]*s,o.dn=o.mid-i[1]*s,n-=t[a-r].close}return o}))}},d={name:"SAR",shortName:"SAR",series:"price",calcParams:[2,2,20],precision:2,shouldOhlc:!0,plots:[{key:"sar",title:"SAR: ",type:"circle",color:function(t,e){var i=t.current,r=i.kLineData||{};return(r.high+r.low)/2>(i.technicalIndicatorData||{}).sar?e.circle.upColor:e.circle.downColor}}],calcTechnicalIndicator:function(t,e){var i=e.params,r=i[0]/100,n=i[1]/100,a=i[2]/100,o=r,s=-100,c=!1,h=0;return t.map((function(e,i){var l=h,u=e.high,f=e.low;if(c){(-100===s||u>s)&&(s=u,o=Math.min(o+n,a)),h=l+o*(s-l);var d=Math.min(t[Math.max(1,i)-1].low,f);h>e.low?(h=s,o=r,s=-100,c=!c):h>d&&(h=d)}else{(-100===s||s>f)&&(s=f,o=Math.min(o+n,a)),h=l+o*(s-l);var v=Math.max(t[Math.max(1,i)-1].high,u);e.high>h?(h=s,o=0,s=-100,c=!c):v>h&&(h=v)}return{sar:h}}))}},v={technicalIndicatorExtensions:{},shapeExtensions:{},addTechnicalIndicatorTemplate:function(t){var e=this;t&&[].concat(t).forEach((function(t){t.name&&(e.technicalIndicatorExtensions[t.name]=t)}))},addShapeTemplate:function(t){var e=this;t&&[].concat(t).forEach((function(t){t.name&&(e.shapeExtensions[t.name]=t)}))}};function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var i=0;e.length>i;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(t,e,i){return e&&y(t.prototype,e),i&&y(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function g(t,e){if(b(t)&&b(e))for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&i in t){var r=t[i],n=e[i];b(n)&&b(r)&&!S(n)&&!S(r)?g(r,n):C(e[i])&&(t[i]=e[i])}}function x(t){if(!b(t))return t;var e;for(var i in e=S(t)?[]:{},t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=t[i];e[i]=b(r)?x(r):r}return e}function S(t){return"[object Array]"===Object.prototype.toString.call(t)}function k(t){return t&&"function"==typeof t}function b(t){return!!t&&"object"===m(t)}function w(t){return"number"==typeof t&&!isNaN(t)}function C(t){return null!=t}function A(t){return"boolean"==typeof t}function E(t){return"string"==typeof t}var P="stroke",M="fill",T="dash",I="solid",O="left",D="right",L="normal",R="percentage",B="log",F="candle_solid",z="candle_stroke",V="candle_up_stroke",N="candle_down_stroke",j="ohlc",H="area",Y="always",W="follow_cross",U="rect",X="standard",G="circle",K="rect",Z="triangle",J="diamond",$="custom",q="point",Q="top",tt="bottom",et={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:T,dashValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:T,dashValue:[2,2]}},candle:{margin:{top:.2,bottom:.1},type:F,bar:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#999999"},area:{lineSize:2,lineColor:"#2196F3",value:"close",backgroundColor:[{offset:0,color:"rgba(33, 150, 243, 0.01)"},{offset:1,color:"rgba(33, 150, 243, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888",line:{show:!0,style:T,dashValue:[4,4],size:1},text:{show:!0,size:12,paddingLeft:2,paddingTop:2,paddingRight:2,paddingBottom:2,color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:Y,showType:X,labels:["时间: ","开: ","收: ","高: ","低: ","成交量: "],values:null,defaultValue:"n/a",rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:6,offsetLeft:8,offsetTop:8,offsetRight:8,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",backgroundColor:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:8,marginTop:6,marginRight:8,marginBottom:0}}},technicalIndicator:{margin:{top:.2,bottom:.1},bar:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},line:{size:1,colors:["#FF9600","#9D65C9","#2196F3","#E11D74","#01C5C4"]},circle:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},lastValueMark:{show:!1,text:{show:!1,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:3,paddingTop:2,paddingRight:3,paddingBottom:2,borderRadius:2}},tooltip:{showRule:Y,showType:X,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginTop:6,marginRight:8,marginBottom:0,marginLeft:8}}},xAxis:{show:!0,height:null,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",paddingTop:3,paddingBottom:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,width:null,type:L,position:D,inside:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:3,paddingRight:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:T,dashValue:[4,2],size:1,color:"#76808F"},text:{show:!0,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#686D76",borderRadius:2,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:T,dashValue:[4,2],size:1,color:"#76808F"},text:{show:!0,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderRadius:2,borderColor:"#686D76",backgroundColor:"#686D76"}}},shape:{point:{backgroundColor:"#2196F3",borderColor:"rgba(33, 150, 243, 0.35)",borderSize:1,radius:5,activeBackgroundColor:"#2196F3",activeBorderColor:"rgba(33, 150, 243, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:I,color:"#2196F3",size:1,dashValue:[2,2]},polygon:{style:P,stroke:{style:I,size:1,color:"#2196F3",dashValue:[2,2]},fill:{color:"#2196F3"}},arc:{style:P,stroke:{style:I,size:1,color:"#2196F3",dashValue:[2,2]},fill:{color:"#2196F3"}},text:{style:M,color:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",offset:[0,0]}},annotation:{position:Q,offset:[20,0],symbol:{type:J,size:8,color:"#2196F3",activeSize:10,activeColor:"#FF9600"}},tag:{position:q,offset:0,line:{show:!0,style:T,dashValue:[4,2],size:1,color:"#2196F3"},text:{color:"#FFFFFF",backgroundColor:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderRadius:2,borderSize:1,borderColor:"#2196F3"},mark:{offset:0,color:"#FFFFFF",backgroundColor:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderRadius:2,borderSize:1,borderColor:"#2196F3"}}};function it(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"--";if(b(t)){var r=t[e];if(C(r))return r}return i}function rt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"MM-DD hh:mm";if(w(e)){var r=t.format(new Date(e)),n=r.split(", "),a=n[0].split("/"),o={YYYY:a[2],MM:a[0],DD:a[1],"hh:mm":"24"===n[1].match(/^[\d]{2}/)[0]?n[1].replace(/^[\d]{2}/,"00"):n[1]};return i.replace(/YYYY|MM|DD|(hh:mm)/g,(function(t){return o[t]}))}return"--"}function nt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=+t;return(i||0===i)&&w(i)?i.toFixed(e):"".concat(i)}function at(t){return w(+t)?t>1e9?"".concat(+(t/1e9).toFixed(3),"B"):t>1e6?"".concat(+(t/1e6).toFixed(3),"M"):t>1e3?"".concat(+(t/1e3).toFixed(3),"K"):t:"--"}function ot(t,e){return null==e&&(e=10),+(t=(+t).toFixed(e=Math.min(Math.max(0,e),20)))}function st(t){return Math.log(t)/Math.log(10)}function ct(t){return Math.pow(10,t)}var ht={ZOOM:"zoom",SCROLL:"scroll",CROSSHAIR:"crosshair",TOOLTIP:"tooltip",PANE_DRAG:"pane_drag"};function lt(t){return Object.values(ht).indexOf(t)>-1}var ut=function(){function t(e){p(this,t),this._chartStore=e,this._dateTimeFormat=new Intl.DateTimeFormat("en",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalDataSpace=0,this._dataSpace=6,this._barSpace=this._calcBarSpace(),this._offsetRightSpace=50,this._offsetRightBarCount=this._offsetRightSpace/this._dataSpace,this._leftMinVisibleBarCount=2,this._rightMinVisibleBarCount=2,this._from=0,this._to=0,this._preOffsetRightBarCount=0}return _(t,[{key:"_calcBarSpace",value:function(){return Math.max(1,Math.min(Math.floor(.82*this._dataSpace),Math.floor(this._dataSpace)-1))}},{key:"adjustFromTo",value:function(){var t=this._chartStore.dataList().length,e=this._totalDataSpace/this._dataSpace,i=e-Math.min(this._leftMinVisibleBarCount,t);this._offsetRightBarCount>i&&(this._offsetRightBarCount=i);var r=-t+Math.min(this._rightMinVisibleBarCount,t);r>this._offsetRightBarCount&&(this._offsetRightBarCount=r),this._to=Math.round(this._offsetRightBarCount+t+.5),this._from=Math.round(this._to-e)-1,this._to>t&&(this._to=t),0>this._from&&(this._from=0),this._chartStore.adjustVisibleDataList(),0===this._from&&this._more&&!this._loading&&k(this._loadMoreCallback)&&(this._loading=!0,this._loadMoreCallback(it(this._chartStore.dataList()[0],"timestamp")))}},{key:"setMore",value:function(t){this._more=t}},{key:"setLoading",value:function(t){this._loading=t}},{key:"dateTimeFormat",value:function(){return this._dateTimeFormat}},{key:"setTimezone",value:function(t){var e;try{e=new Intl.DateTimeFormat("en",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){}e&&(this._dateTimeFormat=e)}},{key:"timezone",value:function(){return this._dateTimeFormat.resolvedOptions().timeZone}},{key:"dataSpace",value:function(){return this._dataSpace}},{key:"barSpace",value:function(){return this._barSpace}},{key:"halfBarSpace",value:function(){return this._barSpace/2}},{key:"setDataSpace",value:function(t,e){1>t||t>50||this._dataSpace===t||(this._dataSpace=t,this._barSpace=this._calcBarSpace(),e&&e(),this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0),this._chartStore.invalidate())}},{key:"setTotalDataSpace",value:function(t){this._totalDataSpace!==t&&(this._totalDataSpace=t,this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0))}},{key:"setOffsetRightSpace",value:function(t,e){this._offsetRightSpace=t,this._offsetRightBarCount=t/this._dataSpace,e&&(this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0),this._chartStore.invalidate())}},{key:"resetOffsetRightSpace",value:function(){this.setOffsetRightSpace(this._offsetRightSpace)}},{key:"offsetRightSpace",value:function(){return this._offsetRightSpace}},{key:"offsetRightBarCount",value:function(){return this._offsetRightBarCount}},{key:"setOffsetRightBarCount",value:function(t){this._offsetRightBarCount=t}},{key:"setLeftMinVisibleBarCount",value:function(t){this._leftMinVisibleBarCount=t}},{key:"setRightMinVisibleBarCount",value:function(t){this._rightMinVisibleBarCount=t}},{key:"from",value:function(){return this._from}},{key:"to",value:function(){return this._to}},{key:"startScroll",value:function(){this._preOffsetRightBarCount=this._offsetRightBarCount}},{key:"scroll",value:function(t,e){if(this._scrollEnabled){var i=t/this._dataSpace;this._chartStore.actionStore().execute(ht.SCROLL,{barCount:i,distance:t}),this._offsetRightBarCount=this._preOffsetRightBarCount-i,this.adjustFromTo();var r=e||this._chartStore.crosshairStore().get();this._chartStore.crosshairStore().set(r,!0),this._chartStore.invalidate()}}},{key:"getDataByDataIndex",value:function(t){return this._chartStore.dataList()[t]}},{key:"coordinateToFloatIndex",value:function(t){var e=this._chartStore.dataList().length;return Math.round(1e6*(e+this._offsetRightBarCount-(this._totalDataSpace-t)/this._dataSpace))/1e6}},{key:"dataIndexToTimestamp",value:function(t){var e=this.getDataByDataIndex(t);if(e)return e.timestamp}},{key:"timestampToDataIndex",value:function(t){return 0===this._chartStore.dataList().length?0:function(t,e,i){var r=0,n=0;for(n=t.length-1;r!==n;){var a=Math.floor((n+r)/2),o=n-r,s=t[a][e];if(i===t[r][e])return r;if(i===t[n][e])return n;if(i===s)return a;if(i>s?r=a:n=a,2>=o)break}return r}(this._chartStore.dataList(),"timestamp",t)}},{key:"dataIndexToCoordinate",value:function(t){var e=this._chartStore.dataList().length;return this._totalDataSpace-(e+this._offsetRightBarCount-t-.5)*this._dataSpace}},{key:"coordinateToDataIndex",value:function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1}},{key:"zoom",value:function(t,e){var i=this;if(this._zoomEnabled){if(!e||!C(e.x)){var r=this._chartStore.crosshairStore().get();e={x:C(r.x)?r.x:this._totalDataSpace/2}}this._chartStore.actionStore().execute(ht.ZOOM,{coordinate:e,scale:t});var n=this.coordinateToFloatIndex(e.x);this.setDataSpace(this._dataSpace+t*(this._dataSpace/10),(function(){i._offsetRightBarCount+=n-i.coordinateToFloatIndex(e.x)}))}}},{key:"setZoomEnabled",value:function(t){this._zoomEnabled=t}},{key:"zoomEnabled",value:function(){return this._zoomEnabled}},{key:"setScrollEnabled",value:function(t){this._scrollEnabled=t}},{key:"scrollEnabled",value:function(){return this._scrollEnabled}},{key:"setLoadMoreCallback",value:function(t){this._loadMoreCallback=t}},{key:"clear",value:function(){this._more=!0,this._loading=!0,this._from=0,this._to=0}}]),t}();function ft(t,e){return ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ft(t,e)}function dt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ft(t,e)}function vt(t,e){if(e&&("object"===m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pt(t){return pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},pt(t)}function yt(t,e,i,r,n,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(r,n)}var _t={exports:{}};!function(t){var e=function(t){var e,i=Object.prototype,r=i.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,r){var n=Object.create((e&&e.prototype instanceof y?e:y).prototype),a=new P(r||[]);return n._invoke=function(t,e,i){var r=u;return function(n,a){if(r===d)throw Error("Generator is already running");if(r===v){if("throw"===n)throw a;return T()}for(i.method=n,i.arg=a;;){var o=i.delegate;if(o){var s=C(o,i);if(s){if(s===p)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===u)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=d;var c=l(t,e,i);if("normal"===c.type){if(r=i.done?v:f,c.arg===p)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=v,i.method="throw",i.arg=c.arg)}}}(t,i,a),n}function l(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var u="suspendedStart",f="suspendedYield",d="executing",v="completed",p={};function y(){}function _(){}function m(){}var g={};c(g,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(M([])));S&&S!==i&&r.call(S,a)&&(g=S);var k=m.prototype=y.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(n,a,o,s){var c=l(t[n],t,a);if("throw"!==c.type){var h=c.arg,u=h.value;return u&&"object"==typeof u&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,o,s)}),(function(t){i("throw",t,o,s)})):e.resolve(u).then((function(t){h.value=t,o(h)}),(function(t){return i("throw",t,o,s)}))}s(c.arg)}var n;this._invoke=function(t,r){function a(){return new e((function(e,n){i(t,r,e,n)}))}return n=n?n.then(a,a):a()}}function C(t,i){var r=t.iterator[i.method];if(r===e){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=e,C(t,i),"throw"===i.method))return p;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=l(r,t.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,p;var a=n.arg;return a?a.done?(i[t.resultName]=a.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,p):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,p)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function M(t){if(t){var i=t[a];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function i(){for(;++n<t.length;)if(r.call(t,n))return i.value=t[n],i.done=!1,i;return i.value=e,i.done=!0,i};return o.next=o}}return{next:T}}function T(){return{value:e,done:!0}}return _.prototype=m,c(k,"constructor",m),c(m,"constructor",_),_.displayName=c(m,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,o,(function(){return this})),t.AsyncIterator=w,t.async=function(e,i,r,n,a){void 0===a&&(a=Promise);var o=new w(h(e,i,r,n),a);return t.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(k),c(k,s,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var r=e.pop();if(r in t)return i.value=r,i.done=!1,i}return i.done=!0,i}},t.values=M,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function n(r,n){return s.type="throw",s.arg=t,i.next=r,n&&(i.method="next",i.arg=e),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return n("end");if(this.prev>=o.tryLoc){var c=r.call(o,"catchLoc"),h=r.call(o,"finallyLoc");if(c&&h){if(o.catchLoc>this.prev)return n(o.catchLoc,!0);if(o.finallyLoc>this.prev)return n(o.finallyLoc)}else if(c){if(o.catchLoc>this.prev)return n(o.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(o.finallyLoc>this.prev)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(this.prev>=n.tryLoc&&r.call(n,"finallyLoc")&&n.finallyLoc>this.prev){var a=n;break}}!a||"break"!==t&&"continue"!==t||a.tryLoc>e||e>a.finallyLoc||(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),E(i),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var n=r.arg;E(i)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,i,r){return this.delegate={iterator:M(t),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(_t);var mt=_t.exports,gt="line",xt="bar",St="circle",kt={PRICE:"price",VOLUME:"volume",NORMAL:"normal"};function bt(t,e,i,r,n,a){var o=a.color,s=a.isStroke,c={prev:{kLineData:t[i-1],technicalIndicatorData:e[i-1]},current:{kLineData:t[i],technicalIndicatorData:e[i]},next:{kLineData:t[i+1],technicalIndicatorData:e[i+1]}};return C(r.color)&&(o=k(r.color)?r.color(c,n)||a.color:r.color||a.color),C(r.isStroke)&&(s=k(r.isStroke)?r.isStroke(c):r.isStroke),{color:o,isStroke:s}}var wt=function(){function t(e){var i=e.name,r=e.shortName,n=e.series,a=e.calcParams,o=e.plots,s=e.precision,c=e.shouldCheckParamCount,h=e.shouldOhlc,l=e.shouldFormatBigNumber,u=e.minValue,f=e.maxValue,d=e.styles;p(this,t),this.name=i||"",this.shortName=r||i||"",this.series=-1!==Object.values(kt).indexOf(n)?n:kt.NORMAL,this.precision=w(s)&&s>=0?s:4,this._precisionFlag=!1,this.calcParams=S(a)?a:[],this.plots=S(o)?o:[],this.shouldCheckParamCount=!A(c)||c,this.shouldOhlc=!!A(h)&&h,this.shouldFormatBigNumber=!!A(l)&&l,this.minValue=u,this.maxValue=f,this.styles=d,this.result=[]}var e,i;return _(t,[{key:"_createParams",value:function(t){return t.map((function(t){return b(t)?t.value:t}))}},{key:"setShortName",value:function(t){return this.shortName!==t&&(this.shortName=t,!0)}},{key:"setPrecision",value:function(t,e){return!(!w(t)||0>t||e&&(!e||this._precisionFlag))&&(this.precision=parseInt(t,10),e||(this._precisionFlag=!0),!0)}},{key:"setCalcParams",value:function(t){if(!S(t))return!1;if(this.shouldCheckParamCount&&t.length!==this.calcParams.length)return!1;for(var e=[],i=0;t.length>i;i++){var r=t[i],n=void 0,a=void 0;b(r)?(n=r.value,a=r.allowDecimal):(n=r,a=!1);var o=this.calcParams[i];if(b(o)&&A(o.allowDecimal)&&(a=o.allowDecimal),!w(n)||0>=n||!a&&parseInt(n,10)!==n)return!1;e.push({allowDecimal:a,value:n})}this.calcParams=e;var s=this.regeneratePlots(this._createParams(e));return s&&S(s)&&(this.plots=s),!0}},{key:"setShouldOhlc",value:function(t){return!(!A(t)||this.shouldOhlc===t)&&(this.shouldOhlc=t,!0)}},{key:"setShouldFormatBigNumber",value:function(t){return!(!A(t)||this.shouldFormatBigNumber===t)&&(this.shouldFormatBigNumber=t,!0)}},{key:"setStyles",value:function(t,e){return!!b(t)&&(this.styles||(this.styles={margin:x(e.margin),bar:x(e.bar),line:x(e.line),circle:x(e.circle)}),g(this.styles,t),!0)}},{key:"calc",value:(e=mt.mark((function t(e){return mt.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.calcTechnicalIndicator(e,{params:this._createParams(this.calcParams),plots:this.plots});case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:this.result=t.t0;case 6:case"end":return t.stop()}}),t,this)})),i=function(){var t=this,i=arguments;return new Promise((function(r,n){var a=e.apply(t,i);function o(t){yt(a,r,n,o,s,"next",t)}function s(t){yt(a,r,n,o,s,"throw",t)}o(void 0)}))},function(t){return i.apply(this,arguments)})},{key:"calcTechnicalIndicator",value:function(t,e){}},{key:"regeneratePlots",value:function(t){}}]),t}();function Ct(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return At(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?At(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return t.length>r?{done:!1,value:t[r++]}:{done:!0}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);e>i;i++)r[i]=t[i];return r}function Et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var Pt=function(){function t(e){p(this,t),this._chartStore=e,this._templates=this._createTemplates(),this._instances=new Map}return _(t,[{key:"_createTechInfo",value:function(t){return{name:t.name,shortName:t.shortName,series:t.series,calcParams:t.calcParams,shouldCheckParamCount:t.shouldCheckParamCount,shouldOhlc:t.shouldOhlc,shouldFormatBigNumber:t.shouldFormatBigNumber,precision:t.precision,styles:t.styles,plots:t.plots,result:t.result||[]}}},{key:"_createTemplates",value:function(){var t={},e=v.technicalIndicatorExtensions;for(var i in e){var r=this._createTemplateInstance(e[i]);r&&(t[i]=r)}return t}},{key:"_createTemplateInstance",value:function(t){var e=t.name,i=t.shortName,r=t.series,n=t.calcParams,a=t.plots,o=t.precision,s=t.shouldCheckParamCount,c=t.shouldOhlc,h=t.shouldFormatBigNumber,l=t.minValue,u=t.maxValue,f=t.styles,d=t.calcTechnicalIndicator,v=t.regeneratePlots,y=t.createToolTipDataSource,m=t.render;if(!e||!k(d))return null;var g=function(t){dt(v,t);var d=Et(v);function v(){return p(this,v),d.call(this,{name:e,shortName:i,series:r,calcParams:n,plots:a,precision:o,shouldCheckParamCount:s,shouldOhlc:c,shouldFormatBigNumber:h,minValue:l,maxValue:u,styles:f})}return _(v)}(wt);return g.prototype.calcTechnicalIndicator=d,k(v)&&(g.prototype.regeneratePlots=v),k(y)&&(g.prototype.createToolTipDataSource=y),k(m)&&(g.prototype.render=m),new g}},{key:"addTemplate",value:function(t){var e=this;t.forEach((function(t){var i=e._createTemplateInstance(t||{});i&&(e._templates[i.name]=i)}))}},{key:"hasTemplate",value:function(t){return!!this._templates[t]}},{key:"getTemplateInfo",value:function(t){if(!C(t)){var e={};for(var i in this._templates)e[i]=this._createTechInfo(this._templates[i]);return e}var r=this._templates[t];return r?this._createTechInfo(r):{}}},{key:"addInstance",value:function(t,e,i){var r=e.name,n=e.calcParams,a=e.precision,o=e.shouldOhlc,s=e.shouldFormatBigNumber,c=e.styles,h=this._instances.get(t);if(!h||!h.has(r)){h||(h=new Map,this._instances.set(t,h));var l=this._templates[r],u=Object.create(Object.getPrototypeOf(l));for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(u[f]=l[f]);return u.setCalcParams(n),u.setPrecision(a),u.setShouldOhlc(o),u.setShouldFormatBigNumber(s),u.setStyles(c,this._chartStore.styleOptions().technicalIndicator),i||h.clear(),h.set(r,u),u.calc(this._chartStore.dataList())}}},{key:"instances",value:function(t){return this._instances.get(t)||new Map}},{key:"removeInstance",value:function(t,e){var i=!1;if(this._instances.has(t)){var r=this._instances.get(t);C(e)?r.has(e)&&(r.delete(e),i=!0):(r.clear(),i=!0),0===r.size&&this._instances.delete(t)}return i}},{key:"hasInstance",value:function(t){return this._instances.has(t)}},{key:"calcInstance",value:function(t,e){var i=this,r=[];if(C(t))if(C(e)){var n=this._instances.get(e);n&&n.has(t)&&r.push(n.get(t).calc(this._chartStore.dataList()))}else this._instances.forEach((function(e){e.has(t)&&r.push(e.get(t).calc(i._chartStore.dataList()))}));else this._instances.forEach((function(t){t.forEach((function(t){r.push(t.calc(i._chartStore.dataList()))}))}));return Promise.all(r)}},{key:"getInstanceInfo",value:function(t,e){var i=this,r=function(t){var r,n=[],a=Ct(t);try{for(a.s();!(r=a.n()).done;){var o=r.value[1];if(o){var s=i._createTechInfo(o);if(o.name===e)return s;n.push(s)}}}catch(t){a.e(t)}finally{a.f()}return n};if(!C(t)){var n={};return this._instances.forEach((function(t,e){n[e]=r(t)})),n}return this._instances.has(t)?r(this._instances.get(t)):{}}},{key:"setSeriesPrecision",value:function(t,e){var i=function(i){i.series===kt.PRICE&&i.setPrecision(t,!0),i.series===kt.VOLUME&&i.setPrecision(e,!0)};for(var r in this._templates)i(this._templates[r]);this._instances.forEach((function(t){t.forEach((function(t){i(t)}))}))}},{key:"override",value:function(t,e){var i=this,r=t.name,n=t.shortName,a=t.calcParams,o=t.precision,s=t.shouldOhlc,c=t.shouldFormatBigNumber,h=t.styles,l=this._chartStore.styleOptions().technicalIndicator,u=new Map;if(C(e))this._instances.has(e)&&u.set(e,this._instances.get(e));else{u=this._instances;var f=this._templates[r];f&&(f.setCalcParams(a),f.setShortName(n),f.setPrecision(o),f.setShouldOhlc(s),f.setShouldFormatBigNumber(c),f.setStyles(h,l))}var d=!1,v=[];if(u.forEach((function(t){if(t.has(r)){var e=t.get(r),u=e.setShortName(n),f=e.setCalcParams(a),p=e.setPrecision(o),y=e.setShouldOhlc(s),_=e.setShouldFormatBigNumber(c),m=e.setStyles(h,l);(u||f||p||y||_||m)&&(d=!0),f&&v.push(e.calc(i._chartStore.dataList()))}})),d)return Promise.all(v)}}]),t}();function Mt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Tt(t,e){e.forEach((function(e){var i=e.key,r=e.fn;k(r)&&(t[i]=r)}))}var It=function(){function t(e){var i=e.id,r=e.chartStore,n=e.xAxis,a=e.yAxis;p(this,t),this._id=i,this._chartStore=r,this._xAxis=n,this._yAxis=a,this._styles=null}return _(t,[{key:"draw",value:function(t){}},{key:"setStyles",value:function(t,e){return!!b(t)&&(this._styles||(this._styles=x(e)),g(this._styles,t),!0)}},{key:"id",value:function(){return this._id}},{key:"styles",value:function(){return this._styles}},{key:"setYAxis",value:function(t){t&&(this._yAxis=t)}},{key:"checkEventCoordinateOn",value:function(t){}},{key:"onClick",value:function(t){}},{key:"onRightClick",value:function(t){}},{key:"onMouseEnter",value:function(t){}},{key:"onMouseLeave",value:function(t){}}]),t}();function Ot(t,e,i,r){t.fillStyle=e,t.beginPath(),t.arc(i.x,i.y,r,0,2*Math.PI),t.closePath(),t.fill()}function Dt(t,e,i){var r=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y),a=Math.abs(i.x-t.x);return Math.abs(r*Math.abs(i.y-t.y)-a*n)/2}function Lt(t,e){var i=t.x-e.x;if(0!==i){var r=(t.y-e.y)/i;return{k:r,b:t.y-r*t.x}}}function Rt(t,e,i){return Bt(Lt(t,e),i)}function Bt(t,e){return t?e.x*t.k+t.b:e.y}function Ft(t,e,i){if(!i||!t||!e)return!1;if(t.x===e.x)return 2>Math.abs(i.x-t.x);var r=Lt(t,e),n=Bt(r,i),a=Math.abs(n-i.y);return 4>a*a/(r.k*r.k+1)}function zt(t,e,i){return!!Ft(t,e,i)&&(t.x===e.x?e.y>t.y?2>t.y-i.y:2>i.y-t.y:e.x>t.x?2>t.x-i.x:2>i.x-t.x)}function Vt(t,e,i){return!!Ft(t,e,i)&&(t.x===e.x?4>Math.abs(t.y-i.y)+Math.abs(e.y-i.y)-Math.abs(t.y-e.y):4>Math.abs(t.x-i.x)+Math.abs(e.x-i.x)-Math.abs(t.x-e.x))}function Nt(t,e,i){if(!i)return!1;var r=i.x-t.x,n=i.y-t.y;return!(r*r+n*n>e*e)}function jt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if(t.length>1)if(t[0].x===t[1].x){var n=0,a=e.y;if(r.push([{x:t[0].x,y:n},{x:t[0].x,y:a}]),t.length>2){r.push([{x:t[2].x,y:n},{x:t[2].x,y:a}]);for(var o=t[0].x-t[2].x,s=0;i>s;s++){var c=o*(s+1);r.push([{x:t[0].x+c,y:n},{x:t[0].x+c,y:a}])}}}else{var h=0,l=e.x,u=Lt(t[0],t[1]),f=u.k,d=u.b;if(r.push([{x:h,y:h*f+d},{x:l,y:l*f+d}]),t.length>2){var v=t[2].y-f*t[2].x;r.push([{x:h,y:h*f+v},{x:l,y:l*f+v}]);for(var p=d-v,y=0;i>y;y++){var _=d+p*(y+1);r.push([{x:h,y:h*f+_},{x:l,y:l*f+_}])}}}return r}function Ht(t,e,i){t.save(),t.lineWidth%2&&t.translate(.5,.5),t.beginPath();var r=!0;e.forEach((function(e){e&&(r?(t.moveTo(e.x,e.y),r=!1):t.lineTo(e.x,e.y))})),i(),t.restore()}function Yt(t,e){Ht(t,e,(function(){t.closePath(),t.stroke()}))}function Wt(t,e){Ht(t,e,(function(){t.closePath(),t.fill()}))}function Ut(t,e,i,r){t.beginPath();var n=t.lineWidth%2?.5:0;t.moveTo(i,e+n),t.lineTo(r,e+n),t.stroke(),t.closePath()}function Xt(t,e,i,r){t.beginPath();var n=t.lineWidth%2?.5:0;t.moveTo(e+n,i),t.lineTo(e+n,r),t.stroke(),t.closePath()}function Gt(t,e){Ht(t,e,(function(){t.stroke(),t.closePath()}))}function Kt(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||2}function Zt(t,e){return Math.round(t.measureText(e).width)}function Jt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Helvetica Neue";return"".concat(e," ").concat(t,"px ").concat(i)}function $t(t,e,i){t.font=Jt(i.size,i.weight,i.family);var r=Zt(t,e);return i.paddingLeft+i.paddingRight+r+2*(i.borderSize||0)}function qt(t){return t.paddingTop+t.paddingBottom+t.size+2*(t.borderSize||0)}function Qt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return te(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?te(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return t.length>r?{done:!1,value:t[r++]}:{done:!0}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function te(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);e>i;i++)r[i]=t[i];return r}function ee(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var ie="other",re="point",ne="none",ae="line",oe="text",se="continuous_line",ce="polygon",he="arc",le=0,ue=1,fe=2,de={NORMAL:"normal",WEAK_MAGNET:"weak_magnet",STRONG_MAGNET:"strong_magnet"},ve=function(t){dt(i,t);var e=ee(i);function i(t){var r,n=t.id,a=t.name,o=t.totalStep,s=t.chartStore,c=t.xAxis,h=t.yAxis,l=t.points,u=t.styles,f=t.lock,d=t.mode,v=t.data;return p(this,i),(r=e.call(this,{id:n,chartStore:s,xAxis:c,yAxis:h}))._name=a,r._totalStep=o,r._lock=f,r._mode=de.NORMAL,r.setMode(d),r._data=v,r._drawStep=1,r._points=[],r.setPoints(l),r.setStyles(u,s.styleOptions().shape),r._prevPressPoint=null,r._prevPoints=null,r._coordinates=[],r}return _(i,[{key:"setPoints",value:function(t){if(S(t)&&t.length>0){var e;this._totalStep-1>t.length?(this._drawStep=t.length+1,this._points=x(t),e=t.length):(this._drawStep=-1,this._points=t.slice(0,this._totalStep-1),e=this._totalStep-1);for(var i=0;e>i;i++)this.performEventMoveForDrawing({step:i+2,mode:this._mode,points:this._points,movePoint:this._points[i],xAxis:this._xAxis,yAxis:this._yAxis});-1===this._drawStep&&this.performEventPressedMove({mode:this._mode,points:this._points,pressPointIndex:this._points.length-1,pressPoint:this._points[this._points.length-1],xAxis:this._xAxis,yAxis:this._yAxis})}}},{key:"_timestampOrDataIndexToCoordinateX",value:function(t){var e=t.timestamp,i=t.dataIndex;return e&&(i=this._chartStore.timeScaleStore().timestampToDataIndex(e)),this._xAxis.convertToPixel(i)}},{key:"_drawLines",value:function(t,e,i,r){t.save(),t.strokeStyle=i.color||r.color,t.lineWidth=i.size||r.size,i.style===T&&t.setLineDash(i.dashValue||r.dashValue),e.forEach((function(e){var i,r;if(e.length>1)switch((i=e[0]).x===(r=e[1]).x?fe:i.y===r.y?ue:le){case le:Gt(t,e);break;case ue:Ut(t,e[0].y,e[0].x,e[1].x);break;case fe:Xt(t,e[0].x,e[0].y,e[1].y)}})),t.restore()}},{key:"_drawContinuousLines",value:function(t,e,i,r){t.save(),t.strokeStyle=i.color||r.color,t.lineWidth=i.size||r.size,i.style===T&&t.setLineDash(i.dashValue||r.dashValue),e.forEach((function(e){e.length>0&&Gt(t,e)})),t.restore()}},{key:"_drawPolygons",value:function(t,e,i,r){var n;if(t.save(),i.style===M)t.fillStyle=(i.fill||r.fill).color,n=Wt;else{var a=i.stroke||r.stroke;a.style===T&&t.setLineDash(a.dashValue),t.lineWidth=a.size,t.strokeStyle=a.color,n=Yt}e.forEach((function(e){e.length>0&&n(t,e)})),t.restore()}},{key:"_drawArcs",value:function(t,e,i,r){if(t.save(),i.style===M)t.fillStyle=(i.fill||r.fill).color;else{var n=i.stroke||r.stroke;n.style===T&&t.setLineDash(n.dashValue),t.lineWidth=n.size,t.strokeStyle=n.color}e.forEach((function(e){var r=e.x,n=e.y,a=e.radius,o=e.startAngle,s=e.endAngle;t.beginPath(),t.arc(r,n,a,o,s),i.style===M?(t.closePath(),t.fill()):(t.stroke(),t.closePath())})),t.restore()}},{key:"_drawText",value:function(t,e,i,r){var n;t.save(),i.style===P?(t.strokeStyle=i.color||r.color,n=t.strokeText):(t.fillStyle=i.color||r.color,n=t.fillText),t.font=Jt(i.size||r.size,i.family||r.family,i.weight||r.weight);var a=i.offset||r.offset||[0,0];e.forEach((function(e){n.call(t,e.text,e.x+a[1],e.y+a[0])})),t.restore()}},{key:"draw",value:function(t){var e=this;this._coordinates=this._points.map((function(t){var i=t.value;return{x:e._timestampOrDataIndexToCoordinateX({timestamp:t.timestamp,dataIndex:t.dataIndex}),y:e._yAxis.convertToPixel(i)}}));var i=this._styles||this._chartStore.styleOptions().shape;if(1!==this._drawStep&&this._coordinates.length>0){var r={width:this._xAxis.width(),height:this._yAxis.height()},n={price:this._chartStore.pricePrecision(),volume:this._chartStore.volumePrecision()};this._shapeDataSources=this.createShapeDataSource({step:this._drawStep,mode:this._mode,points:this._points,coordinates:this._coordinates,viewport:{width:this._xAxis.width(),height:this._yAxis.height()},precision:{price:this._chartStore.pricePrecision(),volume:this._chartStore.volumePrecision()},styles:i,xAxis:this._xAxis,yAxis:this._yAxis,data:this._data})||[],this._shapeDataSources.forEach((function(r){var n=r.styles,a=r.dataSource,o=void 0===a?[]:a;if(r.isDraw)switch(r.type){case ae:e._drawLines(t,o,n||i.line,i.line);break;case se:e._drawContinuousLines(t,o,n||i.line,i.line);break;case ce:e._drawPolygons(t,o,n||i.polygon,i.polygon);break;case he:e._drawArcs(t,o,n||i.arc,i.arc);break;case oe:e._drawText(t,o,n||i.text,i.text)}})),this.drawExtend&&(t.save(),this.drawExtend({ctx:t,dataSource:this._shapeDataSources,styles:i,viewport:r,precision:n,mode:this._mode,xAxis:this._xAxis,yAxis:this._yAxis,data:this._data}),t.restore())}var a=this._chartStore.shapeStore().mouseOperate();(a.hover.id===this._id&&a.hover.element!==ne||a.click.id===this._id&&a.click.element!==ne||this.isDrawing())&&this._coordinates.forEach((function(r,n){var o=r.x,s=r.y,c=i.point.radius,h=i.point.backgroundColor,l=i.point.borderColor,u=i.point.borderSize;a.hover.id===e._id&&a.hover.element===re&&n===a.hover.elementIndex&&(c=i.point.activeRadius,h=i.point.activeBackgroundColor,l=i.point.activeBorderColor,u=i.point.activeBorderSize),Ot(t,l,{x:o,y:s},c+u),Ot(t,h,{x:o,y:s},c)}))}},{key:"setLock",value:function(t){this._lock=t}},{key:"name",value:function(){return this._name}},{key:"lock",value:function(){return this._lock}},{key:"totalStep",value:function(){return this._totalStep}},{key:"mode",value:function(){return this._mode}},{key:"setMode",value:function(t){Object.values(de).indexOf(t)>-1&&(this._mode=t)}},{key:"setData",value:function(t){return t!==this._data&&(this._data=t,!0)}},{key:"data",value:function(){return this._data}},{key:"points",value:function(){return this._points}},{key:"isDrawing",value:function(){return-1!==this._drawStep}},{key:"isStart",value:function(){return 1===this._drawStep}},{key:"checkEventCoordinateOn",value:function(t){for(var e=this._styles||this._chartStore.styleOptions().shape,i=this._coordinates.length-1;i>-1;i--)if(Nt(this._coordinates[i],e.point.radius,t))return{id:this._id,element:re,elementIndex:i,instance:this};if(this._shapeDataSources){var r,n=Qt(this._shapeDataSources);try{for(n.s();!(r=n.n()).done;){var a=r.value,o=a.key,s=a.type,c=a.dataSource,h=void 0===c?[]:c;if(a.isCheck)for(var l=0;h.length>l;l++)if(this.checkEventCoordinateOnShape({key:o,type:s,dataSource:h[l],eventCoordinate:t}))return{id:this._id,element:ie,elementIndex:l,instance:this}}}catch(t){n.e(t)}finally{n.f()}}}},{key:"_performValue",value:function(t,e,i){var r=this._yAxis.convertFromPixel(t);if(this._mode===de.NORMAL||"candle_pane"!==i)return r;var n=this._chartStore.timeScaleStore().getDataByDataIndex(e);if(!n)return r;if(r>n.high){if(this._mode===de.WEAK_MAGNET){var a=this._yAxis.convertToPixel(n.high);return this._yAxis.convertFromPixel(a-8)>r?n.high:r}return n.high}if(n.low>r){if(this._mode===de.WEAK_MAGNET){var o=this._yAxis.convertToPixel(n.low);return r>this._yAxis.convertFromPixel(o-8)?n.low:r}return n.low}var s=Math.max(n.open,n.close);if(r>s)return n.high-r>r-s?s:n.high;var c=Math.min(n.open,n.close);return c>r?c-r>r-n.low?n.low:c:r-c>s-r?s:c}},{key:"mouseMoveForDrawing",value:function(t,e){var i=this._xAxis.convertFromPixel(t.x),r=this._chartStore.timeScaleStore().dataIndexToTimestamp(i),n=this._performValue(t.y,i,e.paneId);this._points[this._drawStep-1]={timestamp:r,value:n,dataIndex:i},this.performEventMoveForDrawing({step:this._drawStep,mode:this._mode,points:this._points,movePoint:{timestamp:r,value:n,dataIndex:i},xAxis:this._xAxis,yAxis:this._yAxis}),this.onDrawing({id:this._id,step:this._drawStep,points:this._points})}},{key:"mouseLeftButtonDownForDrawing",value:function(){this._drawStep===this._totalStep-1?(this._drawStep=-1,this._chartStore.shapeStore().progressInstanceComplete(),this.onDrawEnd({id:this._id,points:this._points})):this._drawStep++}},{key:"mousePressedPointMove",value:function(t,e){var i=this._chartStore.shapeStore().mouseOperate(),r=i.click.elementIndex;if(!this._lock&&i.click.id===this._id&&i.click.element===re&&-1!==r){var n=this._xAxis.convertFromPixel(t.x),a=this._chartStore.timeScaleStore().dataIndexToTimestamp(n),o=this._performValue(t.y,n,e.paneId);this._points[r].timestamp=a,this._points[r].dataIndex=n,this._points[r].value=o,this.performEventPressedMove({points:this._points,mode:this._mode,pressPointIndex:r,pressPoint:{dataIndex:n,timestamp:a,value:o},xAxis:this._xAxis,yAxis:this._yAxis}),this.onPressedMove({id:this._id,element:re,points:this._points,event:e})}}},{key:"startPressedOtherMove",value:function(t){var e=this._xAxis.convertFromPixel(t.x),i=this._yAxis.convertFromPixel(t.y);this._prevPressPoint={dataIndex:e,value:i},this._prevPoints=x(this._points)}},{key:"mousePressedOtherMove",value:function(t,e){var i=this;if(this._prevPressPoint){var r=this._xAxis.convertFromPixel(t.x),n=this._yAxis.convertFromPixel(t.y),a=r-this._prevPressPoint.dataIndex,o=n-this._prevPressPoint.value;this._points=this._prevPoints.map((function(t){C(t.dataIndex)||(t.dataIndex=i._chartStore.timeScaleStore().timestampToDataIndex(t.timestamp));var e=t.dataIndex+a;return{dataIndex:e,value:t.value+o,timestamp:i._chartStore.timeScaleStore().dataIndexToTimestamp(e)}})),this.onPressedMove({id:this._id,element:ie,points:this._points,event:e})}}},{key:"onDrawStart",value:function(t){}},{key:"onDrawing",value:function(t){}},{key:"onDrawEnd",value:function(t){}},{key:"onPressedMove",value:function(t){}},{key:"onRemove",value:function(t){}},{key:"checkEventCoordinateOnShape",value:function(t){}},{key:"createShapeDataSource",value:function(t){}},{key:"performEventMoveForDrawing",value:function(t){}},{key:"performEventPressedMove",value:function(t){}}]),i}(It),pe=1,ye=2,_e=3;function me(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function ge(t){for(var e=1;arguments.length>e;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?me(Object(i),!0).forEach((function(e){Mt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):me(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function xe(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return Se(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Se(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return t.length>r?{done:!1,value:t[r++]}:{done:!0}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function Se(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);e>i;i++)r[i]=t[i];return r}function ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var be=function(){function t(e){p(this,t),this._chartStore=e,this._templates=this._createTemplates(),this._mouseOperate={click:{id:"",element:ne,elementIndex:-1},hover:{id:"",element:ne,elementIndex:-1}},this._progressInstance=null,this._pressedInstance=null,this._instances=new Map}return _(t,[{key:"_createTemplates",value:function(){var t={},e=v.shapeExtensions;for(var i in e){var r=this._createTemplateClass(e[i]);r&&(t[i]=r)}return t}},{key:"_createTemplateClass",value:function(t){var e=t.name,i=t.totalStep,r=t.checkEventCoordinateOnShape,n=t.createShapeDataSource,a=t.performEventPressedMove,o=t.performEventMoveForDrawing,s=t.drawExtend;if(!(e&&w(i)&&k(r)&&k(n)))return null;var c=function(t){dt(n,t);var r=ke(n);function n(t){var a=t.id,o=t.chartStore,s=t.xAxis,c=t.yAxis,h=t.points,l=t.styles,u=t.lock,f=t.mode,d=t.data;return p(this,n),r.call(this,{id:a,name:e,totalStep:i,chartStore:o,xAxis:s,yAxis:c,points:h,styles:l,lock:u,mode:f,data:d})}return _(n)}(ve);return c.prototype.checkEventCoordinateOnShape=r,c.prototype.createShapeDataSource=n,k(a)&&(c.prototype.performEventPressedMove=a),k(o)&&(c.prototype.performEventMoveForDrawing=o),k(s)&&(c.prototype.drawExtend=s),c}},{key:"addTemplate",value:function(t){var e=this;t.forEach((function(t){var i=e._createTemplateClass(t);i&&(e._templates[t.name]=i)}))}},{key:"getTemplate",value:function(t){return this._templates[t]}},{key:"getInstance",value:function(t){var e,i=xe(this._instances);try{for(i.s();!(e=i.n()).done;){var r=(e.value[1]||[]).find((function(e){return e.id()===t}));if(r)return r}}catch(t){i.e(t)}finally{i.f()}return null}},{key:"hasInstance",value:function(t){return!!this.getInstance(t)}},{key:"addInstance",value:function(t,e){t.isDrawing()?this._progressInstance={paneId:e,instance:t,fixed:C(e)}:(this._instances.has(e)||this._instances.set(e,[]),this._instances.get(e).push(t)),this._chartStore.invalidate(pe)}},{key:"progressInstance",value:function(){return this._progressInstance||{}}},{key:"progressInstanceComplete",value:function(){var t=this.progressInstance(),e=t.instance,i=t.paneId;e&&!e.isDrawing()&&(this._instances.has(i)||this._instances.set(i,[]),this._instances.get(i).push(e),this._progressInstance=null)}},{key:"updateProgressInstance",value:function(t,e){var i=this.progressInstance(),r=i.instance;r&&!i.fixed&&(r.setYAxis(t),this._progressInstance.paneId=e)}},{key:"pressedInstance",value:function(){return this._pressedInstance||{}}},{key:"updatePressedInstance",value:function(t,e,i){this._pressedInstance=t?{instance:t,paneId:e,element:i}:null}},{key:"instances",value:function(t){return this._instances.get(t)||[]}},{key:"setInstanceOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,i=t.styles,r=t.lock,n=t.mode,a=t.data,o=this._chartStore.styleOptions().shape,s=!1;if(C(e)){var c=this.getInstance(e);c&&(c.setLock(r),c.setMode(n),(c.setStyles(i,o)||c.setData(a))&&(s=!0))}else this._instances.forEach((function(t){t.forEach((function(t){t.setLock(r),t.setMode(n),(t.setStyles(i,o)||t.setData(a))&&(s=!0)}))}));s&&this._chartStore.invalidate(pe)}},{key:"getInstanceInfo",value:function(t){var e=function(t){return{name:t.name(),id:t.id(),totalStep:t.totalStep(),lock:t.lock(),mode:t.mode(),points:t.points(),styles:t.styles(),data:t.data()}},i=this.progressInstance();if(!C(t)){var r={};return this._instances.forEach((function(t,n){r[n]=t.map((function(t){return e(t)})),i.paneId===n&&i.instance&&r[n].push(e(i.instance))})),r}if(i.instance&&i.instance.id()===t)return e(i.instance);var n=this.getInstance(t);return n?e(n):null}},{key:"removeInstance",value:function(t){var e=!1,i=this.progressInstance().instance;if(!i||C(t)&&i.id()!==t||(i.onRemove({id:i.id()}),this._progressInstance=null,e=!0),C(t)){var r,n=xe(this._instances);try{for(n.s();!(r=n.n()).done;){var a=r.value,o=a[1]||[],s=o.findIndex((function(e){return e.id()===t}));if(s>-1){o[s].onRemove({id:o[s].id()}),o.splice(s,1),0===o.length&&this._instances.delete(a[0]),e=!0;break}}}catch(t){n.e(t)}finally{n.f()}}else this._instances.forEach((function(t){t.length>0&&t.forEach((function(t){t.onRemove({id:t.id()})}))})),this._instances.clear(),e=!0;e&&this._chartStore.invalidate(pe)}},{key:"mouseOperate",value:function(){return this._mouseOperate}},{key:"setMouseOperate",value:function(t){var e=this._mouseOperate,i=e.hover,r=e.click;!t.hover||i.id===t.hover.id&&i.element===t.hover.element&&i.elementIndex===t.hover.elementIndex||(this._mouseOperate.hover=ge({},t.hover)),!t.click||r.id===t.click.id&&r.element===t.click.element&&r.elementIndex===t.click.elementIndex||(this._mouseOperate.click=ge({},t.click))}},{key:"isEmpty",value:function(){return 0===this._instances.size&&!this.progressInstance().instance}},{key:"isDrawing",value:function(){var t=this.progressInstance().instance;return t&&t.isDrawing()}},{key:"isPressed",value:function(){return!!this.pressedInstance().instance}}]),t}();function we(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return Ce(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ce(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return t.length>r?{done:!1,value:t[r++]}:{done:!0}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function Ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);e>i;i++)r[i]=t[i];return r}function Ae(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}var Ee=function(){function t(e){p(this,t),this._chartStore=e,this._annotations=new Map,this._visibleAnnotations=new Map,this._mouseOperate={id:""}}return _(t,[{key:"mouseOperate",value:function(){return this._mouseOperate}},{key:"setMouseOperate",value:function(t){t&&this._mouseOperate.id!==t.id&&(this._mouseOperate=function(t){for(var e=1;arguments.length>e;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ae(Object(i),!0).forEach((function(e){Mt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ae(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},t))}},{key:"createVisibleAnnotations",value:function(){var t=this;this._visibleAnnotations.clear(),this._annotations.size>0&&this._chartStore.visibleDataList().forEach((function(e){var i=e.data,r=e.x;t._annotations.forEach((function(e,n){if(e.size>0){var a=e.get(i.timestamp)||[];if(a.length>0){var o,s=we(a);try{for(s.s();!(o=s.n()).done;){var c=o.value;c.createSymbolCoordinate(r),t._visibleAnnotations.has(n)?t._visibleAnnotations.get(n).push(c):t._visibleAnnotations.set(n,[c])}}catch(t){s.e(t)}finally{s.f()}}}}))}))}},{key:"add",value:function(t,e){var i=this;this._annotations.has(e)||this._annotations.set(e,new Map),t.forEach((function(t){var r=i._annotations.get(e);r.has(t.id())?r.get(t.id()).push(t):r.set(t.id(),[t])})),this.createVisibleAnnotations(),this._chartStore.invalidate(pe)}},{key:"get",value:function(t){return this._visibleAnnotations.get(t)}},{key:"remove",value:function(t,e){var i=!1;if(C(t)){if(this._annotations.has(t))if(C(e)){var r=this._annotations.get(t);[].concat(e).forEach((function(t){var e=t.timestamp;r.has(e)&&(i=!0,r.delete(e))})),0===r.size&&this._annotations.delete(t),i&&this.createVisibleAnnotations()}else i=!0,this._annotations.delete(t),this._visibleAnnotations.delete(t)}else i=!0,this._annotations.clear(),this._visibleAnnotations.clear();i&&this._chartStore.invalidate(pe)}},{key:"isEmpty",value:function(){return 0===this._visibleAnnotations.size}}]),t}(),Pe=function(){function t(e){p(this,t),this._chartStore=e,this._tags=new Map}return _(t,[{key:"_getById",value:function(t,e){var i=this.get(e);return i?i.get(t):null}},{key:"has",value:function(t,e){return!!this._getById(t,e)}},{key:"update",value:function(t,e,i){var r=this._getById(t,e);return!!r&&r.update(i)}},{key:"get",value:function(t){return this._tags.get(t)}},{key:"add",value:function(t,e){this._tags.has(e)||this._tags.set(e,new Map);var i=this._tags.get(e);t.forEach((function(t){i.set(t.id(),t)})),this._chartStore.invalidate(pe)}},{key:"remove",value:function(t,e){var i=!1;if(C(t)){if(this._tags.has(t))if(C(e)){var r=this._tags.get(t);[].concat(e).forEach((function(t){r.has(t)&&(i=!0,r.delete(t))})),0===r.size&&this._tags.delete(t)}else i=!0,this._tags.delete(t)}else i=!0,this._tags.clear();i&&this._chartStore.invalidate(pe)}}]),t}();function Me(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function Te(t){for(var e=1;arguments.length>e;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Me(Object(i),!0).forEach((function(e){Mt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Me(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ie=function(){function t(e){p(this,t),this._chartStore=e,this._crosshair={}}return _(t,[{key:"set",value:function(t,e){var i,r,n=this._chartStore.dataList(),a=t||{},o=n[r=C(a.x)?0>(i=this._chartStore.timeScaleStore().coordinateToDataIndex(a.x))?0:i>n.length-1?n.length-1:i:i=n.length-1],s=this._chartStore.timeScaleStore().dataIndexToCoordinate(i),c=this._crosshair.x,h=this._crosshair.y,l=this._crosshair.paneId;this._crosshair=Te(Te({},a),{},{realX:s,kLineData:o,realDataIndex:i,dataIndex:r}),o&&this._chartStore.crosshairChange(this._crosshair),c===a.x&&h===a.y&&l===a.paneId||e||this._chartStore.invalidate(pe)}},{key:"recalculate",value:function(t){this.set(this._crosshair,t)}},{key:"get",value:function(){return this._crosshair}}]),t}(),Oe=function(){function t(){p(this,t),this._observers=[]}return _(t,[{key:"subscribe",value:function(t){0>this._observers.indexOf(t)&&this._observers.push(t)}},{key:"unsubscribe",value:function(t){var e=this._observers.indexOf(t);e>-1?this._observers.splice(e,1):this._observers=[]}},{key:"execute",value:function(t){this._observers.forEach((function(e){e(t)}))}},{key:"hasObservers",value:function(){return this._observers.length>0}}]),t}(),De=function(){function t(){p(this,t),this._delegates=new Map}return _(t,[{key:"execute",value:function(t,e){this.has(t)&&this._delegates.get(t).execute(e)}},{key:"has",value:function(t){return this._delegates.has(t)&&this._delegates.get(t).hasObservers()}},{key:"subscribe",value:function(t,e){return!!lt(t)&&(this._delegates.has(t)||this._delegates.set(t,new Oe),this._delegates.get(t).subscribe(e),!0)}},{key:"unsubscribe",value:function(t,e){if(lt(t)){var i=this._delegates.get(t);return i.unsubscribe(e),i.hasObservers()||this._delegates.delete(t),!0}return!1}}]),t}(),Le=function(){function t(e,i){p(this,t),this._handler=i,this._styleOptions=x(et),g(this._styleOptions,e),this._pricePrecision=2,this._volumePrecision=0,this._dataList=[],this._visibleDataList=[],this._dragPaneFlag=!1,this._timeScaleStore=new ut(this),this._technicalIndicatorStore=new Pt(this),this._shapeStore=new be(this),this._annotationStore=new Ee(this),this._tagStore=new Pe(this),this._crosshairStore=new Ie(this),this._actionStore=new De}return _(t,[{key:"adjustVisibleDataList",value:function(){this._visibleDataList=[];for(var t=this._timeScaleStore.from(),e=this._timeScaleStore.to(),i=t;e>i;i++){var r=this._dataList[i],n=this._timeScaleStore.dataIndexToCoordinate(i);this._visibleDataList.push({index:i,x:n,data:r})}this._annotationStore.createVisibleAnnotations()}},{key:"styleOptions",value:function(){return this._styleOptions}},{key:"applyStyleOptions",value:function(t){g(this._styleOptions,t)}},{key:"pricePrecision",value:function(){return this._pricePrecision}},{key:"volumePrecision",value:function(){return this._volumePrecision}},{key:"setPriceVolumePrecision",value:function(t,e){this._pricePrecision=t,this._volumePrecision=e,this._technicalIndicatorStore.setSeriesPrecision(t,e)}},{key:"dataList",value:function(){return this._dataList}},{key:"visibleDataList",value:function(){return this._visibleDataList}},{key:"addData",value:function(t,e,i){if(b(t)){if(S(t)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(!A(i)||i);var r=0===this._dataList.length;this._dataList=t.concat(this._dataList),r&&this._timeScaleStore.resetOffsetRightSpace(),this._timeScaleStore.adjustFromTo()}else if(e<this._dataList.length)this._dataList[e]=t,this.adjustVisibleDataList();else{this._dataList.push(t);var n=this._timeScaleStore.offsetRightBarCount();0>n&&this._timeScaleStore.setOffsetRightBarCount(--n),this._timeScaleStore.adjustFromTo()}this._crosshairStore.recalculate(!0)}}},{key:"clearDataList",value:function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear()}},{key:"timeScaleStore",value:function(){return this._timeScaleStore}},{key:"technicalIndicatorStore",value:function(){return this._technicalIndicatorStore}},{key:"shapeStore",value:function(){return this._shapeStore}},{key:"annotationStore",value:function(){return this._annotationStore}},{key:"tagStore",value:function(){return this._tagStore}},{key:"crosshairStore",value:function(){return this._crosshairStore}},{key:"actionStore",value:function(){return this._actionStore}},{key:"invalidate",value:function(t){this._handler.invalidate(t)}},{key:"crosshairChange",value:function(t){this._handler.crosshair(t)}},{key:"dragPaneFlag",value:function(){return this._dragPaneFlag}},{key:"setDragPaneFlag",value:function(t){this._dragPaneFlag=t}}]),t}();function Re(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pt(t)););return t}function Be(){return Be="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=Re(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(3>arguments.length?t:i):n.value}},Be.apply(this,arguments)}function Fe(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement(t);for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i.style[r]=e[r]);return i}var ze=function(){function t(e){p(this,t),this._height=-1,this._container=e.container,this._chartStore=e.chartStore,this._initBefore(e),this._initElement(),this._mainWidget=this._createMainWidget(this._element,e),this._yAxisWidget=this._createYAxisWidget(this._element,e)}return _(t,[{key:"_initBefore",value:function(t){}},{key:"_initElement",value:function(){this._element=Fe("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"});var t=this._container.lastChild;t?this._container.insertBefore(this._element,t):this._container.appendChild(this._element)}},{key:"_createMainWidget",value:function(t,e){}},{key:"_createYAxisWidget",value:function(t,e){}},{key:"width",value:function(){return this._element.offsetWidth}},{key:"setWidth",value:function(t,e){this._mainWidget.setWidth(t),this._yAxisWidget&&this._yAxisWidget.setWidth(e)}},{key:"height",value:function(){return this._height}},{key:"setHeight",value:function(t){this._height=t,this._mainWidget.setHeight(t),this._yAxisWidget&&this._yAxisWidget.setHeight(t)}},{key:"setOffsetLeft",value:function(t,e){this._mainWidget.setOffsetLeft(t),this._yAxisWidget&&this._yAxisWidget.setOffsetLeft(e)}},{key:"layout",value:function(){this._element.offsetHeight!==this._height&&(this._element.style.height="".concat(this._height,"px")),this._mainWidget.layout(),this._yAxisWidget&&this._yAxisWidget.layout()}},{key:"invalidate",value:function(t){this._yAxisWidget&&this._yAxisWidget.invalidate(t),this._mainWidget.invalidate(t)}},{key:"createHtml",value:function(t){var e=t.id,i=t.content,r=t.style;return"yAxis"===t.position?this._yAxisWidget&&this._yAxisWidget.createHtml({id:e,content:i,style:r}):this._mainWidget.createHtml({id:e,content:i,style:r})}},{key:"removeHtml",value:function(t){this._yAxisWidget&&this._yAxisWidget.removeHtml(t),this._mainWidget.removeHtml(t)}},{key:"getImage",value:function(t){var e=this._element.offsetWidth,i=this._element.offsetHeight,r=Fe("canvas",{width:"".concat(e,"px"),height:"".concat(i,"px"),boxSizing:"border-box"}),n=r.getContext("2d"),a=Kt(r);r.width=e*a,r.height=i*a,n.scale(a,a);var o=this._mainWidget.getElement(),s=o.offsetWidth,c=o.offsetHeight,h=parseInt(o.style.left,10);if(n.drawImage(this._mainWidget.getImage(t),h,0,s,c),this._yAxisWidget){var l=this._yAxisWidget.getElement(),u=l.offsetWidth,f=l.offsetHeight,d=parseInt(l.style.left,10);n.drawImage(this._yAxisWidget.getImage(t),d,0,u,f)}return r}},{key:"destroy",value:function(){this._container.removeChild(this._element)}}]),t}();function Ve(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}var Ne=function(){function t(e){p(this,t),this._width=0,this._height=0,this._initElement(e.container),this._mainView=this._createMainView(this._element,e),this._overlayView=this._createOverlayView(this._element,e),this._htmlBaseId=0,this._htmls=new Map}return _(t,[{key:"_initElement",value:function(t){this._element=Fe("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box"}),t.appendChild(this._element)}},{key:"_createMainView",value:function(t,e){}},{key:"_createOverlayView",value:function(t,e){}},{key:"createHtml",value:function(t){var e=t.id,i=t.content,r=t.style,n=Fe("div",function(t){for(var e=1;arguments.length>e;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ve(Object(i),!0).forEach((function(e){Mt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ve(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({boxSizing:"border-box",position:"absolute",zIndex:12},void 0===r?{}:r));if(E(i)){var a=i.replace(/(^\s*)|(\s*$)/g,"");n.innerHTML=a}else n.appendChild(i);var o=e||"html_".concat(++this._htmlBaseId);return this._htmls.has(o)?this._element.replaceChild(n,this._htmls.get(o)):this._element.appendChild(n),this._htmls.set(o,n),o}},{key:"removeHtml",value:function(t){var e=this;t?[].concat(t).forEach((function(t){var i=e._htmls.get(t);i&&(e._element.removeChild(i),e._htmls.delete(t))})):(this._htmls.forEach((function(t){e._element.removeChild(t)})),this._htmls.clear())}},{key:"getElement",value:function(){return this._element}},{key:"setWidth",value:function(t){this._width=t,this._mainView.setWidth(t),this._overlayView.setWidth(t)}},{key:"setHeight",value:function(t){this._height=t,this._mainView.setHeight(t),this._overlayView.setHeight(t)}},{key:"setOffsetLeft",value:function(t){this._element.style.left="".concat(t,"px")}},{key:"layout",value:function(){this._element.offsetWidth!==this._width&&(this._element.style.width="".concat(this._width,"px")),this._element.offsetHeight!==this._height&&(this._element.style.height="".concat(this._height,"px")),this._mainView.layout(),this._overlayView.layout()}},{key:"invalidate",value:function(t){switch(t){case pe:this._overlayView.flush();break;case ye:case _e:this._mainView.flush(),this._overlayView.flush()}}},{key:"getImage",value:function(t){var e=Fe("canvas",{width:"".concat(this._width,"px"),height:"".concat(this._height,"px"),boxSizing:"border-box"}),i=e.getContext("2d"),r=Kt(e);return e.width=this._width*r,e.height=this._height*r,i.scale(r,r),i.drawImage(this._mainView.getImage(),0,0,this._width,this._height),t&&this._overlayView&&i.drawImage(this._overlayView.getImage(),0,0,this._width,this._height),e}}]),t}();function je(t){return window.requestAnimationFrame?window.requestAnimationFrame(t):window.setTimeout(t,20)}var He=function(){function t(e,i){p(this,t),this._chartStore=i,this._initCanvas(e)}return _(t,[{key:"_initCanvas",value:function(t){this._canvas=Fe("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._ctx=this._canvas.getContext("2d"),t.appendChild(this._canvas)}},{key:"_redraw",value:function(t){this._ctx.clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetHeight),t&&t(),this._draw()}},{key:"_draw",value:function(){}},{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"layout",value:function(){var t=this;this._height!==this._canvas.offsetHeight||this._width!==this._canvas.offsetWidth?this._redraw((function(){var e=Kt(t._canvas);t._canvas.style.width="".concat(t._width,"px"),t._canvas.style.height="".concat(t._height,"px"),t._canvas.width=Math.floor(t._width*e),t._canvas.height=Math.floor(t._height*e),t._ctx.scale(e,e)})):this.flush()}},{key:"flush",value:function(){var t,e=this;this.requestAnimationId&&(t=this.requestAnimationId,window.cancelAnimationFrame||clearTimeout(t),window.cancelAnimationFrame(t),this.requestAnimationId=null),this.requestAnimationId=je((function(){e._redraw()}))}},{key:"getImage",value:function(){return this._canvas}}]),t}();function Ye(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var We=function(t){dt(i,t);var e=Ye(i);function i(t,r,n,a,o){var s;return p(this,i),(s=e.call(this,t,r))._xAxis=n,s._yAxis=a,s._paneId=o,s}return _(i,[{key:"_draw",value:function(){this._ctx.globalCompositeOperation="destination-over",this._drawContent()}},{key:"_drawContent",value:function(){this._drawTechs(),this._drawGrid()}},{key:"_drawGrid",value:function(){var t=this,e=this._chartStore.styleOptions().grid;if(e.show){var i=e.horizontal;this._ctx.save(),i.show&&(this._ctx.strokeStyle=i.color,this._ctx.lineWidth=i.size,this._ctx.setLineDash(i.style===T?i.dashValue:[]),this._yAxis.ticks().forEach((function(e){Ut(t._ctx,e.y,0,t._width)})));var r=e.vertical;r.show&&(this._ctx.strokeStyle=r.color,this._ctx.lineWidth=r.size,this._ctx.setLineDash(r.style===T?r.dashValue:[]),this._xAxis.ticks().forEach((function(e){Xt(t._ctx,e.x,0,t._height)}))),this._ctx.restore()}}},{key:"_drawTechs",value:function(){var t=this;this._ctx.globalCompositeOperation="source-over";var e=this._chartStore.styleOptions().technicalIndicator;this._chartStore.technicalIndicatorStore().instances(this._paneId).forEach((function(i){var r=i.plots,n=[],a=t._chartStore.dataList(),o=i.result,s=i.styles||e;i.render&&(t._ctx.save(),i.render({ctx:t._ctx,dataSource:{from:t._chartStore.timeScaleStore().from(),to:t._chartStore.timeScaleStore().to(),kLineDataList:t._chartStore.dataList(),technicalIndicatorDataList:o},viewport:{width:t._width,height:t._height,dataSpace:t._chartStore.timeScaleStore().dataSpace(),barSpace:t._chartStore.timeScaleStore().barSpace()},styles:s,xAxis:t._xAxis,yAxis:t._yAxis}),t._ctx.restore());var c=s.line.colors||[],h=c.length,l=t._yAxis.isCandleYAxis();t._ctx.lineWidth=1,t._drawGraphics((function(e,u,f,d,v){var p=o[u]||{},y=0;i.shouldOhlc&&!l&&t._drawCandleBar(e,d,v,u,f,s.bar,j),r.forEach((function(i){var r=p[i.key],l=t._yAxis.convertToPixel(r);switch(i.type){case St:if(C(r)){var f=bt(a,o,u,i,s,{color:s.circle.noChangeColor,isStroke:!0});t._drawCircle({x:e,y:l,radius:d,color:f.color,isStroke:f.isStroke})}break;case xt:if(C(r)){var v;v=C(i.baseValue)?i.baseValue:t._yAxis.min();var _=t._yAxis.convertToPixel(v),m=Math.abs(_-l),g={x:e-d,width:2*d,height:Math.max(1,m)};g.y=l>_?_:1>m?_-1:l;var x=bt(a,o,u,i,s,{color:s.bar.noChangeColor});g.color=x.color,g.isStroke=x.isStroke,t._drawBar(g)}break;case gt:var S=null;if(C(r)&&(S={x:e,y:l}),n[y])n[y].coordinates.push(S);else{var k=bt(a,o,u,i,s,{color:c[y%h]});n[y]={color:k.color,coordinates:[S]}}y++}}))}),(function(){t._drawLines(n,s)}))})),this._ctx.globalCompositeOperation="destination-over"}},{key:"_drawGraphics",value:function(t,e){var i=this._chartStore.visibleDataList(),r=this._chartStore.timeScaleStore().barSpace(),n=this._chartStore.timeScaleStore().halfBarSpace();i.forEach((function(e,i){t(e.x,e.index,e.data,n,r,i)})),e&&e()}},{key:"_drawLines",value:function(t,e){var i=this;this._ctx.lineWidth=e.line.size,t.forEach((function(t){i._ctx.strokeStyle=t.color,Gt(i._ctx,t.coordinates)}))}},{key:"_drawBar",value:function(t){t.isStroke?(this._ctx.strokeStyle=t.color,this._ctx.strokeRect(t.x+.5,t.y,t.width-1,t.height)):(this._ctx.fillStyle=t.color,this._ctx.fillRect(t.x,t.y,t.width,t.height))}},{key:"_drawCircle",value:function(t){this._ctx.strokeStyle=t.color,this._ctx.fillStyle=t.color,this._ctx.beginPath(),this._ctx.arc(t.x,t.y,t.radius,2*Math.PI,0,!0),t.isStroke?this._ctx.stroke():this._ctx.fill(),this._ctx.closePath()}},{key:"_drawCandleBar",value:function(t,e,i,r,n,a,o){var s=n.open,c=n.close,h=n.high,l=n.low;c>s?(this._ctx.strokeStyle=a.upColor,this._ctx.fillStyle=a.upColor):s>c?(this._ctx.strokeStyle=a.downColor,this._ctx.fillStyle=a.downColor):(this._ctx.strokeStyle=a.noChangeColor,this._ctx.fillStyle=a.noChangeColor);var u=this._yAxis.convertToPixel(s),f=this._yAxis.convertToPixel(c),d=this._yAxis.convertToPixel(h),v=this._yAxis.convertToPixel(l),p=Math.min(u,f),y=Math.max(u,f);this._ctx.fillRect(t-.5,d,1,p-d),this._ctx.fillRect(t-.5,y,1,v-y);var _=Math.max(1,y-p);switch(o){case F:this._ctx.fillRect(t-e,p,i,_);break;case z:this._ctx.strokeRect(t-e+.5,p,i-1,_);break;case V:c>s?this._ctx.strokeRect(t-e+.5,p,i-1,_):this._ctx.fillRect(t-e,p,i,_);break;case N:c>s?this._ctx.fillRect(t-e,p,i,_):this._ctx.strokeRect(t-e+.5,p,i-1,_);break;default:this._ctx.fillRect(t-.5,d,1,v-d),this._ctx.fillRect(t-e,u-.5,e,1),this._ctx.fillRect(t,f-.5,e,1)}}}]),i}(He);function Ue(t,e,i,r,n){t.fillStyle=e,t.fillText(n,i,r)}function Xe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var Ge=function(t){dt(i,t);var e=Xe(i);function i(t,r,n,a,o){var s;return p(this,i),(s=e.call(this,t,r))._xAxis=n,s._yAxis=a,s._paneId=o,s}return _(i,[{key:"_draw",value:function(){this._ctx.textBaseline="alphabetic",this._drawTag(),this._drawShape(),this._drawAnnotation();var t=this._chartStore.crosshairStore().get();if(t.kLineData){var e=this._chartStore.styleOptions().crosshair;t.paneId===this._paneId&&this._drawCrosshairLine(e,"horizontal",t.y,0,this._width,Ut),t.paneId&&this._drawCrosshairLine(e,"vertical",t.realX,0,this._height,Xt),this._drawTooltip(t,this._chartStore.technicalIndicatorStore().instances(this._paneId))}}},{key:"_drawAnnotation",value:function(){var t=this,e=this._chartStore.annotationStore().get(this._paneId);e&&e.forEach((function(e){e.draw(t._ctx)}))}},{key:"_drawTag",value:function(){var t=this,e=this._chartStore.tagStore().get(this._paneId);e&&e.forEach((function(e){e.drawMarkLine(t._ctx)}))}},{key:"_drawShape",value:function(){var t=this;this._chartStore.shapeStore().instances(this._paneId).forEach((function(e){e.draw(t._ctx)}));var e=this._chartStore.shapeStore().progressInstance();e.paneId===this._paneId&&e.instance.draw(this._ctx)}},{key:"_drawTooltip",value:function(t,e){var i=this._chartStore.styleOptions().technicalIndicator;this._drawBatchTechToolTip(t,e,i,0,this._shouldDrawTooltip(t,i.tooltip))}},{key:"_drawCrosshairLine",value:function(t,e,i,r,n,a){var o=t[e],s=o.line;t.show&&o.show&&s.show&&(this._ctx.save(),this._ctx.lineWidth=s.size,this._ctx.strokeStyle=s.color,s.style===T&&this._ctx.setLineDash(s.dashValue),a(this._ctx,i,r,n),this._ctx.restore())}},{key:"_drawBatchTechToolTip",value:function(t,e,i){var r=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;if(a){var o=i.tooltip,s=n;e.forEach((function(e){r._drawTechTooltip(t,e,i,s),s+=o.text.marginTop+o.text.size+o.text.marginBottom}))}}},{key:"_drawTechTooltip",value:function(t,e,i){var r=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=i.tooltip,o=a.text,s=o.marginLeft,c=o.marginRight,h=o.size,l=o.color,u=0,f=o.marginTop+n,d=this._getTechTooltipData(t,e,i);if(this._ctx.textBaseline="top",this._ctx.font=Jt(h,o.weight,o.family),a.showName){var v=d.name,p=Zt(this._ctx,v);Ue(this._ctx,l,u+=s,f,v),u+=p,a.showParams||(u+=c)}if(a.showParams){var y=d.calcParamText,_=Zt(this._ctx,y);a.showName||(u+=s),Ue(this._ctx,l,u,f,y),u+=_+c}d.values.forEach((function(t){u+=s;var e="".concat(t.title).concat(t.value),i=Zt(r._ctx,e);Ue(r._ctx,t.color||o.color,u,f,e),u+=i+c}))}},{key:"_shouldDrawTooltip",value:function(t,e){var i=e.showRule;return i===Y||i===W&&!!t.paneId}},{key:"_getTechTooltipData",value:function(t,e,i){var r=this._chartStore.dataList(),n=e.result,a=e.calcParams,o="";if(a.length>0){var s=a.map((function(t){return b(t)?t.value:t}));o="(".concat(s.join(","),")")}var c=[];if(k(e.createToolTipDataSource))c=e.createToolTipDataSource({dataSource:{from:this._chartStore.timeScaleStore().from(),to:this._chartStore.timeScaleStore().to(),kLineDataList:this._chartStore.dataList(),technicalIndicatorDataList:n},viewport:{width:this._width,height:this._height,dataSpace:this._chartStore.timeScaleStore().dataSpace(),barSpace:this._chartStore.timeScaleStore().barSpace()},crosshair:t,technicalIndicator:e,xAxis:this._xAxis,yAxis:this._yAxis,defaultStyles:i})||[];else{var h=e.styles||i,l=n[t.dataIndex],u=e.precision,f=e.shouldFormatBigNumber,d=h.line.colors||[],v=d.length,p=0;e.plots.forEach((function(e){var a={};switch(e.type){case St:a={color:h.circle.noChangeColor};break;case xt:a={color:h.bar.noChangeColor};break;case gt:a={color:d[p%v]||i.tooltip.text.color},p++}var o=bt(r,n,t.dataIndex,e,h,a),s={};if(C(e.title)){var y=(l||{})[e.key];C(y)&&(y=nt(y,u),f&&(y=at(y))),s.title=e.title,s.value=y||i.tooltip.defaultValue,s.color=o.color}c.push(s)}))}var y="";return c.length>0&&(y=e.shortName||e.name),{values:c,name:y,calcParamText:o}}}]),i}(He);function Ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var Ze=function(t){dt(i,t);var e=Ke(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_createMainView",value:function(t,e){return new We(t,e.chartStore,e.xAxis,e.yAxis,e.paneId)}},{key:"_createOverlayView",value:function(t,e){return new Ge(t,e.chartStore,e.xAxis,e.yAxis,e.paneId)}}]),i}(Ne);function Je(t,e,i,r,n,a,o,s,c){qe(t,e,n,a,o,s,c),$e(t,i,r,n,a,o,s,c)}function $e(t,e,i,r,n,a,o,s){t.lineWidth=i,t.strokeStyle=e,Qe(t,r,n,a,o,s),t.stroke()}function qe(t,e,i,r,n,a,o){t.fillStyle=e,Qe(t,i,r,n,a,o),t.fill()}function Qe(t,e,i,r,n,a){t.beginPath(),t.moveTo(e+a,i),t.arcTo(e+r,i,e+r,i+n,a),t.arcTo(e+r,i+n,e,i+n,a),t.arcTo(e,i+n,e,i,a),t.arcTo(e,i,e+r,i,a),t.closePath()}function ti(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function ei(t){for(var e=1;arguments.length>e;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ti(Object(i),!0).forEach((function(e){Mt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ti(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function ii(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var ri=function(t){dt(i,t);var e=ii(i);function i(t,r,n,a){var o;return p(this,i),(o=e.call(this,t,r))._yAxis=n,o._paneId=a,o}return _(i,[{key:"_draw",value:function(){var t=this._chartStore.styleOptions().yAxis;t.show&&(this._drawAxisLine(t),this._drawTickLines(t),this._drawTickLabels(t),this._drawTechLastValue(),this._drawLastPriceLabel())}},{key:"_drawAxisLine",value:function(t){var e,i=t.axisLine;i.show&&(this._ctx.strokeStyle=i.color,this._ctx.lineWidth=i.size,e=this._yAxis.isFromYAxisZero()?0:this._width-1,Xt(this._ctx,e,0,this._height))}},{key:"_drawTickLines",value:function(t){var e=this,i=t.tickLine;if(i.show){this._ctx.lineWidth=i.size,this._ctx.strokeStyle=i.color;var r,n,a=i.length;this._yAxis.isFromYAxisZero()?(r=0,t.axisLine.show&&(r+=t.axisLine.size),n=r+a):(r=this._width,t.axisLine.show&&(r-=t.axisLine.size),n=r-a),this._yAxis.ticks().forEach((function(t){Ut(e._ctx,t.y,r,n)}))}}},{key:"_drawTickLabels",value:function(t){var e=this,i=t.tickText;if(i.show){var r,n=t.tickLine,a=n.show,o=n.length;this._yAxis.isFromYAxisZero()?(r=i.paddingLeft,t.axisLine.show&&(r+=t.axisLine.size),a&&(r+=o),this._ctx.textAlign="left"):(r=this._width-i.paddingRight,t.axisLine.show&&(r-=t.axisLine.size),a&&(r-=o),this._ctx.textAlign="right"),this._ctx.textBaseline="middle",this._ctx.font=Jt(i.size,i.weight,i.family),this._ctx.fillStyle=i.color,this._yAxis.ticks().forEach((function(t){e._ctx.fillText(t.v,r,t.y)})),this._ctx.textAlign="left"}}},{key:"_drawTechLastValue",value:function(){var t=this,e=this._chartStore.styleOptions().technicalIndicator,i=e.lastValueMark;if(i.show&&i.text.show){var r=this._chartStore.technicalIndicatorStore().instances(this._paneId),n=this._chartStore.dataList();r.forEach((function(r){var a=r.result||[],o=a.length,s=a[o-1]||{},c={prev:{kLineData:n[o-2],technicalIndicatorData:a[o-2]},current:{kLineData:n[o-1],technicalIndicatorData:s},next:{kLineData:null,technicalIndicatorData:null}},h=r.precision,l=r.styles||e,u=l.line.colors||[],f=u.length,d=0;r.plots.forEach((function(e){var n,a=s[e.key];switch(e.type){case St:n=e.color&&e.color(c,l)||l.circle.noChangeColor;break;case xt:n=e.color&&e.color(c,l)||l.bar.noChangeColor;break;case gt:n=u[d%f],d++}C(a)&&t._drawMarkLabel(a,h,r.shouldFormatBigNumber,ei(ei({},i.text),{},{backgroundColor:n}))}))}))}}},{key:"_drawLastPriceLabel",value:function(){if(this._yAxis.isCandleYAxis()){var t=this._chartStore.styleOptions().candle.priceMark,e=t.last;if(t.show&&e.show&&e.text.show){var i=this._chartStore.dataList(),r=i[i.length-1];if(r){var n,a=r.close,o=r.open;n=a>o?e.upColor:o>a?e.downColor:e.noChangeColor,this._drawMarkLabel(a,this._chartStore.pricePrecision(),!1,ei(ei({},e.text),{},{backgroundColor:n}))}}}}},{key:"_drawMarkLabel",value:function(t,e,i,r){var n,a=r.size,o=r.weight,s=r.family,c=r.color,h=r.backgroundColor,l=r.borderRadius,u=r.paddingLeft,f=r.paddingTop,d=r.paddingRight,v=r.paddingBottom,p=this._yAxis.convertToNicePixel(t);if(this._yAxis.yAxisType()===R){var y=((this._chartStore.visibleDataList()[0]||{}).data||{}).close;n="".concat(((t-y)/y*100).toFixed(2),"%")}else n=nt(t,e),i&&(n=at(n));this._ctx.font=Jt(a,o,s);var _,m=Zt(this._ctx,n)+u+d,g=f+a+v;_=this._yAxis.isFromYAxisZero()?0:this._width-m,qe(this._ctx,h,_,p-f-a/2,m,g,l),this._ctx.textBaseline="middle",Ue(this._ctx,c,_+u,p,n)}}]),i}(He);function ni(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var ai=function(t){dt(i,t);var e=ni(i);function i(t,r,n,a){var o;return p(this,i),(o=e.call(this,t,r))._yAxis=n,o._paneId=a,o}return _(i,[{key:"_draw",value:function(){this._ctx.textBaseline="middle",this._drawTag(),this._drawCrossHairLabel()}},{key:"_drawTag",value:function(){var t=this,e=this._chartStore.tagStore().get(this._paneId);e&&e.forEach((function(e){e.drawText(t._ctx)}))}},{key:"_drawCrossHairLabel",value:function(){var t=this._chartStore.crosshairStore().get();if(t.paneId===this._paneId&&0!==this._chartStore.dataList().length){var e=this._chartStore.styleOptions().crosshair,i=e.horizontal,r=i.text;if(e.show&&i.show&&r.show){var n,a,o=this._yAxis.convertFromPixel(t.y);if(this._yAxis.yAxisType()===R){var s=(this._chartStore.visibleDataList()[0]||{}).data||{};n="".concat(((o-s.close)/s.close*100).toFixed(2),"%")}else{var c=this._chartStore.technicalIndicatorStore().instances(this._paneId),h=0,l=!1;this._yAxis.isCandleYAxis()?h=this._chartStore.pricePrecision():c.forEach((function(t){h=Math.max(t.precision,h),l||(l=t.shouldFormatBigNumber)})),n=nt(o,h),l&&(n=at(n))}var u=r.borderSize,f=$t(this._ctx,n,r),d=qt(r);a=this._yAxis.isFromYAxisZero()?0:this._width-f,Je(this._ctx,r.backgroundColor,r.borderColor,u,a,t.y-u-r.paddingTop-r.size/2,f,d,r.borderRadius),Ue(this._ctx,r.color,a+u+r.paddingLeft,t.y,n)}}}}]),i}(He);function oi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var si=function(t){dt(i,t);var e=oi(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_createMainView",value:function(t,e){return new ri(t,e.chartStore,e.yAxis,e.paneId)}},{key:"_createOverlayView",value:function(t,e){return new ai(t,e.chartStore,e.yAxis,e.paneId)}}]),i}(Ne),ci=function(){function t(e){p(this,t),this._chartStore=e,this._width=0,this._height=0,this._cacheMinValue=0,this._cacheMaxValue=0,this._minValue=0,this._maxValue=0,this._range=0,this._ticks=[],this._initMeasureCanvas()}return _(t,[{key:"_initMeasureCanvas",value:function(){var t=Fe("canvas"),e=Kt(t);this._measureCtx=t.getContext("2d"),this._measureCtx.scale(e,e)}},{key:"min",value:function(){return this._minValue}},{key:"max",value:function(){return this._maxValue}},{key:"width",value:function(){return this._width}},{key:"height",value:function(){return this._height}},{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"ticks",value:function(){return this._ticks}},{key:"computeAxis",value:function(t){var e=this._optimalMinMax(this._computeMinMax());return this._minValue=e.min,this._maxValue=e.max,this._range=e.range,!(this._cacheMinValue===e.min&&this._cacheMaxValue===e.max&&!t)&&(this._cacheMinValue=e.min,this._cacheMaxValue=e.max,this._ticks=this._optimalTicks(this._computeTicks()),!0)}},{key:"_computeMinMax",value:function(){}},{key:"_optimalMinMax",value:function(t){}},{key:"_computeTicks",value:function(){var t=[];if(this._range>=0){var e=this._computeInterval(this._range),i=e.interval,r=e.precision,n=ot(Math.ceil(this._minValue/i)*i,r),a=ot(Math.floor(this._maxValue/i)*i,r),o=0,s=n;if(0!==i)for(;a>=s;)t[o]={v:s.toFixed(r)},++o,s+=i}return t}},{key:"_optimalTicks",value:function(t){}},{key:"_computeInterval",value:function(t){var e,i,r,n,a=(i=Math.floor(st(e=t/8)),r=ct(i),e=(1.5>(n=e/r)?1:2.5>n?2:3.5>n?3:4.5>n?4:5.5>n?5:6.5>n?6:8)*r,-20>i?e:+e.toFixed(0>i?-i:0)),o=function(t){var e=""+t,i=e.indexOf("e");if(i>0){var r=+e.slice(i+1);return 0>r?-r:0}var n=e.indexOf(".");return 0>n?0:e.length-1-n}(a);return{interval:a,precision:o}}}]),t}();function hi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var li=function(t){dt(i,t);var e=hi(i);function i(t,r,n){var a;return p(this,i),(a=e.call(this,t))._realRange=0,a._isCandleYAxis=r,a._paneId=n,a}return _(i,[{key:"_computeMinMax",value:function(){var t,e=this,i=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],r=[],n=!1,a=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;this._chartStore.technicalIndicatorStore().instances(this._paneId).forEach((function(i){if(n||(n=i.shouldOhlc),s=Math.min(s,i.precision),w(i.minValue)&&(a=Math.min(a,i.minValue)),w(i.maxValue)&&(o=Math.max(o,i.maxValue)),i.styles){t||(t={top:0,bottom:0});var c=i.styles.margin;w(c.top)&&(t.top=Math.max(1>c.top?c.top:c.top/e._height,t.top)),w(c.bottom)&&(t.bottom=Math.max(1>c.bottom?c.bottom:c.bottom/e._height,t.bottom))}r.push({plots:i.plots,result:i.result})}));var c=4;if(this._isCandleYAxis){var h=this._chartStore.pricePrecision();c=s!==Number.MAX_SAFE_INTEGER?Math.min(s,h):h}else s!==Number.MAX_SAFE_INTEGER&&(c=s);var l=this._chartStore.visibleDataList(),u=this._chartStore.styleOptions().candle,f=u.type===H,d=u.area.value,v=this._isCandleYAxis&&!f||!this._isCandleYAxis&&n;return l.forEach((function(t){var n=t.index,a=t.data;v&&(i[0]=Math.min(i[0],a.low),i[1]=Math.max(i[1],a.high)),e._isCandleYAxis&&f&&(i[0]=Math.min(i[0],a[d]),i[1]=Math.max(i[1],a[d])),r.forEach((function(t){var e=t.result[n]||{};t.plots.forEach((function(t){var r=e[t.key];C(r)&&(i[0]=Math.min(i[0],r),i[1]=Math.max(i[1],r))}))}))})),i[0]!==Number.MAX_SAFE_INTEGER&&i[1]!==Number.MIN_SAFE_INTEGER?(i[0]=Math.min(a,i[0]),i[1]=Math.max(o,i[1])):(i[0]=0,i[1]=10),{min:i[0],max:i[1],precision:c,specifyMin:a,specifyMax:o,techGap:t}}},{key:"_optimalMinMax",value:function(t){var e,i,r=t.precision,n=t.specifyMin,a=t.specifyMax,o=t.techGap,s=t.min,c=t.max,h=this.yAxisType();switch(h){case R:var l=(this._chartStore.visibleDataList()[0]||{}).data||{};w(l.close)&&(s=(s-l.close)/l.close*100,c=(c-l.close)/l.close*100),e=.01;break;case B:s=st(s),c=st(c),e=.05*ct(-r);break;default:e=ct(-r)}if(s===c||e>Math.abs(s-c)){var u=n===s,f=a===c;s=u?s:f?s-8*e:s-4*e,c=f?c:u?c+8*e:c+4*e}var d,v=.2;w((i=this._isCandleYAxis?this._chartStore.styleOptions().candle.margin:o?{top:0,bottom:0}:this._chartStore.styleOptions().technicalIndicator.margin).top)&&(d=1>i.top?i.top:i.top/this._height,v=o?Math.max(o.top,d):d);var p,y=.1;w(i.bottom)&&(p=1>i.bottom?i.bottom:i.bottom/this._height,y=o?Math.max(o.bottom,p):p);var _=Math.abs(c-s);return _=Math.abs((c+=_*v)-(s-=_*y)),this._realRange=h===B?Math.abs(ct(c)-ct(s)):_,{min:s,max:c,range:_}}},{key:"_optimalTicks",value:function(t){var e=this,i=[],r=this.yAxisType(),n=this._chartStore.technicalIndicatorStore().instances(this._paneId),a=0,o=!1;this._isCandleYAxis?a=this._chartStore.pricePrecision():n.forEach((function(t){a=Math.max(a,t.precision),o||(o=t.shouldFormatBigNumber)}));var s,c,h=this._chartStore.styleOptions().xAxis.tickText.size;return r===B&&(s=this._computeInterval(this._realRange)),t.forEach((function(t){var n,l=t.v,u=e._innerConvertToPixel(+l);switch(r){case R:n="".concat(nt(l,2),"%");break;case B:n=ot(ct(l),s.precision),u=e._innerConvertToPixel(st(n)),n=nt(n,a);break;default:n=nt(l,a),o&&(n=at(n))}u>h&&e._height-h>u&&(c&&c-u>2*h||!c)&&(i.push({v:n,y:u}),c=u)})),i}},{key:"_innerConvertToPixel",value:function(t){return Math.round((1-(t-this._minValue)/this._range)*this._height)}},{key:"isCandleYAxis",value:function(){return this._isCandleYAxis}},{key:"yAxisType",value:function(){return this._isCandleYAxis?this._chartStore.styleOptions().yAxis.type:L}},{key:"isFromYAxisZero",value:function(){var t=this._chartStore.styleOptions().yAxis;return t.position===O&&t.inside||t.position===D&&!t.inside}},{key:"getSelfWidth",value:function(){var t=this,e=this._chartStore.styleOptions(),i=e.yAxis,r=i.width;if(w(r))return r;var n=0;if(i.show&&(i.axisLine.show&&(n+=i.axisLine.size),i.tickLine.show&&(n+=i.tickLine.length),i.tickText.show)){var a=0;this._measureCtx.font=Jt(i.tickText.size,i.tickText.weight,i.tickText.family),this._ticks.forEach((function(e){a=Math.max(a,Zt(t._measureCtx,e.v))})),n+=i.tickText.paddingLeft+i.tickText.paddingRight+a}var o=e.crosshair,s=0;if(o.show&&o.horizontal.show&&o.horizontal.text.show){var c=this._chartStore.technicalIndicatorStore().instances(this._paneId),h=0,l=!1;c.forEach((function(t){h=Math.max(t.precision,h),l||(l=t.shouldFormatBigNumber)})),this._measureCtx.font=Jt(o.horizontal.text.size,o.horizontal.text.weight,o.horizontal.text.family);var u=2;if(this.yAxisType()!==R)if(this._isCandleYAxis){var f=this._chartStore.pricePrecision(),d=e.technicalIndicator.lastValueMark;u=d.show&&d.text.show?Math.max(h,f):f}else u=h;var v=nt(this._maxValue,u);l&&(v=at(v)),s+=o.horizontal.text.paddingLeft+o.horizontal.text.paddingRight+2*o.horizontal.text.borderSize+Zt(this._measureCtx,v)}return Math.max(n,s)}},{key:"convertFromPixel",value:function(t){var e=(1-t/this._height)*this._range+this._minValue;switch(this.yAxisType()){case R:var i=(this._chartStore.visibleDataList()[0]||{}).data||{};if(w(i.close))return i.close*e/100+i.close;break;case B:return ct(e);default:return e}}},{key:"convertToPixel",value:function(t){var e;switch(this.yAxisType()){case R:var i=(this._chartStore.visibleDataList()[0]||{}).data||{};w(i.close)&&(e=(t-i.close)/i.close*100);break;case B:e=st(t);break;default:e=t}return this._innerConvertToPixel(e)}},{key:"convertToNicePixel",value:function(t){var e=this.convertToPixel(t);return Math.round(Math.max(.05*this._height,Math.min(e,.98*this._height)))}}]),i}(ci);function ui(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var fi=function(t){dt(i,t);var e=ui(i);function i(t){var r;return p(this,i),r=e.call(this,t),"height"in t&&r.setHeight(t.height),r}return _(i,[{key:"_initBefore",value:function(t){this._id=t.id,this._yAxis=this._createYAxis(t)}},{key:"_createYAxis",value:function(t){return new li(t.chartStore,!1,t.id)}},{key:"_createMainWidget",value:function(t,e){return new Ze({container:t,chartStore:e.chartStore,xAxis:e.xAxis,yAxis:this._yAxis,paneId:e.id})}},{key:"_createYAxisWidget",value:function(t,e){return new si({container:t,chartStore:e.chartStore,yAxis:this._yAxis,paneId:e.id})}},{key:"setHeight",value:function(t){Be(pt(i.prototype),"setHeight",this).call(this,t),this._yAxis.setHeight(t)}},{key:"setWidth",value:function(t,e){Be(pt(i.prototype),"setWidth",this).call(this,t,e),this._yAxis.setWidth(e)}},{key:"id",value:function(){return this._id}},{key:"yAxis",value:function(){return this._yAxis}}]),i}(ze);function di(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var vi=function(t){dt(i,t);var e=di(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_drawContent",value:function(){var t=this._chartStore.styleOptions().candle;this._drawLastPriceLine(t.priceMark),t.type===H?this._drawArea(t):(this._drawLowHighPrice(t.priceMark,"high","high",Number.MIN_SAFE_INTEGER,[-2,-5],(function(t,e){if(t>e)return t})),this._drawLowHighPrice(t.priceMark,"low","low",Number.MAX_SAFE_INTEGER,[2,5],(function(t,e){if(e>t)return t})),this._drawCandle(t)),this._drawTechs(),this._drawGrid()}},{key:"_drawArea",value:function(t){var e=this,i=[],r=[],n=Number.MAX_SAFE_INTEGER,a=t.area;this._drawGraphics((function(t,o,s,c,h,l){var u=s[a.value];if(w(u)){var f=e._yAxis.convertToPixel(u);if(0===l){var d=t-c;r.push({x:d,y:e._height}),r.push({x:d,y:f}),i.push({x:d,y:f})}i.push({x:t,y:f}),r.push({x:t,y:f}),n=Math.min(n,f)}}),(function(){var t=r.length;if(t>0){var o=r[t-1],s=e._chartStore.timeScaleStore().halfBarSpace(),c=o.x+s;i.push({x:c,y:o.y}),r.push({x:c,y:o.y}),r.push({x:c,y:e._height})}if(i.length>0&&(e._ctx.lineWidth=a.lineSize,e._ctx.strokeStyle=a.lineColor,Gt(e._ctx,i)),r.length>0){var h=a.backgroundColor;if(S(h)){var l=e._ctx.createLinearGradient(0,e._height,0,n);try{h.forEach((function(t){l.addColorStop(t.offset,t.color)}))}catch(t){}e._ctx.fillStyle=l}else e._ctx.fillStyle=h;Wt(e._ctx,r)}}))}},{key:"_drawCandle",value:function(t){var e=this;this._drawGraphics((function(i,r,n,a,o){e._drawCandleBar(i,a,o,r,n,t.bar,t.type)}))}},{key:"_drawLowHighPrice",value:function(t,e,i,r,n,a){var o=t[e];if(t.show&&o.show){var s=this._chartStore.visibleDataList(),c=r,h=-1;s.forEach((function(t){var e=t.index,n=a(it(t.data,i,r),c);n&&(c=n,h=e)}));var l=this._chartStore.pricePrecision(),u=this._yAxis.convertToPixel(c),f=this._xAxis.convertToPixel(h),d=u+n[0];this._ctx.textAlign="left",this._ctx.lineWidth=1,this._ctx.strokeStyle=o.color,this._ctx.fillStyle=o.color,Gt(this._ctx,[{x:f-2,y:d+n[0]},{x:f,y:d},{x:f+2,y:d+n[0]}]);var v=d+n[1];Gt(this._ctx,[{x:f,y:d},{x:f,y:v},{x:f+5,y:v}]),this._ctx.font=Jt(o.textSize,o.textWeight,o.textFamily);var p=nt(c,l);this._ctx.textBaseline="middle",this._ctx.fillText(p,f+5+o.textMargin,v)}}},{key:"_drawLastPriceLine",value:function(t){var e=t.last;if(t.show&&e.show&&e.line.show){var i=this._chartStore.dataList(),r=i[i.length-1];if(r){var n,a=r.close,o=r.open,s=this._yAxis.convertToNicePixel(a);n=a>o?e.upColor:o>a?e.downColor:e.noChangeColor,this._ctx.save(),this._ctx.strokeStyle=n,this._ctx.lineWidth=e.line.size,e.line.style===T&&this._ctx.setLineDash(e.line.dashValue),Ut(this._ctx,s,0,this._width),this._ctx.restore()}}}}]),i}(We);function pi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var yi=function(t){dt(i,t);var e=pi(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_drawTooltip",value:function(t,e){var i=this._chartStore.styleOptions(),r=i.candle,n=r.tooltip,a=i.technicalIndicator,o=a.tooltip,s=this._shouldDrawTooltip(t,n),c=this._shouldDrawTooltip(t,o);n.showType===U&&o.showType===U?this._drawCandleTooltipWithRect(t,e,r,s,a,c):n.showType===X?(this._drawCandleTooltipWithStandard(t.kLineData,r,s),o.showType===X?this._drawBatchTechToolTip(t,e,a,s?n.text.size+n.text.marginTop:0,c):this._drawCandleTooltipWithRect(t,e,r,!1,a,c)):(this._drawCandleTooltipWithRect(t,e,r,s,a,!1),this._drawBatchTechToolTip(t,e,a,0,c))}},{key:"_drawCandleTooltipWithStandard",value:function(t,e,i){var r=this;if(i){var n=this._getCandleTooltipData(t,e),a=e.tooltip,o=a.text.marginLeft,s=a.text.marginRight,c=a.text.size,h=a.text.color,l=a.labels;this._ctx.textBaseline="top",this._ctx.font=Jt(c,a.text.weight,a.text.family);var u=o,f=a.text.marginTop;l.forEach((function(t,e){var i=Zt(r._ctx,t);Ue(r._ctx,h,u,f,t),u+=i;var c,l,d=n[e]||a.defaultValue;b(d)?(c=d.value||a.defaultValue,l=d.color||h):(l=h,c=d);var v=Zt(r._ctx,c);Ue(r._ctx,l,u,f,c),u+=v+o+s}))}}},{key:"_drawCandleTooltipWithRect",value:function(t,e,i,r,n,a){var o=this;if(r||a){var s=i.tooltip,c=s.labels,h=this._getCandleTooltipData(t.kLineData,i),l=s.text.marginLeft,u=s.text.marginRight,f=s.text.marginTop,d=s.text.marginBottom,v=s.text.size,p=s.text.color,y=s.rect,_=y.borderSize,m=y.paddingLeft,g=y.paddingRight,x=y.paddingTop,S=y.paddingBottom,k=y.offsetLeft,w=y.offsetRight,A=0,E=0,P=0;this._ctx.save(),this._ctx.textBaseline="top",r&&(this._ctx.font=Jt(v,s.text.weight,s.text.family),c.forEach((function(t,e){var i,r=h[e];i=b(r)?r.value||s.defaultValue:r;var n="".concat(t).concat(i),a=Zt(o._ctx,n)+l+u;A=Math.max(A,a)})),P+=(d+f+v)*c.length);var M=n.tooltip,T=M.text.marginLeft,I=M.text.marginRight,O=M.text.marginTop,D=M.text.marginBottom,L=M.text.size,R=[];if(e.forEach((function(e){R.push(o._getTechTooltipData(t,e,n))})),a&&(this._ctx.font=Jt(L,M.text.weight,M.text.family),R.forEach((function(t){t.values.forEach((function(t){var e=t.title,i=t.value;if(C(e)){var r="".concat(e).concat(i),n=Zt(o._ctx,r)+T+I;A=Math.max(A,n),P+=O+D+L}}))}))),0!==(E+=A)&&0!==P){var B;E+=2*_+m+g;var F=y.offsetTop,z=y.borderRadius;qe(this._ctx,y.backgroundColor,B=this._width/2>t.realX?this._width-w-E:k,F,E,P+=2*_+x+S,z),$e(this._ctx,y.borderColor,_,B,F,E,P,z);var V=B+_+m+l,N=F+_+x;if(r&&(this._ctx.font=Jt(v,s.text.weight,s.text.family),c.forEach((function(t,e){N+=f,o._ctx.textAlign="left",Ue(o._ctx,p,V,N,t);var i,r,n=h[e];b(n)?(r=n.color||p,i=n.value||s.defaultValue):(r=p,i=n||s.defaultValue),o._ctx.textAlign="right",Ue(o._ctx,r,B+E-_-u-g,N,i),N+=v+d}))),a){var j=B+_+m+T;this._ctx.font=Jt(L,M.text.weight,M.text.family),R.forEach((function(t){t.values.forEach((function(t){N+=O,o._ctx.textAlign="left",o._ctx.fillStyle=t.color||M.text.color,o._ctx.fillText(t.title,j,N),o._ctx.textAlign="right",o._ctx.fillText(t.value,B+E-_-I-g,N),N+=L+D}))}))}this._ctx.restore()}}}},{key:"_getCandleTooltipData",value:function(t,e){var i=this,r=e.tooltip.values,n=[];if(r)k(r)?n=r(t,e)||[]:S(r)&&(n=r);else{var a=this._chartStore.pricePrecision(),o=this._chartStore.volumePrecision();(n=[it(t,"timestamp"),it(t,"open"),it(t,"close"),it(t,"high"),it(t,"low"),it(t,"volume")]).forEach((function(t,e){switch(e){case 0:n[e]=rt(i._chartStore.timeScaleStore().dateTimeFormat(),t,"YYYY-MM-DD hh:mm");break;case n.length-1:n[e]=at(nt(t,o));break;default:n[e]=nt(t,a)}}))}return n}}]),i}(Ge);function _i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var mi=function(t){dt(i,t);var e=_i(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_createMainView",value:function(t,e){return new vi(t,e.chartStore,e.xAxis,e.yAxis,e.paneId)}},{key:"_createOverlayView",value:function(t,e){return new yi(t,e.chartStore,e.xAxis,e.yAxis,e.paneId)}}]),i}(Ze);function gi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var xi=function(t){dt(i,t);var e=gi(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_createYAxis",value:function(t){return new li(t.chartStore,!0,t.id)}},{key:"_createMainWidget",value:function(t,e){return new mi({container:t,chartStore:e.chartStore,xAxis:e.xAxis,yAxis:this._yAxis,paneId:e.id})}}]),i}(fi);function Si(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var ki=function(t){dt(i,t);var e=Si(i);function i(t,r,n){var a;return p(this,i),(a=e.call(this,t,r))._xAxis=n,a}return _(i,[{key:"_draw",value:function(){var t=this._chartStore.styleOptions().xAxis;t.show&&(this._drawAxisLine(t),this._drawTickLines(t),this._drawTickLabels(t))}},{key:"_drawAxisLine",value:function(t){var e=t.axisLine;e.show&&(this._ctx.strokeStyle=e.color,this._ctx.lineWidth=e.size,Ut(this._ctx,0,0,this._width))}},{key:"_drawTickLines",value:function(t){var e=this,i=t.tickLine;if(i.show){this._ctx.lineWidth=i.size,this._ctx.strokeStyle=i.color;var r=t.axisLine.show?t.axisLine.size:0,n=r+i.length;this._xAxis.ticks().forEach((function(t){Xt(e._ctx,t.x,r,n)}))}}},{key:"_drawTickLabels",value:function(t){var e=t.tickText;if(e.show){var i=t.tickLine;this._ctx.textBaseline="top",this._ctx.font=Jt(e.size,e.weight,e.family),this._ctx.textAlign="center",this._ctx.fillStyle=e.color;var r=e.paddingTop;t.axisLine.show&&(r+=t.axisLine.size),i.show&&(r+=i.length);for(var n=this._xAxis.ticks(),a=n.length,o=0;a>o;o++)this._ctx.fillText(n[o].v,n[o].x,r)}}}]),i}(He);function bi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var wi=function(t){dt(i,t);var e=bi(i);function i(t,r,n){var a;return p(this,i),(a=e.call(this,t,r))._xAxis=n,a}return _(i,[{key:"_draw",value:function(){this._drawCrosshairLabel()}},{key:"_drawCrosshairLabel",value:function(){var t=this._chartStore.crosshairStore().get();if(t.paneId){var e=this._chartStore.styleOptions().crosshair,i=e.vertical,r=i.text;if(e.show&&i.show&&r.show&&t.dataIndex===t.realDataIndex){var n=t.kLineData.timestamp,a=rt(this._chartStore.timeScaleStore().dateTimeFormat(),n,"YYYY-MM-DD hh:mm"),o=r.paddingLeft,s=r.paddingRight,c=r.paddingTop,h=r.borderSize,l=$t(this._ctx,a,r),u=qt(r),f=l-2*h-o-s,d=t.realX-f/2;o+h>d?d=o+h:d>this._width-f-h-s&&(d=this._width-f-h-s),Je(this._ctx,r.backgroundColor,r.borderColor,h,d-h-o,0,l,u,r.borderRadius),this._ctx.textBaseline="top",Ue(this._ctx,r.color,d,h+c,a)}}}}]),i}(He);function Ci(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var Ai=function(t){dt(i,t);var e=Ci(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_createMainView",value:function(t,e){return new ki(t,e.chartStore,e.xAxis)}},{key:"_createOverlayView",value:function(t,e){return new wi(t,e.chartStore,e.xAxis)}}]),i}(Ne);function Ei(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var Pi=function(t){dt(i,t);var e=Ei(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_computeMinMax",value:function(){return{min:this._chartStore.timeScaleStore().from(),max:this._chartStore.timeScaleStore().to()-1}}},{key:"_optimalMinMax",value:function(t){var e=t.min,i=t.max;return{min:e,max:i,range:i-e+1}}},{key:"_optimalTicks",value:function(t){var e=[],i=t.length,r=this._chartStore.dataList();if(i>0){var n=this._chartStore.timeScaleStore().dateTimeFormat(),a=this._chartStore.styleOptions().xAxis.tickText;this._measureCtx.font=Jt(a.size,a.weight,a.family);var o=Zt(this._measureCtx,"00-00 00:00"),s=this.convertToPixel(parseInt(t[0].v,10)),c=1;if(i>1){var h=this.convertToPixel(parseInt(t[1].v,10)),l=Math.abs(h-s);o>l&&(c=Math.ceil(o/l))}for(var u=0;i>u;u+=c){var f=parseInt(t[u].v,10),d=r[f].timestamp,v=rt(n,d,"hh:mm");0!==u&&(v=this._optimalTickLabel(n,d,r[parseInt(t[u-c].v,10)].timestamp)||v);var p=this.convertToPixel(f);e.push({v:v,x:p,oV:d})}if(1===e.length)e[0].v=rt(n,e[0].oV,"YYYY-MM-DD hh:mm");else{var y=e[0].oV,_=e[1].oV;if(e[2]){var m=e[2].v;/^[0-9]{2}-[0-9]{2}$/.test(m)?e[0].v=rt(n,y,"MM-DD"):/^[0-9]{4}-[0-9]{2}$/.test(m)?e[0].v=rt(n,y,"YYYY-MM"):/^[0-9]{4}$/.test(m)&&(e[0].v=rt(n,y,"YYYY"))}else e[0].v=this._optimalTickLabel(n,y,_)||e[0].v}}return e}},{key:"_optimalTickLabel",value:function(t,e,i){var r=rt(t,e,"YYYY"),n=rt(t,e,"YYYY-MM"),a=rt(t,e,"MM-DD");return r!==rt(t,i,"YYYY")?r:n!==rt(t,i,"YYYY-MM")?n:a!==rt(t,i,"MM-DD")?a:null}},{key:"getSelfHeight",value:function(){var t=this._chartStore.styleOptions(),e=t.xAxis,i=e.height;if(w(i))return i;var r=t.crosshair,n=0;e.show&&(e.axisLine.show&&(n+=e.axisLine.size),e.tickLine.show&&(n+=e.tickLine.length),e.tickText.show&&(n+=e.tickText.paddingTop+e.tickText.paddingBottom+e.tickText.size));var a=0;return r.show&&r.vertical.show&&r.vertical.text.show&&(a+=r.vertical.text.paddingTop+r.vertical.text.paddingBottom+2*r.vertical.text.borderSize+r.vertical.text.size),Math.max(n,a)}},{key:"convertFromPixel",value:function(t){return this._chartStore.timeScaleStore().coordinateToDataIndex(t)}},{key:"convertToPixel",value:function(t){return this._chartStore.timeScaleStore().dataIndexToCoordinate(t)}}]),i}(ci);function Mi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var Ti=function(t){dt(i,t);var e=Mi(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"_initBefore",value:function(){this._xAxis=new Pi(this._chartStore)}},{key:"_createMainWidget",value:function(t,e){return new Ai({container:t,chartStore:e.chartStore,xAxis:this._xAxis})}},{key:"xAxis",value:function(){return this._xAxis}},{key:"setWidth",value:function(t,e){Be(pt(i.prototype),"setWidth",this).call(this,t,e),this._xAxis.setWidth(t)}},{key:"setHeight",value:function(t){Be(pt(i.prototype),"setHeight",this).call(this,t),this._xAxis.setHeight(t)}}]),i}(ze),Ii="mouse",Oi="touch";function Di(t){return t.type===Oi}function Li(t){return t.type===Ii}function Ri(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function Bi(t){for(var e=1;arguments.length>e;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ri(Object(i),!0).forEach((function(e){Mt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ri(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Fi=0,zi=2;function Vi(t){return t.getBoundingClientRect()||{left:0,top:0}}function Ni(t){return!!t.touches}function ji(t){t.cancelable&&t.preventDefault()}function Hi(t,e){var i=t.clientX-e.clientX,r=t.clientY-e.clientY;return Math.sqrt(i*i+r*r)}var Yi=function(){function t(e,i,r){p(this,t),this._target=e,this._handler=i,this._options=r,this._clickCount=0,this._clickTimeoutId=null,this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._moveExceededManhattanDistance=!1,this._cancelClick=!1,this._unsubscribeOutsideEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRoot=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventDragProcess=!1,this._mousePressed=!1,this._init()}return _(t,[{key:"setOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._options=Bi(Bi({},this.options),t)}},{key:"destroy",value:function(){null!==this._unsubscribeOutsideEvents&&(this._unsubscribeOutsideEvents(),this._unsubscribeOutsideEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),this._clearLongTapTimeout(),this._resetClickTimeout()}},{key:"_mouseEnterHandler",value:function(t){var e=this;this._unsubscribeMousemove&&this._unsubscribeMousemove();var i=this._mouseMoveHandler.bind(this),r=this._mouseWheelHandler.bind(this);this._unsubscribeMousemove=function(){e._target.removeEventListener("mousemove",i),e._target.removeEventListener("wheel",r)},this._target.addEventListener("mousemove",i),this._target.addEventListener("wheel",r,{passive:!1}),Ni(t)&&this._mouseMoveHandler(t);var n=this._makeCompatEvent(t);this._processEvent(n,this._handler.mouseEnterEvent)}},{key:"_resetClickTimeout",value:function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null}},{key:"_mouseMoveHandler",value:function(t){if(!this._mousePressed||Ni(t)){var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.mouseMoveEvent)}}},{key:"_mouseWheelHandler",value:function(t){var e=this._makeCompatEvent(t);t.localX=e.localX,t.localY=e.localY,this._processEvent(t,this._handler.mouseWheelEvent)}},{key:"_mouseMoveWithDownHandler",value:function(t){if((!("button"in t)||t.button===Fi)&&null===this._startPinchMiddleCoordinate){var e=Ni(t);if(!this._preventDragProcess||!e){this._pinchPrevented=!0;var i=this._makeCompatEvent(t),r=this._mouseMoveStartPosition,n=Math.abs(r.x-i.pageX),a=Math.abs(r.y-i.pageY),o=n+a>5;if(o||!e){if(o&&!this._moveExceededManhattanDistance&&e){var s=.5*n;a>=s&&!this._options.treatVertTouchDragAsPageScroll||s>a&&!this._options.treatHorzTouchDragAsPageScroll||(this._preventDragProcess=!0)}o&&(this._moveExceededManhattanDistance=!0,this._cancelClick=!0,e&&this._clearLongTapTimeout()),this._preventDragProcess||(this._processEvent(i,this._handler.pressedMouseMoveEvent),e&&ji(t))}}}}},{key:"_mouseUpHandler",value:function(t){if(!("button"in t)||t.button===Fi){var e=this._makeCompatEvent(t);this._clearLongTapTimeout(),this._mouseMoveStartPosition=null,this._mousePressed=!1,this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),Ni(t)&&this._mouseLeaveHandler(t),this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1?(this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent),Ni(t)&&(ji(t),this._mouseLeaveHandler(t),0===t.touches.length&&(this._longTapActive=!1))}}},{key:"_clearLongTapTimeout",value:function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}},{key:"_mouseDownHandler",value:function(t){if(!("button"in t)||t.button===Fi||t.button===zi){var e=this._makeCompatEvent(t);if("button"in t&&t.button===zi)this._processEvent(e,this._handler.mouseRightDownEvent);else{this._cancelClick=!1,this._moveExceededManhattanDistance=!1,this._preventDragProcess=!1,Ni(t)&&this._mouseEnterHandler(t),this._mouseMoveStartPosition={x:e.pageX,y:e.pageY},this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null);var i=this._mouseMoveWithDownHandler.bind(this),r=this._mouseUpHandler.bind(this),n=this._target.ownerDocument.documentElement;this._unsubscribeRoot=function(){n.removeEventListener("touchmove",i),n.removeEventListener("touchend",r),n.removeEventListener("mousemove",i),n.removeEventListener("mouseup",r)},n.addEventListener("touchmove",i,{passive:!1}),n.addEventListener("touchend",r,{passive:!1}),this._clearLongTapTimeout(),Ni(t)&&1===t.touches.length?this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),600):(n.addEventListener("mousemove",i),n.addEventListener("mouseup",r)),this._mousePressed=!0,this._processEvent(e,this._handler.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500))}}}},{key:"_init",value:function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e,i=this._target.ownerDocument,r=function(e){t._handler.mouseDownOutsideEvent&&(e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent())};this._unsubscribeOutsideEvents=function(){i.removeEventListener("mousedown",r),i.removeEventListener("touchstart",r)},i.addEventListener("mousedown",r),i.addEventListener("touchstart",r,{passive:!0}),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._mouseDownHandler.bind(this),{passive:!0}),e="ontouchstart"in window||!!(window.DocumentTouch&&document instanceof window.DocumentTouch),"onorientationchange"in window&&(navigator.maxTouchPoints||navigator.msMaxTouchPoints||e)||this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})}},{key:"_initPinch",value:function(){var t=this;void 0===this._handler.pinchStartEvent&&void 0===this._handler.pinchEvent&&void 0===this._handler.pinchEndEvent||(this._target.addEventListener("touchstart",(function(e){return t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddleCoordinate&&void 0!==t._handler.pinchEvent){var i=Hi(e.touches[0],e.touches[1]);t._handler.pinchEvent(t._startPinchMiddleCoordinate,i/t._startPinchDistance),ji(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))}},{key:"_checkPinchState",value:function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)}},{key:"_startPinch",value:function(t){var e=Vi(this._target);this._startPinchMiddleCoordinate={x:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,y:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this._startPinchDistance=Hi(t[0],t[1]),void 0!==this._handler.pinchStartEvent&&this._handler.pinchStartEvent(),this._clearLongTapTimeout()}},{key:"_stopPinch",value:function(){null!==this._startPinchMiddleCoordinate&&(this._startPinchMiddleCoordinate=null,void 0!==this._handler.pinchEndEvent&&this._handler.pinchEndEvent())}},{key:"_mouseLeaveHandler",value:function(t){this._unsubscribeMousemove&&this._unsubscribeMousemove();var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.mouseLeaveEvent)}},{key:"_longTapHandler",value:function(t){var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.longTapEvent),this._cancelClick=!0,this._longTapActive=!0}},{key:"_processEvent",value:function(t,e){e&&e.call(this._handler,t)}},{key:"_makeCompatEvent",value:function(t){var e;e="touches"in t&&t.touches.length?t.touches[0]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0]:t;var i=Vi(this._target);return{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY,localX:e.clientX-i.left,localY:e.clientY-i.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,type:t.type.startsWith("mouse")?Ii:Oi,target:e.target,view:t.view}}}]),t}(),Wi=function(){function t(e,i,r,n,a,o){p(this,t),this._chartStore=i,this._topPaneId=r,this._bottomPaneId=n,this._dragEnabled=a,this._width=0,this._offsetLeft=0,this._dragEventHandler=o,this._dragFlag=!1,this._initElement(e),this._initEvent(a)}return _(t,[{key:"_initElement",value:function(t){this._container=t,this._wrapper=Fe("div",{margin:"0",padding:"0",position:"relative",boxSizing:"border-box"}),this._element=Fe("div",{width:"100%",height:"7px",margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box"}),this._wrapper.appendChild(this._element);var e=t.lastChild;e?t.insertBefore(this._wrapper,e):t.appendChild(this._wrapper)}},{key:"_initEvent",value:function(t){t&&(this._element.style.cursor="ns-resize",this._dragEvent=new Yi(this._element,{mouseDownEvent:this._mouseDownEvent.bind(this),mouseUpEvent:this._mouseUpEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this),mouseEnterEvent:this._mouseEnterEvent.bind(this),mouseLeaveEvent:this._mouseLeaveEvent.bind(this)},{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0}))}},{key:"_mouseDownEvent",value:function(t){this._dragFlag=!0,this._startY=t.pageY,this._dragEventHandler.startDrag(this._topPaneId,this._bottomPaneId)}},{key:"_mouseUpEvent",value:function(){this._dragFlag=!1,this._chartStore.setDragPaneFlag(!1)}},{key:"_pressedMouseMoveEvent",value:function(t){this._dragEventHandler.drag(t.pageY-this._startY,this._topPaneId,this._bottomPaneId),this._chartStore.setDragPaneFlag(!0),this._chartStore.crosshairStore().set()}},{key:"_mouseEnterEvent",value:function(){var t=this._chartStore.styleOptions().separator;this._element.style.background=t.activeBackgroundColor,this._chartStore.crosshairStore().set()}},{key:"_mouseLeaveEvent",value:function(){this._dragFlag||(this._element.style.background=null,this._chartStore.setDragPaneFlag(!1))}},{key:"height",value:function(){return this._wrapper.offsetHeight}},{key:"setSize",value:function(t,e){this._offsetLeft=t,this._width=e,this.invalidate()}},{key:"setDragEnabled",value:function(t){t!==this._dragEnabled&&(this._dragEnabled=t,t?!this._dragEvent&&this._initEvent(t):(this._element.style.cursor="default",this._dragEvent&&this._dragEvent.destroy(),this._dragEvent=null))}},{key:"topPaneId",value:function(){return this._topPaneId}},{key:"bottomPaneId",value:function(){return this._bottomPaneId}},{key:"updatePaneId",value:function(t,e){C(t)&&(this._topPaneId=t),C(e)&&(this._bottomPaneId=e)}},{key:"invalidate",value:function(){var t=this._chartStore.styleOptions().separator;this._element.style.top="".concat(-Math.floor((7-t.size)/2),"px"),this._wrapper.style.backgroundColor=t.color,this._wrapper.style.height="".concat(t.size,"px"),this._wrapper.style.marginLeft="".concat(t.fill?0:this._offsetLeft,"px"),this._wrapper.style.width=t.fill?"100%":"".concat(this._width,"px")}},{key:"getImage",value:function(){var t=this._chartStore.styleOptions().separator,e=this._wrapper.offsetWidth,i=t.size,r=Fe("canvas",{width:"".concat(e,"px"),height:"".concat(i,"px"),boxSizing:"border-box"}),n=r.getContext("2d"),a=Kt(r);return r.width=e*a,r.height=i*a,n.scale(a,a),n.fillStyle=t.color,n.fillRect(this._offsetLeft,0,e,i),r}},{key:"destroy",value:function(){this._dragEvent&&this._dragEvent.destroy(),this._container.removeChild(this._wrapper)}}]),t}(),Ui=_((function t(e){p(this,t),this._chartStore=e}));function Xi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var Gi=function(t){dt(i,t);var e=Xi(i);function i(t){var r;return p(this,i),(r=e.call(this,t))._startScrollCoordinate=null,r._touchCoordinate=null,r._touchCancelCrosshair=!1,r._touchZoomed=!1,r._pinchScale=1,r}return _(i,[{key:"pinchStartEvent",value:function(){this._pinchScale=1,this._touchZoomed=!0}},{key:"pinchEvent",value:function(t,e){var i=5*(e-this._pinchScale);this._pinchScale=e,this._chartStore.timeScaleStore().zoom(i,t)}},{key:"mouseUpEvent",value:function(){this._startScrollCoordinate=null}},{key:"mouseLeaveEvent",value:function(t){this._startScrollCoordinate=null,Li(t)&&this._chartStore.crosshairStore().set()}},{key:"mouseMoveEvent",value:function(t){Li(t)&&this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId})}},{key:"mouseWheelEvent",value:function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(t.cancelable&&t.preventDefault(),0===Math.abs(t.deltaX))return;this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(-t.deltaX)}else{var e=-t.deltaY/100;if(0===e)return;switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._chartStore.timeScaleStore().zoom(i,{x:t.localX,y:t.localY})}}}},{key:"mouseClickEvent",value:function(t){Di(t)&&(this._touchCoordinate||this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:t.localX,y:t.localY},this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId})))}},{key:"mouseDownEvent",value:function(t){if(this._startScrollCoordinate={x:t.localX,y:t.localY},this._chartStore.timeScaleStore().startScroll(),Di(t))if(this._touchZoomed=!1,this._touchCoordinate){var e=t.localX-this._touchCoordinate.x,i=t.localY-this._touchCoordinate.y;10>Math.sqrt(e*e+i*i)?(this._touchCoordinate={x:t.localX,y:t.localY},this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId})):(this._touchCancelCrosshair=!0,this._touchCoordinate=null,this._chartStore.crosshairStore().set())}else this._touchCancelCrosshair=!1}},{key:"pressedMouseMoveEvent",value:function(t){var e={x:t.localX,y:t.paneY,paneId:t.paneId};if(Di(t)){if(this._touchCoordinate)return this._touchCoordinate={x:t.localX,y:t.localY},void this._chartStore.crosshairStore().set(e);e=null}if(this._startScrollCoordinate){var i=t.localX-this._startScrollCoordinate.x;this._chartStore.timeScaleStore().scroll(i,e)}}},{key:"longTapEvent",value:function(t){Di(t)&&(this._touchCoordinate={x:t.localX,y:t.localY},this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId}))}}]),i}(Ui);function Ki(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function Zi(t){for(var e=1;arguments.length>e;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ki(Object(i),!0).forEach((function(e){Mt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ki(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Ji(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return $i(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?$i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return t.length>r?{done:!1,value:t[r++]}:{done:!0}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function $i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);e>i;i++)r[i]=t[i];return r}function qi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var Qi=function(t){dt(i,t);var e=qi(i);function i(t,r){var n;return p(this,i),(n=e.call(this,t))._yAxis=r,n}return _(i,[{key:"_performOverlayMouseHover",value:function(t,e,i,r){var n;if(t){var a,o=Ji(t);try{for(o.s();!(a=o.n()).done;)if(n=a.value.checkEventCoordinateOn(i))break}catch(t){o.e(t)}finally{o.f()}n&&e.id===n.id||(e.id&&e.instance&&Li(r)&&e.instance.onMouseLeave({id:e.id,points:e.instance.points(),event:r}),n&&n.id!==e.id&&n.instance&&Li(r)&&n.instance.onMouseEnter({id:n.id,points:n.instance.points(),event:r}))}return n}},{key:"mouseUpEvent",value:function(){this._chartStore.shapeStore().updatePressedInstance()}},{key:"mouseMoveEvent",value:function(t){if(this._waitingForMouseMove)return!1;this._waitingForMouseMove=!0;var e,i,r,n={x:t.localX,y:t.paneY},a=this._chartStore.shapeStore().progressInstance(),o=a.paneId,s=a.instance;if(s&&s.isDrawing())t.paneId&&(s.isStart()&&this._chartStore.shapeStore().updateProgressInstance(this._yAxis(t.paneId),t.paneId),o===t.paneId&&s.mouseMoveForDrawing(n,t),e=s.checkEventCoordinateOn(n)),i={id:"",element:ne,elementIndex:-1};else{var c=this._chartStore.annotationStore().get(t.paneId),h=this._chartStore.shapeStore().instances(t.paneId),l=this._chartStore.shapeStore().mouseOperate().hover,u=this._chartStore.annotationStore().mouseOperate();e=this._performOverlayMouseHover(h,l,n,t),r=this._performOverlayMouseHover(c,u,n,t)}this._chartStore.shapeStore().setMouseOperate({hover:e||{id:"",element:ne,elementIndex:-1},click:i}),this._chartStore.annotationStore().setMouseOperate(r||{id:""}),this._waitingForMouseMove=!1}},{key:"mouseDownEvent",value:function(t){var e,i={x:t.localX,y:t.paneY},r=this._chartStore.shapeStore().progressInstance(),n=r.instance,a=r.paneId,o={id:"",element:ne,elementIndex:-1};if(n&&n.isDrawing()&&a===t.paneId)n.mouseLeftButtonDownForDrawing(),e=n.checkEventCoordinateOn(i);else{var s,c=Ji(this._chartStore.shapeStore().instances(t.paneId));try{for(c.s();!(s=c.n()).done;){var h=s.value;if(e=h.checkEventCoordinateOn(i)){this._chartStore.shapeStore().updatePressedInstance(h,t.paneId,e.element),e.element===re?o=Zi({},e):h.startPressedOtherMove(i),h.onClick({id:e.id,points:h.points(),event:t});break}}}catch(t){c.e(t)}finally{c.f()}var l=this._chartStore.annotationStore().get(t.paneId);if(l){var u,f=Ji(l);try{for(f.s();!(u=f.n()).done;){var d=u.value,v=d.checkEventCoordinateOn(i);if(v){d.onClick({id:v.id,points:d.points(),event:t});break}}}catch(t){f.e(t)}finally{f.f()}}}this._chartStore.shapeStore().setMouseOperate({hover:o,click:e||{id:"",element:ne,elementIndex:-1}})&&this._chartStore.invalidate(pe)}},{key:"mouseRightDownEvent",value:function(t){var e,i=this._chartStore.shapeStore().progressInstance().instance;e=i||this._chartStore.shapeStore().instances(t.paneId).find((function(e){return e.checkEventCoordinateOn({x:t.localX,y:t.paneY})})),e&&!e.onRightClick({id:e.id(),points:e.points(),event:t})&&this._chartStore.shapeStore().removeInstance(e.id());var r=this._chartStore.annotationStore().get(t.paneId);if(r){var n=r.find((function(e){return e.checkEventCoordinateOn({x:t.localX,y:t.paneY})}));n&&n.onRightClick({id:n.id(),points:n.points(),event:t})}}},{key:"pressedMouseMoveEvent",value:function(t){var e=this._chartStore.shapeStore().pressedInstance(),i=e.instance;if(i&&e.paneId===t.paneId){var r={x:t.localX,y:t.paneY};e.element===re?i.mousePressedPointMove(r,t):i.mousePressedOtherMove(r,t),this._chartStore.crosshairStore().set({x:t.localX,y:t.paneY,paneId:t.paneId})}}}]),i}(Ui);function tr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var er="Equal",ir="Minus",rr="ArrowLeft",nr="ArrowRight",ar=function(t){dt(i,t);var e=tr(i);function i(){return p(this,i),e.apply(this,arguments)}return _(i,[{key:"keyBoardDownEvent",value:function(t){if(t.shiftKey)switch(t.code){case er:this._chartStore.timeScaleStore().zoom(.5);break;case ir:this._chartStore.timeScaleStore().zoom(-.5);break;case rr:this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(-3*this._chartStore.timeScaleStore().dataSpace());break;case nr:this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(3*this._chartStore.timeScaleStore().dataSpace())}}}]),i}(Ui),or=function(){function t(e,i,r){p(this,t),this._target=e,this._chartStore=i,this._chartContentLeftRight={},this._chartContentTopBottom={},this._paneContentSize={},this._event=new Yi(this._target,{pinchStartEvent:this._pinchStartEvent.bind(this),pinchEvent:this._pinchEvent.bind(this),mouseUpEvent:this._mouseUpEvent.bind(this),mouseClickEvent:this._mouseClickEvent.bind(this),mouseDownEvent:this._mouseDownEvent.bind(this),mouseRightDownEvent:this._mouseRightDownEvent.bind(this),mouseLeaveEvent:this._mouseLeaveEvent.bind(this),mouseMoveEvent:this._mouseMoveEvent.bind(this),mouseWheelEvent:this._mouseWheelEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this),longTapEvent:this._longTapEvent.bind(this)},{treatVertTouchDragAsPageScroll:!0,treatHorzTouchDragAsPageScroll:!1}),this._boundKeyBoardDownEvent=this._keyBoardDownEvent.bind(this),this._target.addEventListener("keydown",this._boundKeyBoardDownEvent),this._boundContextMenuEvent=function(t){t.preventDefault()},this._target.addEventListener("contextmenu",this._boundContextMenuEvent,!1),this._zoomScrollEventHandler=new Gi(i),this._overlayEventHandler=new Qi(i,r),this._keyBoardEventHandler=new ar(i)}return _(t,[{key:"_keyBoardDownEvent",value:function(t){this._keyBoardEventHandler.keyBoardDownEvent(t)}},{key:"_pinchStartEvent",value:function(){this._zoomScrollEventHandler.pinchStartEvent()}},{key:"_pinchEvent",value:function(t,e){this._zoomScrollEventHandler.pinchEvent(t,e)}},{key:"_mouseUpEvent",value:function(t){this._checkEventInChartContent(t)&&(this._target.style.cursor="crosshair"),this._zoomScrollEventHandler.mouseUpEvent(t),this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseUpEvent(t)}},{key:"_mouseLeaveEvent",value:function(t){this._zoomScrollEventHandler.mouseLeaveEvent(t)}},{key:"_mouseMoveEvent",value:function(t){if(t.target instanceof HTMLCanvasElement)if(this._checkEventInChartContent(t)){this._target.style.cursor="crosshair";var e=this._compatChartEvent(t,!0);this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseMoveEvent(e),this._chartStore.dragPaneFlag()||this._zoomScrollEventHandler.mouseMoveEvent(e)}else this._target.style.cursor="default",this._zoomScrollEventHandler.mouseLeaveEvent(t);else this._target.style.cursor="default",this._chartStore.crosshairStore().set()}},{key:"_mouseWheelEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&this._zoomScrollEventHandler.mouseWheelEvent(this._compatChartEvent(t))}},{key:"_mouseClickEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&(this._zoomScrollEventHandler.mouseClickEvent(this._compatChartEvent(t,!0)),this._modifyEventOptions(t))}},{key:"_mouseDownEvent",value:function(t){if(this._checkEventInChartContent(t)){this._target.style.cursor="pointer";var e=this._compatChartEvent(t,!0);this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseDownEvent(e),this._checkZoomScroll()&&(this._zoomScrollEventHandler.mouseDownEvent(e),this._modifyEventOptions(t))}}},{key:"_mouseRightDownEvent",value:function(t){this._shouldPerformOverlayEvent()&&this._checkEventInChartContent(t)&&this._overlayEventHandler.mouseRightDownEvent(this._compatChartEvent(t,!0))}},{key:"_pressedMouseMoveEvent",value:function(t){if(this._checkEventInChartContent(t)){var e=this._compatChartEvent(t,!0);this._checkZoomScroll()?(this._zoomScrollEventHandler.pressedMouseMoveEvent(e),this._modifyEventOptions(t)):this._overlayEventHandler.pressedMouseMoveEvent(e)}}},{key:"_longTapEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&(this._zoomScrollEventHandler.longTapEvent(this._compatChartEvent(t,!0)),this._modifyEventOptions(t))}},{key:"_checkZoomScroll",value:function(){return!this._chartStore.dragPaneFlag()&&!this._chartStore.shapeStore().isPressed()&&!this._chartStore.shapeStore().isDrawing()}},{key:"_shouldPerformOverlayEvent",value:function(){return!this._chartStore.shapeStore().isEmpty()||!this._chartStore.annotationStore().isEmpty()}},{key:"_modifyEventOptions",value:function(t){Di(t)&&this._chartStore.crosshairStore().get().paneId?this._event.setOptions({treatVertTouchDragAsPageScroll:!1}):this._event.setOptions({treatVertTouchDragAsPageScroll:!0})}},{key:"_compatChartEvent",value:function(t,e){if(e)for(var i in this._paneContentSize)if(Object.prototype.hasOwnProperty.call(this._paneContentSize,i)){var r=this._paneContentSize[i];if(t.localY>r.contentTop&&r.contentBottom>t.localY){t.paneY=t.localY-r.contentTop,t.paneId=i;break}}return t.localX-=this._chartContentLeftRight.contentLeft,t}},{key:"_checkEventInChartContent",value:function(t){return t.localX>this._chartContentLeftRight.contentLeft&&this._chartContentLeftRight.contentRight>t.localX&&t.localY>this._chartContentTopBottom.contentTop&&this._chartContentTopBottom.contentBottom>t.localY}},{key:"setChartContentLeftRight",value:function(t){this._chartContentLeftRight=t}},{key:"setChartContentTopBottom",value:function(t){this._chartContentTopBottom=t}},{key:"setPaneContentSize",value:function(t){this._paneContentSize=t}},{key:"destroy",value:function(){this._event.destroy(),this._target.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._target.removeEventListener("contextmenu",this._boundContextMenuEvent)}}]),t}();function sr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=0;return function(){var r=Date.now(),n=this,a=arguments;r-i>e&&(t.apply(n,a),i=r)}}function cr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var hr=function(t){dt(i,t);var e=cr(i);function i(t){var r,n=t.id,a=t.point,o=t.chartStore,s=t.xAxis,c=t.yAxis,h=t.styles;return p(this,i),(r=e.call(this,{id:n,chartStore:o,xAxis:s,yAxis:c}))._point=a,r._symbolCoordinate={},r.setStyles(h,o.styleOptions().annotation),r}return _(i,[{key:"_drawSymbol",value:function(t,e,i){var r=this._chartStore.timeScaleStore().barSpace(),n=i.symbol,a=n.size,o=n.activeSize,s=e?w(o)?o:r:w(a)?a:r,c=e?n.activeColor:n.color;switch(n.type){case G:Ot(t,c,this._symbolCoordinate,s/2);break;case K:!function(t,e,i,r,n,a){t.fillStyle=e,t.fillRect(i,r,n,a)}(t,c,this._symbolCoordinate.x-s/2,this._symbolCoordinate.y-s/2,s,s);break;case J:!function(t,e,i,r,n){t.fillStyle=e,t.beginPath(),t.moveTo(i.x-r/2,i.y),t.lineTo(i.x,i.y-n/2),t.lineTo(i.x+r/2,i.y),t.lineTo(i.x,i.y+n/2),t.closePath(),t.fill()}(t,c,this._symbolCoordinate,s,s);break;case Z:!function(t,e,i,r,n){t.fillStyle=e,t.beginPath(),t.moveTo(i.x-r/2,i.y+n/2),t.lineTo(i.x,i.y-n/2),t.lineTo(i.x+r/2,i.y+n/2),t.closePath(),t.fill()}(t,c,this._symbolCoordinate,s,s);break;case $:t.save(),this.drawCustomSymbol({ctx:t,point:this._point,coordinate:this._symbolCoordinate,viewport:{width:this._xAxis.width(),height:this._yAxis.height(),barSpace:r},styles:n,isActive:e}),t.restore()}}},{key:"draw",value:function(t){var e=this._styles||this._chartStore.styleOptions().annotation,i=e.offset||[0,0],r=0;switch(e.position){case q:r=this._yAxis.convertToPixel(this._point.value);break;case Q:r=0;break;case tt:r=this._yAxis.height()}this._symbolCoordinate.y=r+i[0];var n=this._id===this._chartStore.annotationStore().mouseOperate().id;this._drawSymbol(t,n,e),this.drawExtend&&(t.save(),this.drawExtend({ctx:t,point:this._point,coordinate:this._symbolCoordinate,viewport:{width:this._xAxis.width(),height:this._yAxis.height()},styles:e,isActive:n}),t.restore())}},{key:"checkEventCoordinateOn",value:function(t){var e,i,r,n,a,o=this._chartStore.timeScaleStore().barSpace(),s=(this._styles||this._chartStore.styleOptions().annotation).symbol,c=w(s.size)?s.size:o;switch(s.type){case G:e=Nt(this._symbolCoordinate,c/2,t);break;case K:e=function(t,e,i){return!(t.x>i.x||i.x>e.x||t.y>i.y||i.y>e.y)}({x:this._symbolCoordinate.x-c/2,y:this._symbolCoordinate.y-c/2},{x:this._symbolCoordinate.x+c/2,y:this._symbolCoordinate.y+c/2},t);break;case J:e=(r=c)*(n=c)/2+2>Math.abs((i=this._symbolCoordinate).x-(a=t).x)*n+Math.abs(i.y-a.y)*r;break;case Z:e=function(t,e){var i=Dt(t[0],t[1],t[2]),r=Dt(t[0],t[1],e)+Dt(t[0],t[2],e)+Dt(t[1],t[2],e);return 2>Math.abs(i-r)}([{x:this._symbolCoordinate.x-c/2,y:this._symbolCoordinate.y+c/2},{x:this._symbolCoordinate.x,y:this._symbolCoordinate.y-c/2},{x:this._symbolCoordinate.x+c/2,y:this._symbolCoordinate.y+c/2}],t);break;case $:e=this.checkEventCoordinateOnCustomSymbol({eventCoordinate:t,coordinate:this._symbolCoordinate,size:c})}if(e)return{id:this._id,instance:this}}},{key:"createSymbolCoordinate",value:function(t){var e=this._styles||this._chartStore.styleOptions().annotation;this._symbolCoordinate={x:t+(e.offset||[0,0])[1]}}},{key:"points",value:function(){return this._point}},{key:"checkEventCoordinateOnCustomSymbol",value:function(t){}},{key:"drawCustomSymbol",value:function(t){}}]),i}(It);function lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=pt(t);if(e){var n=pt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return vt(this,i)}}var ur=function(t){dt(i,t);var e=lr(i);function i(t){var r,n=t.id,a=t.point,o=t.text,s=t.mark,c=t.chartStore,h=t.xAxis,l=t.yAxis,u=t.styles;return p(this,i),(r=e.call(this,{id:n,chartStore:c,xAxis:h,yAxis:l}))._point=a||{},r._text=o,r._mark=s,r.setStyles(u,c.styleOptions().tag),r}return _(i,[{key:"update",value:function(t){var e=t.point,i=t.text,r=t.mark,n=t.styles,a=!1;return b(e)&&(this._point=e,a=!0),C(i)&&(this._text=i,a=!0),C(r)&&(this._mark=r,a=!0),this.setStyles(n,this._chartStore.styleOptions().tag)&&(a=!0),a}},{key:"drawMarkLine",value:function(t){var e=this._chartStore.styleOptions(),i=e.yAxis,r=this._styles||e.tag,n=this._getY(r);t.save(),this._drawLine(t,n,r,i),this._drawMark(t,n,r,i),t.restore()}},{key:"drawText",value:function(t){if(C(this._text)){var e=this._chartStore.styleOptions(),i=this._styles||e.tag,r=i.text;t.save();var n,a=$t(t,this._text,r),o=qt(r);n=this._yAxis.isFromYAxisZero()?0:this._yAxis.width()-a;var s=this._getY(i);Je(t,r.backgroundColor,r.borderColor,r.borderSize,n,s-o/2,a,o,r.borderRadius),Ue(t,r.color,n+r.paddingLeft,s,this._text),t.restore()}}},{key:"_drawLine",value:function(t,e,i,r){var n=i.line;if(n.show){t.save();var a=$t(t,this._text,i.text),o=$t(t,this._mark,i.mark);t.strokeStyle=n.color,t.lineWidth=n.size,n.style===T&&t.setLineDash(n.dashValue);var s=i.mark.offset,c=[],h=C(this._text),l=C(this._mark);r.inside?r.position===O?h&&l?s>0?(c.push([a,a+s]),c.push([a+s+o,this._xAxis.width()])):c.push(Math.min(a,o)>Math.abs(s)?[a+s+o,this._xAxis.width()]:[Math.max(a,o),this._xAxis.width()]):h?c.push([a,this._xAxis.width()]):l?s>0?(c.push([0,s]),c.push([s+o,this._xAxis.width()])):c.push(o>Math.abs(s)?[s+o,this._xAxis.width()]:[0,this._xAxis.width()]):c.push([0,this._xAxis.width()]):h&&l?0>s?(c.push([0,this._xAxis.width()-a+s-o]),c.push([this._xAxis.width()-a+s,this._xAxis.width()-a])):c.push(Math.min(a,o)>s?[0,this._xAxis.width()-a-o+s]:[0,this._xAxis.width()-Math.max(a,o)]):h?c.push([0,this._xAxis.width()-a]):l?0>s?(c.push([0,this._xAxis.width()+s-o]),c.push([this._xAxis.width()+s,this._xAxis.width()])):c.push(o>s?[0,this._xAxis.width()-o+s]:[0,this._xAxis.width()]):c.push([0,this._xAxis.width()]):r.position===O?l?s>0?(c.push([0,s]),c.push([s+o,this._xAxis.width()])):c.push(o>Math.abs(s)?[o+s,this._xAxis.width()]:[0,this._xAxis.width()]):c.push([0,this._xAxis.width()]):l?0>s?(c.push([0,this._xAxis.width()-o+s]),c.push([this._xAxis.width()+s,this._xAxis.width()])):c.push(o>s?[0,this._xAxis.width()-o+s]:[0,this._xAxis.width()]):c.push([0,this._xAxis.width()]),c.forEach((function(i){Ut(t,e,i[0],i[1])})),t.restore()}}},{key:"_drawMark",value:function(t,e,i,r){if(C(this._mark)){var n,a=i.mark,o=$t(t,this._mark,a),s=qt(a);if(r.inside){var c=0;C(this._text)&&(c=$t(t,this._text,i.text)),n=r.position===O?c:this._xAxis.width()-c-o}else n=r.position===O?0:this._xAxis.width()-o;Je(t,a.backgroundColor,a.borderColor,a.borderSize,n+=a.offset,e-s/2,o,s,a.borderRadius),t.textBaseline="middle",t.font=Jt(a.size,a.weight,a.family),Ue(t,a.color,n+a.paddingLeft,e,this._mark)}}},{key:"_getY",value:function(t){var e=t.offset;switch(t.position){case Q:return e;case tt:return this._yAxis.height()+e;default:return this._yAxis.convertToNicePixel(this._point.value)+e}}}]),i}(It);function fr(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return dr(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?dr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return t.length>r?{done:!1,value:t[r++]}:{done:!0}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function dr(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);e>i;i++)r[i]=t[i];return r}var vr="technical_indicator_pane_",pr="candle_pane",yr=function(){function t(e,i){var r=this;p(this,t),this._initChartContainer(e),this._shapeBaseId=0,this._paneBaseId=0,this._separatorDragStartTopPaneHeight=0,this._separatorDragStartBottomPaneHeight=0,this._chartStore=new Le(i,{invalidate:this._invalidatePane.bind(this),crosshair:this._crosshairObserver.bind(this)}),this._xAxisPane=new Ti({id:"x_axis_pane",container:this._chartContainer,chartStore:this._chartStore}),this._panes=new Map([[pr,new xi({container:this._chartContainer,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),id:pr})]]),this._separators=new Map,this._chartWidth={},this._chartHeight={},this._chartEvent=new or(this._chartContainer,this._chartStore,(function(t){return r._panes.get(t).yAxis()})),this.adjustPaneViewport(!0,!0,!0)}return _(t,[{key:"_initChartContainer",value:function(t){this._container=t,this._chartContainer=Fe("div",{userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent",position:"relative",outline:"none",borderStyle:"none",width:"100%",cursor:"crosshair",boxSizing:"border-box"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)}},{key:"_crosshairObserver",value:function(t){var e=this,i=t.paneId,r=t.dataIndex,n=t.kLineData,a=t.x,o=t.y;if(this._chartStore.actionStore().has(ht.CROSSHAIR)||this._chartStore.actionStore().has(ht.TOOLTIP)){var s={};this._panes.forEach((function(t,i){var a={},o=[];e.chartStore().technicalIndicatorStore().instances(i).forEach((function(t){var e=t.result[r];a[t.name]=e,o.push({name:t.name,data:e})})),s[i]=a,e._chartStore.actionStore().execute(ht.TOOLTIP,{paneId:i,dataIndex:r,kLineData:n,technicalIndicatorData:o})})),i&&this._chartStore.actionStore().execute(ht.CROSSHAIR,{paneId:i,coordinate:{x:a,y:o},dataIndex:r,kLineData:n,technicalIndicatorData:s})}}},{key:"_separatorStartDrag",value:function(t,e){this._separatorDragStartTopPaneHeight=this._panes.get(t).height(),this._separatorDragStartBottomPaneHeight=this._panes.get(e).height()}},{key:"_separatorDrag",value:function(t,e,i){var r=this._separatorDragStartTopPaneHeight+t,n=this._separatorDragStartBottomPaneHeight-t;r>this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight&&(r=this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight,n=0),0>r&&(r=0,n=this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight),this._panes.get(e).setHeight(r),this._panes.get(i).setHeight(n),this._chartStore.actionStore().execute(ht.PANE_DRAG,{topPaneId:e,bottomPaneId:i,topPaneHeight:r,bottomPaneHeight:n}),this.adjustPaneViewport(!0,!0,!0,!0,!0)}},{key:"_invalidatePane",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e;if(t===pe)this._xAxisPane.invalidate(t),this._panes.forEach((function(e){e.invalidate(t)}));else{var e=!1;this._panes.forEach((function(t){var i=t.yAxis().computeAxis();i&&(e=i)})),this.adjustPaneViewport(!1,e,!0)}}},{key:"_measurePaneHeight",value:function(){var t=this,e=this._chartStore.styleOptions(),i=this._container.offsetHeight,r=e.separator.size,n=r*this._separators.size,a=this._xAxisPane.xAxis().getSelfHeight(),o=i-a-n,s=0;this._panes.forEach((function(t){if(t.id()!==pr){var e=t.height();s+e>o?(t.setHeight(o-s),s=o):s+=e}}));var c=o-s,h={};h.candle_pane={contentTop:0,contentBottom:c};var l=c,u=c;this._panes.get(pr).setHeight(c),this._chartHeight.candle_pane=c,this._panes.forEach((function(e){if(e.id()!==pr){var i=e.height();u+=i+r,h[e.id()]={contentTop:l,contentBottom:u},t._chartHeight[e.id()]=i,l=u}})),this._xAxisPane.setHeight(a),this._chartHeight.xAxis=a,this._chartHeight.total=i,this._chartEvent.setPaneContentSize(h),this._chartEvent.setChartContentTopBottom({contentTop:0,contentBottom:u})}},{key:"_measurePaneWidth",value:function(){var t,e,i,r=this,n=this._chartStore.styleOptions().yAxis,a=n.position===O,o=this._container.offsetWidth,s=Number.MIN_SAFE_INTEGER;n.inside?(t=o,s=o,e=0,i=0):(this._panes.forEach((function(t){s=Math.max(s,t.yAxis().getSelfWidth())})),t=o-s,a?(e=0,i=s):(i=0,e=o-s)),this._chartStore.timeScaleStore().setTotalDataSpace(t),this._panes.forEach((function(n,a){n.setWidth(t,s),n.setOffsetLeft(i,e);var o=r._separators.get(a);o&&o.setSize(i,t)})),this._chartWidth={content:t,yAxis:s,total:o},this._xAxisPane.setWidth(t,s),this._xAxisPane.setOffsetLeft(i,e),this._chartEvent.setChartContentLeftRight({contentLeft:i,contentRight:i+t})}},{key:"adjustPaneViewport",value:function(t,e,i,r,n){t&&this._measurePaneHeight();var a=!1;r&&this._panes.forEach((function(t){var e=t.yAxis().computeAxis(n);a||(a=e)})),(!r&&e||r&&a)&&this._measurePaneWidth(),i&&(this._xAxisPane.xAxis().computeAxis(!0),this._xAxisPane.layout(),this._panes.forEach((function(t){t.layout()})))}},{key:"hasPane",value:function(t){return this._panes.has(t)}},{key:"getPane",value:function(t){return this._panes.get(t)}},{key:"chartStore",value:function(){return this._chartStore}},{key:"removeTechnicalIndicator",value:function(t,e){var i=this;if(this._chartStore.technicalIndicatorStore().removeInstance(t,e)){var r=!1;if(t!==pr&&!this._chartStore.technicalIndicatorStore().hasInstance(t)){r=!0,this._panes.get(t).destroy();var n=this._separators.get(t).topPaneId();this._separators.get(t).destroy(),this._panes.delete(t),this._separators.delete(t),this._separators.forEach((function(t){var e=t.topPaneId();i._separators.has(e)||t.updatePaneId(n)}))}this.adjustPaneViewport(r,!0,!0,!0,!0)}}},{key:"createTechnicalIndicator",value:function(t,e){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._panes.has(r.id)){var n=this._chartStore.technicalIndicatorStore().addInstance(r.id,t,e);return n&&n.finally((function(t){i.setPaneOptions(r,i._panes.get(r.id).yAxis().computeAxis())})),r.id}var a=r.id||"".concat(vr).concat(++this._paneBaseId),o=!A(r.dragEnabled)||r.dragEnabled;this._separators.set(a,new Wi(this._chartContainer,this._chartStore,Array.from(this._panes.keys()).pop(),a,o,{startDrag:this._separatorStartDrag.bind(this),drag:sr(this._separatorDrag.bind(this),50)}));var s=new fi({container:this._chartContainer,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),id:a,height:r.height||100});this._panes.set(a,s);var c=this._chartStore.technicalIndicatorStore().addInstance(a,t,e);return c&&c.finally((function(t){i.adjustPaneViewport(!0,!0,!0,!0,!0)})),a}},{key:"createShape",value:function(t,e,i){var r=e.points,n=e.styles,a=e.lock,o=e.mode,s=e.data,c=e.onDrawStart,h=e.onDrawing,l=e.onDrawEnd,u=e.onClick,f=e.onRightClick,d=e.onPressedMove,v=e.onMouseEnter,p=e.onMouseLeave,y=e.onRemove,_=e.id||"".concat("shape_").concat(++this._shapeBaseId);if(!this._chartStore.shapeStore().hasInstance(_)){var m=null;this.hasPane(i)?m=this._panes.get(i).yAxis():r&&r.length>0&&(i=pr,m=this._panes.get(pr).yAxis());var g=new t({id:_,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),yAxis:m,points:r,styles:n,lock:a,mode:o,data:s});return k(c)&&c({id:_}),Tt(g,[{key:"onDrawing",fn:h},{key:"onDrawEnd",fn:l},{key:"onClick",fn:u},{key:"onRightClick",fn:f},{key:"onPressedMove",fn:d},{key:"onMouseEnter",fn:v},{key:"onMouseLeave",fn:p},{key:"onRemove",fn:y}]),this._chartStore.shapeStore().addInstance(g,i),_}return null}},{key:"createAnnotation",value:function(t,e){var i=this,r=[];t.forEach((function(t){var n=t.point,a=t.styles,o=t.checkEventCoordinateOnCustomSymbol,s=t.drawCustomSymbol,c=t.drawExtend,h=t.onClick,l=t.onRightClick,u=t.onMouseEnter,f=t.onMouseLeave;if(n&&n.timestamp){var d=new hr({id:n.timestamp,chartStore:i._chartStore,point:n,xAxis:i._xAxisPane.xAxis(),yAxis:i._panes.get(e).yAxis(),styles:a});Tt(d,[{key:"drawExtend",fn:c},{key:"drawCustomSymbol",fn:s},{key:"checkEventCoordinateOnCustomSymbol",fn:o},{key:"onClick",fn:h},{key:"onRightClick",fn:l},{key:"onMouseEnter",fn:u},{key:"onMouseLeave",fn:f}]),r.push(d)}})),r.length>0&&this._chartStore.annotationStore().add(r,e)}},{key:"createTag",value:function(t,e){var i=this,r=[],n=!1,a=!1;t.forEach((function(t){var o=t.id,s=t.point,c=t.text,h=t.mark,l=t.styles;if(C(o))if(i._chartStore.tagStore().has(o,e)){var u=i._chartStore.tagStore().update(o,e,{point:s,text:c,mark:h,styles:l});n||(n=u)}else a=!0,r.push(new ur({id:o,point:s,text:c,mark:h,styles:l,chartStore:i._chartStore,xAxis:i._xAxisPane.xAxis(),yAxis:i._panes.get(e).yAxis()}))})),a?this._chartStore.tagStore().add(r,e):n&&this._invalidatePane(pe)}},{key:"removeAllHtml",value:function(){this._panes.forEach((function(t){t.removeHtml()})),this._xAxisPane.removeHtml()}},{key:"setPaneOptions",value:function(t,e){var i=e,r=!1;if(t.id!==pr){var n=this._panes.get(t.id);n&&(w(t.height)&&t.height>0&&n.height()!==t.height&&(i=!0,n.setHeight(t.height),r=!0),A(t.dragEnabled)&&this._separators.get(t.id).setDragEnabled(t.dragEnabled))}i&&this.adjustPaneViewport(r,!0,!0,!0,!0)}},{key:"setTimezone",value:function(t){this._chartStore.timeScaleStore().setTimezone(t),this._xAxisPane.xAxis().computeAxis(!0),this._xAxisPane.invalidate(_e)}},{key:"convertToPixel",value:function(t,e){var i,r=this,n=e.paneId,a=void 0===n?pr:n,o=e.absoluteYAxis,s=[].concat(t),c=[],h=this._chartStore.styleOptions().separator.size,l=0,u=fr(this._panes.values());try{var f=function(){var t=i.value;if(t.id()===a)return c=s.map((function(e){var i=e.timestamp,n=e.value,a={},s=e.dataIndex;if(C(i)&&(s=r._chartStore.timeScaleStore().timestampToDataIndex(i)),C(s)&&(a.x=r._xAxisPane.xAxis().convertToPixel(s)),C(n)){var c=t.yAxis().convertToPixel(n);a.y=o?l+c:c}return a})),"break";l+=t.height()+h};for(u.s();!(i=u.n()).done;)if("break"===f())break}catch(t){u.e(t)}finally{u.f()}return S(t)?c:c[0]||{}}},{key:"convertFromPixel",value:function(t,e){var i,r=this,n=e.paneId,a=void 0===n?pr:n,o=e.absoluteYAxis,s=[].concat(t),c=[],h=this._chartStore.styleOptions().separator.size,l=0,u=fr(this._panes.values());try{var f=function(){var t=i.value;if(t.id()===a)return c=s.map((function(e){var i=e.x,n=e.y,a={};if(C(i)&&(a.dataIndex=r._xAxisPane.xAxis().convertFromPixel(i),a.timestamp=r._chartStore.timeScaleStore().dataIndexToTimestamp(a.dataIndex)),C(n)){var s=o?n-l:n;a.value=t.yAxis().convertFromPixel(s)}return a})),"break";l+=t.height()+h};for(u.s();!(i=u.n()).done;)if("break"===f())break}catch(t){u.e(t)}finally{u.f()}return S(t)?c:c[0]||{}}},{key:"chartWidth",value:function(){return this._chartWidth}},{key:"chartHeight",value:function(){return this._chartHeight}},{key:"getConvertPictureUrl",value:function(t,e,i){var r=this,n=this._chartContainer.offsetWidth,a=this._chartContainer.offsetHeight,o=Fe("canvas",{width:"".concat(n,"px"),height:"".concat(a,"px"),boxSizing:"border-box"}),s=o.getContext("2d"),c=Kt(o);o.width=n*c,o.height=a*c,s.scale(c,c),s.fillStyle=i,s.fillRect(0,0,n,a);var h=0;return this._panes.forEach((function(e,i){if(i!==pr){var a=r._separators.get(i);s.drawImage(a.getImage(),0,h,n,a.height()),h+=a.height()}s.drawImage(e.getImage(t),0,h,n,e.height()),h+=e.height()})),s.drawImage(this._xAxisPane.getImage(t),0,h,n,this._xAxisPane.height()),o.toDataURL("image/".concat(e))}},{key:"destroy",value:function(){this._panes.forEach((function(t){t.destroy()})),this._separators.forEach((function(t){t.destroy()})),this._panes.clear(),this._separators.clear(),this._xAxisPane.destroy(),this._container.removeChild(this._chartContainer),this._chartEvent.destroy()}}]),t}(),_r=function(){function t(e,i){p(this,t),this._chartPane=new yr(e,i)}return _(t,[{key:"getWidth",value:function(){return this._chartPane.chartWidth()}},{key:"getHeight",value:function(){return this._chartPane.chartHeight()}},{key:"setStyleOptions",value:function(t){b(t)&&(this._chartPane.chartStore().applyStyleOptions(t),this._chartPane.adjustPaneViewport(!0,!0,!0,!0,!0))}},{key:"getStyleOptions",value:function(){return x(this._chartPane.chartStore().styleOptions())}},{key:"setPriceVolumePrecision",value:function(t,e){w(t)&&t>=0&&w(e)&&e>=0&&this._chartPane.chartStore().setPriceVolumePrecision(t,e)}},{key:"setTimezone",value:function(t){this._chartPane.setTimezone(t)}},{key:"getTimezone",value:function(){return this._chartPane.chartStore().timeScaleStore().timezone()}},{key:"resize",value:function(){this._chartPane.adjustPaneViewport(!0,!0,!0,!0,!0)}},{key:"setOffsetRightSpace",value:function(t){w(t)&&this._chartPane.chartStore().timeScaleStore().setOffsetRightSpace(t,!0)}},{key:"setLeftMinVisibleBarCount",value:function(t){w(t)&&t>0&&this._chartPane.chartStore().timeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))}},{key:"setRightMinVisibleBarCount",value:function(t){w(t)&&t>0&&this._chartPane.chartStore().timeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))}},{key:"setDataSpace",value:function(t){w(t)&&this._chartPane.chartStore().timeScaleStore().setDataSpace(t)}},{key:"getDataSpace",value:function(){return this._chartPane.chartStore().timeScaleStore().dataSpace()}},{key:"getBarSpace",value:function(){return this._chartPane.chartStore().timeScaleStore().barSpace()}},{key:"clearData",value:function(){this._chartPane.chartStore().clearDataList()}},{key:"getDataList",value:function(){return this._chartPane.chartStore().dataList()}},{key:"applyNewData",value:function(t,e){var i=this;if(S(t)){var r=this._chartPane.chartStore();r.clearDataList(),r.addData(t,0,e),r.technicalIndicatorStore().calcInstance().finally((function(t){i._chartPane.adjustPaneViewport(!1,!0,!0,!0)}))}}},{key:"applyMoreData",value:function(t,e){var i=this;if(S(t)){var r=this._chartPane.chartStore();r.addData(t,0,e),r.technicalIndicatorStore().calcInstance().finally((function(t){i._chartPane.adjustPaneViewport(!1,!0,!0,!0)}))}}},{key:"updateData",value:function(t){var e=this;if(b(t)&&!S(t)){var i=this._chartPane.chartStore(),r=i.dataList(),n=r.length,a=it(t,"timestamp",0),o=it(r[n-1],"timestamp",0);if(a>=o){var s=n;a===o&&(s=n-1),i.addData(t,s),i.technicalIndicatorStore().calcInstance().finally((function(t){e._chartPane.adjustPaneViewport(!1,!0,!0,!0)}))}}}},{key:"loadMore",value:function(t){k(t)&&this._chartPane.chartStore().timeScaleStore().setLoadMoreCallback(t)}},{key:"createTechnicalIndicator",value:function(t,e,i){if(!C(t))return null;var r=b(t)&&!S(t)?t:{name:t};return this._chartPane.chartStore().technicalIndicatorStore().hasTemplate(r.name)?this._chartPane.createTechnicalIndicator(r,e,i):null}},{key:"addTechnicalIndicatorTemplate",value:function(t){if(b(t)){var e=[].concat(t);this._chartPane.chartStore().technicalIndicatorStore().addTemplate(e)}}},{key:"overrideTechnicalIndicator",value:function(t,e){var i=this;if(b(t)&&!S(t)){var r=this._chartPane.chartStore().technicalIndicatorStore().override(t,e);r&&r.then((function(t){i._chartPane.adjustPaneViewport(!1,!0,!0,!0)}))}}},{key:"getTechnicalIndicatorTemplate",value:function(t){return this._chartPane.chartStore().technicalIndicatorStore().getTemplateInfo(t)}},{key:"getTechnicalIndicatorByPaneId",value:function(t,e){return this._chartPane.chartStore().technicalIndicatorStore().getInstanceInfo(t,e)}},{key:"removeTechnicalIndicator",value:function(t,e){this._chartPane.removeTechnicalIndicator(t,e)}},{key:"addShapeTemplate",value:function(t){if(b(t)){var e=[].concat(t);this._chartPane.chartStore().shapeStore().addTemplate(e)}}},{key:"createShape",value:function(t,e){if(!C(t))return null;var i=b(t)&&!S(t)?t:{name:t},r=this._chartPane.chartStore().shapeStore().getTemplate(i.name);return r?this._chartPane.createShape(r,i,e):null}},{key:"getShape",value:function(t){return this._chartPane.chartStore().shapeStore().getInstanceInfo(t)}},{key:"setShapeOptions",value:function(t){b(t)&&!S(t)&&this._chartPane.chartStore().shapeStore().setInstanceOptions(t)}},{key:"removeShape",value:function(t){this._chartPane.chartStore().shapeStore().removeInstance(t)}},{key:"createAnnotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr;if(b(t)&&this._chartPane.hasPane(e)){var i=[].concat(t);this._chartPane.createAnnotation(i,e)}}},{key:"removeAnnotation",value:function(t,e){this._chartPane.chartStore().annotationStore().remove(t,e)}},{key:"createTag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr;if(b(t)&&this._chartPane.hasPane(e)){var i=[].concat(t);this._chartPane.createTag(i,e)}}},{key:"removeTag",value:function(t,e){this._chartPane.chartStore().tagStore().remove(t,e)}},{key:"createHtml",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr;if(!b(t))return null;if(!(E(t.content)||t.content instanceof HTMLElement))return null;var i=this._chartPane.getPane(e);return i?i.createHtml(t):null}},{key:"removeHtml",value:function(t,e){if(t){var i=this._chartPane.getPane(t);i&&i.removeHtml(e)}else this._chartPane.removeAllHtml()}},{key:"setPaneOptions",value:function(t){b(t)&&this._chartPane.setPaneOptions(t,!1)}},{key:"setZoomEnabled",value:function(t){this._chartPane.chartStore().timeScaleStore().setZoomEnabled(t)}},{key:"isZoomEnabled",value:function(){return this._chartPane.chartStore().timeScaleStore().zoomEnabled()}},{key:"setScrollEnabled",value:function(t){this._chartPane.chartStore().timeScaleStore().setScrollEnabled(t)}},{key:"isScrollEnabled",value:function(){return this._chartPane.chartStore().timeScaleStore().scrollEnabled()}},{key:"scrollByDistance",value:function(t,e){var i=this;if(w(t))if(w(e)&&e>0){this._chartPane.chartStore().timeScaleStore().startScroll();var r=(new Date).getTime();!function n(){var a=((new Date).getTime()-r)/e,o=a>=1,s=o?t:t*a;i._chartPane.chartStore().timeScaleStore().scroll(s),o||je(n)}()}else this._chartPane.chartStore().timeScaleStore().startScroll(),this._chartPane.chartStore().timeScaleStore().scroll(t)}},{key:"scrollToRealTime",value:function(t){var e=(this._chartPane.chartStore().timeScaleStore().offsetRightBarCount()-this._chartPane.chartStore().timeScaleStore().offsetRightSpace()/this._chartPane.chartStore().timeScaleStore().dataSpace())*this._chartPane.chartStore().timeScaleStore().dataSpace();this.scrollByDistance(e,t)}},{key:"scrollToDataIndex",value:function(t,e){if(w(t)){var i=(this._chartPane.chartStore().dataList().length-1-t)*this._chartPane.chartStore().timeScaleStore().dataSpace();this.scrollByDistance(i,e)}}},{key:"zoomAtCoordinate",value:function(t,e,i){var r=this;if(w(t))if(w(i)&&i>0){var n=this._chartPane.chartStore().timeScaleStore().dataSpace(),a=n*t-n,o=(new Date).getTime();!function t(){var s=((new Date).getTime()-o)/i,c=s>=1,h=c?a:a*s;r._chartPane.chartStore().timeScaleStore().zoom(h/n,e),c||je(t)}()}else this._chartPane.chartStore().timeScaleStore().zoom(t,e)}},{key:"zoomAtDataIndex",value:function(t,e,i){if(w(t)&&w(e)){var r=this._chartPane.chartStore().timeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:r},i)}}},{key:"convertToPixel",value:function(t,e){return this._chartPane.convertToPixel(t,e)}},{key:"convertFromPixel",value:function(t,e){return this._chartPane.convertFromPixel(t,e)}},{key:"subscribeAction",value:function(t,e){this._chartPane.chartStore().actionStore().subscribe(t,e)}},{key:"unsubscribeAction",value:function(t,e){this._chartPane.chartStore().actionStore().unsubscribe(t,e)}},{key:"getConvertPictureUrl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jpeg",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#FFFFFF";if("png"===e||"jpeg"===e||"bmp"===e)return this._chartPane.getConvertPictureUrl(t,e,i)}},{key:"destroy",value:function(){this._chartPane.destroy()}}]),t}(),mr={},gr=1,xr="k_line_chart_",Sr={clone:x,merge:g,isString:E,isNumber:w,isValid:C,isObject:b,isArray:S,isFunction:k,isBoolean:A,formatValue:it,formatPrecision:nt,formatBigNumber:at};v.addTechnicalIndicatorTemplate([{name:"AVP",shortName:"AVP",series:"price",precision:2,plots:[{key:"avp",title:"AVP: ",type:"line"}],calcTechnicalIndicator:function(t){var e=0,i=0;return t.map((function(t){var r={};return e+=t.turnover||0,0!==(i+=t.volume||0)&&(r.avp=e/i),r}))}},e,i,r,{name:"EMV",shortName:"EMV",calcParams:[14,9],plots:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=0,n=0,a=[],o=[];return t.forEach((function(e,s){var c={},h=t[s-1]||e,l=e.high,u=e.low,f=e.turnover||0,d=0;0!==f&&(d=((l+u)/2-(h.high+h.low)/2)*(l-u)/f),a.push(d),r+=d,i[0]-1>s||(c.emv=r,r-=a[s-(i[0]-1)],n+=c.emv,i[0]+i[1]-2>s||(c.maEmv=n/i[1],n-=o[s-(i[1]-1)].emv)),o.push(c)})),o}},{name:"EMA",shortName:"EMA",series:"price",calcParams:[6,12,20],precision:2,shouldCheckParamCount:!1,shouldOhlc:!0,plots:[{key:"ema6",title:"EMA6: ",type:"line"},{key:"ema12",title:"EMA12: ",type:"line"},{key:"ema20",title:"EMA20: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t){return{key:"ema".concat(t),title:"EMA".concat(t,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var i=e.params,r=e.plots,n=0,a=[];return t.map((function(t,e){var o={},s=t.close;return n+=s,i.forEach((function(t,i){t-1>e||(a[i]=e>t-1?(2*s+(t-1)*a[i])/(t+1):n/t,o[r[i].key]=a[i])})),o}))}},{name:"MA",shortName:"MA",series:"price",calcParams:[5,10,30,60],precision:2,shouldCheckParamCount:!1,shouldOhlc:!0,plots:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t){return{key:"ma".concat(t),title:"MA".concat(t,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var i=e.params,r=e.plots,n=[];return t.map((function(e,a){var o={},s=e.close;return i.forEach((function(e,i){n[i]=(n[i]||0)+s,e-1>a||(o[r[i].key]=n[i]/e,n[i]-=t[a-(e-1)].close)})),o}))}},n,{name:"SMA",shortName:"SMA",series:"price",calcParams:[12,2],precision:2,plots:[{key:"sma",title:"SMA: ",type:"line"}],shouldCheckParamCount:!0,shouldOhlc:!0,calcTechnicalIndicator:function(t,e){var i=e.params,r=0,n=0;return t.map((function(t,e){var a={},o=t.close;return r+=o,i[0]-1>e||(a.sma=n=e>i[0]-1?(o*i[1]+n*(i[0]-i[1]+1))/(i[0]+1):r/i[0]),a}))}},{name:"TRIX",shortName:"TRIX",calcParams:[12,9],plots:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i,r,n,a=e.params,o=0,s=0,c=0,h=0,l=[];return t.forEach((function(t,e){var u={},f=t.close;if(o+=f,e>=a[0]-1&&(s+=i=e>a[0]-1?(2*f+(a[0]-1)*i)/(a[0]+1):o/a[0],e>=2*a[0]-2&&(c+=r=e>2*a[0]-2?(2*i+(a[0]-1)*r)/(a[0]+1):s/a[0],e>=3*a[0]-3))){var d,v=0;e>3*a[0]-3?v=((d=(2*r+(a[0]-1)*n)/(a[0]+1))-n)/n*100:d=c/a[0],n=d,u.trix=v,h+=v,3*a[0]+a[1]-4>e||(u.maTrix=h/a[1],h-=l[e-(a[1]-1)].trix)}l.push(u)})),l}},{name:"BRAR",shortName:"BRAR",calcParams:[26],plots:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=0,n=0,a=0,o=0;return t.map((function(e,s){var c={},h=e.high,l=e.low,u=e.open,f=(t[s-1]||e).close;if(a+=h-u,o+=u-l,r+=h-f,n+=f-l,s>=i[0]-1){c.ar=0!==o?a/o*100:0,c.br=0!==n?r/n*100:0;var d=t[s-(i[0]-1)],v=d.high,p=d.low,y=d.open,_=(t[s-i[0]]||t[s-(i[0]-1)]).close;r-=v-_,n-=_-p,a-=v-y,o-=y-p}return c}))}},a,{name:"MTM",shortName:"MTM",calcParams:[12,6],plots:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=0,n=[];return t.forEach((function(e,a){var o={};a<i[0]||(o.mtm=e.close-t[a-i[0]].close,r+=o.mtm,i[0]+i[1]-1>a||(o.maMtm=r/i[1],r-=n[a-(i[1]-1)].mtm)),n.push(o)})),n}},{name:"PSY",shortName:"PSY",calcParams:[12,6],plots:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=0,n=0,a=[],o=[];return t.forEach((function(e,s){var c={},h=e.close-(t[s-1]||e).close>0?1:0;a.push(h),r+=h,i[0]-1>s||(c.psy=r/i[0]*100,n+=c.psy,i[0]+i[1]-2>s||(c.maPsy=n/i[1],n-=o[s-(i[1]-1)].psy),r-=a[s-(i[0]-1)]),o.push(c)})),o}},{name:"ROC",shortName:"ROC",calcParams:[12,6],shouldCheckParamCount:!0,plots:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=[],n=0;return t.forEach((function(e,a){var o={};if(a>=i[0]-1){var s=(t[a-i[0]]||t[a-(i[0]-1)]).close;o.roc=0!==s?(e.close-s)/s*100:0,n+=o.roc,i[0]-1+i[1]-1>a||(o.maRoc=n/i[1],n-=r[a-(i[1]-1)].roc)}r.push(o)})),r}},{name:"VR",shortName:"VR",calcParams:[26,6],plots:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=0,n=0,a=0,o=0,s=[];return t.forEach((function(e,c){var h={},l=e.close,u=(t[c-1]||e).close,f=e.volume;if(l>u?r+=f:u>l?n+=f:a+=f,c>=i[0]-1){var d=a/2;h.vr=n+d===0?0:(r+d)/(n+d)*100,o+=h.vr,i[0]+i[1]-2>c||(h.maVr=o/i[1],o-=s[c-(i[1]-1)].vr);var v=t[c-(i[0]-1)],p=t[c-i[0]]||v,y=v.close,_=v.volume;y>p.close?r-=_:p.close>y?n-=_:a-=_}s.push(h)})),s}},o,{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],shouldCheckParamCount:!1,plots:[{key:"bias6",title:"BIAS6: ",type:"line"},{key:"bias12",title:"BIAS12: ",type:"line"},{key:"bias24",title:"BIAS24: ",type:"line"}],regeneratePlots:function(t){return t.map((function(t){return{key:"bias".concat(t),title:"BIAS".concat(t,": "),type:"line"}}))},calcTechnicalIndicator:function(t,e){var i=e.params,r=e.plots,n=[];return t.map((function(e,a){var o={},s=e.close;return i.forEach((function(e,c){if(n[c]=(n[c]||0)+s,a>=e-1){var h=n[c]/i[c];o[r[c].key]=(s-h)/h*100,n[c]-=t[a-(e-1)].close}})),o}))}},s,c,l,u,f,d,{name:"OBV",shortName:"OBV",calcParams:[30],plots:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calcTechnicalIndicator:function(t,e){var i=e.params,r=0,n=0,a=[];return t.forEach((function(e,o){var s=t[o-1]||e;s.close>e.close?n-=e.volume:e.close>s.close&&(n+=e.volume);var c={obv:n};r+=n,i[0]-1>o||(c.maObv=r/i[0],r-=a[o-(i[0]-1)].obv),a.push(c)})),a}},{name:"PVT",shortName:"PVT",plots:[{key:"pvt",title:"PVT: ",type:"line"}],calcTechnicalIndicator:function(t){var e=0;return t.map((function(i,r){var n={},a=(t[r-1]||i).close,o=0;return 0!==a&&(o=(i.close-a)/a*i.volume),n.pvt=e+=o,n}))}},{name:"VOL",shortName:"VOL",series:"volume",calcParams:[5,10,20],shouldCheckParamCount:!1,shouldFormatBigNumber:!0,precision:0,minValue:0,plots:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma20",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,color:function(t,e){var i=t.current.kLineData||{};return i.close>i.open?e.bar.upColor:i.open>i.close?e.bar.downColor:e.bar.noChangeColor}}],regeneratePlots:function(t){var e=t.map((function(t){return{key:"ma".concat(t),title:"MA".concat(t,": "),type:"line"}}));return e.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,color:function(t,e){var i=t.current.kLineData||{};return i.close>i.open?e.bar.upColor:i.open>i.close?e.bar.downColor:e.bar.noChangeColor}}),e},calcTechnicalIndicator:function(t,e){var i=e.params,r=e.plots,n=[];return t.map((function(e,a){var o=e.volume||0,s={volume:o};return i.forEach((function(e,i){n[i]=(n[i]||0)+o,e-1>a||(s[r[i].key]=n[i]/e,n[i]-=t[a-(e-1)].volume)})),s}))}}]),v.addShapeTemplate([{name:"horizontalRayLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return zt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,i={x:0,y:e[0].y};return e[1]&&e[1].x>e[0].x&&(i.x=t.viewport.width),[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[e[0],i]]}]},performEventPressedMove:function(t){var e=t.points,i=t.pressPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){2===t.step&&(t.points[0].value=t.movePoint.value)}},{name:"horizontalSegment",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Vt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,i=[];return 2===e.length&&(i=[e]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:i}]},performEventPressedMove:function(t){var e=t.points,i=t.pressPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){2===t.step&&(t.points[0].value=t.movePoint.value)}},{name:"horizontalStraightLine",totalStep:2,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Ft(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:0,y:e[0].y},{x:t.viewport.width,y:e[0].y}]]}]}},{name:"verticalRayLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return zt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,i={x:e[0].x,y:0};return e[1]&&e[1].y>e[0].y&&(i.y=t.viewport.height),[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[e[0],i]]}]},performEventPressedMove:function(t){var e=t.points,i=t.pressPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.points,i=t.movePoint;2===t.step&&(e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex)}},{name:"verticalSegment",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Vt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,i=[];return 2===e.length&&(i=[e]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:i}]},performEventPressedMove:function(t){var e=t.points,i=t.pressPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.points,i=t.movePoint;2===t.step&&(e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex)}},{name:"verticalStraightLine",totalStep:2,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Ft(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:e[0].x,y:0},{x:e[0].x,y:t.viewport.height}]]}]}},{name:"rayLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return zt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e,i,r,n=t.coordinates,a=t.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[(e=n[0],i=n[1],r={x:a.width,y:a.height},e&&i?[e,e.x===i.x&&e.y!==i.y?i.y>e.y?{x:e.x,y:r.y}:{x:e.x,y:0}:e.x>i.x?{x:0,y:Rt(e,i,{x:0,y:e.y})}:{x:r.x,y:Rt(e,i,{x:r.x,y:e.y})}]:[])]}]}},{name:"segment",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Vt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,i=[];return 2===e.length&&(i=[e]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:i}]}},{name:"straightLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Ft(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,i=t.viewport;return 2>e.length||e[0].x===e[1].x?[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]]}]:[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:0,y:Rt(e[0],e[1],{x:0,y:e[0].y})},{x:i.width,y:Rt(e[0],e[1],{x:i.width,y:e[0].y})}]]}]}},{name:"parallelStraightLine",totalStep:4,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Ft(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:jt(t.coordinates,{x:e.width,y:e.height})}]}},{name:"priceChannelLine",totalStep:4,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Ft(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:jt(t.coordinates,{x:e.width,y:e.height},1)}]}},{name:"priceLine",totalStep:2,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return zt(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.coordinates,i=t.precision;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[e[0],{x:t.viewport.width,y:e[0].y}]]},{type:"text",isDraw:!0,isCheck:!1,dataSource:[{x:e[0].x,y:e[0].y,text:t.yAxis.convertFromPixel(e[0].y).toFixed(i.price)}]}]}},{name:"fibonacciLine",totalStep:3,checkEventCoordinateOnShape:function(t){var e=t.dataSource;return Ft(e[0],e[1],t.eventCoordinate)},createShapeDataSource:function(t){var e=t.points,i=t.coordinates,r=t.precision;if(i.length>0){var n=[],a=[],o=t.viewport.width;if(i.length>1){var s=i[0].y-i[1].y,c=e[0].value-e[1].value;[1,.786,.618,.5,.382,.236,0].forEach((function(t){var h=i[1].y+s*t,l=(e[1].value+c*t).toFixed(r.price);n.push([{x:0,y:h},{x:o,y:h}]),a.push({x:0,y:h,text:"".concat(l," (").concat((100*t).toFixed(1),"%)")})}))}return[{type:"line",isDraw:!0,isCheck:!0,dataSource:n},{type:"text",isDraw:!0,isCheck:!1,dataSource:a}]}return[]}}]),t.dispose=function(t){if(t){var e;if(E(t)){var i=document.getElementById(t);e=i&&i.chartId}else e=t instanceof _r?t.id:t&&t.chartId;e&&(mr[e].destroy(),delete mr[e])}},t.extension=v,t.init=function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return null;if(!(e=E(t)?document.getElementById(t):t))return null;var r=mr[e.chartId||""];if(r)return r;var n="".concat(xr).concat(gr++);return(r=new _r(e,i)).id=n,e.chartId=n,mr[n]=r,r},t.utils=Sr,t.version=function(){return"8.3.1"},Object.defineProperty(t,"__esModule",{value:!0})}))},"72f7":function(t,e,i){"use strict";var r=i("ebb5").exportTypedArrayMethod,n=i("d039"),a=i("da84"),o=i("e330"),s=a.Uint8Array,c=s&&s.prototype||{},h=[].toString,l=o([].join);n((function(){h.call({})}))&&(h=function(){return l(this)});var u=c.toString!=h;r("toString",h,u)},"735e":function(t,e,i){"use strict";var r=i("ebb5"),n=i("c65b"),a=i("81d5"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("fill",(function(t){var e=arguments.length;return n(a,o(this),t,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}))},"74e8":function(t,e,i){"use strict";var r=i("23e7"),n=i("da84"),a=i("c65b"),o=i("83ab"),s=i("8aa7"),c=i("ebb5"),h=i("621a"),l=i("19aa"),u=i("5c6c"),f=i("9112"),d=i("eac50"),v=i("50c4"),p=i("0b25"),y=i("182d"),_=i("a04b"),m=i("1a2d"),g=i("f5df"),x=i("861d"),S=i("d9b5"),k=i("7c73"),b=i("3a9b"),w=i("d2bb"),C=i("241c").f,A=i("a078"),E=i("b727").forEach,P=i("2626"),M=i("9bf2"),T=i("06cf"),I=i("69f3"),O=i("7156"),D=I.get,L=I.set,R=M.f,B=T.f,F=Math.round,z=n.RangeError,V=h.ArrayBuffer,N=V.prototype,j=h.DataView,H=c.NATIVE_ARRAY_BUFFER_VIEWS,Y=c.TYPED_ARRAY_CONSTRUCTOR,W=c.TYPED_ARRAY_TAG,U=c.TypedArray,X=c.TypedArrayPrototype,G=c.aTypedArrayConstructor,K=c.isTypedArray,Z="BYTES_PER_ELEMENT",J="Wrong length",$=function(t,e){G(t);var i=0,r=e.length,n=new t(r);while(r>i)n[i]=e[i++];return n},q=function(t,e){R(t,e,{get:function(){return D(this)[e]}})},Q=function(t){var e;return b(N,t)||"ArrayBuffer"==(e=g(t))||"SharedArrayBuffer"==e},tt=function(t,e){return K(t)&&!S(e)&&e in t&&d(+e)&&e>=0},et=function(t,e){return e=_(e),tt(t,e)?u(2,t[e]):B(t,e)},it=function(t,e,i){return e=_(e),!(tt(t,e)&&x(i)&&m(i,"value"))||m(i,"get")||m(i,"set")||i.configurable||m(i,"writable")&&!i.writable||m(i,"enumerable")&&!i.enumerable?R(t,e,i):(t[e]=i.value,t)};o?(H||(T.f=et,M.f=it,q(X,"buffer"),q(X,"byteOffset"),q(X,"byteLength"),q(X,"length")),r({target:"Object",stat:!0,forced:!H},{getOwnPropertyDescriptor:et,defineProperty:it}),t.exports=function(t,e,i){var o=t.match(/\d+$/)[0]/8,c=t+(i?"Clamped":"")+"Array",h="get"+t,u="set"+t,d=n[c],_=d,m=_&&_.prototype,g={},S=function(t,e){var i=D(t);return i.view[h](e*o+i.byteOffset,!0)},b=function(t,e,r){var n=D(t);i&&(r=(r=F(r))<0?0:r>255?255:255&r),n.view[u](e*o+n.byteOffset,r,!0)},M=function(t,e){R(t,e,{get:function(){return S(this,e)},set:function(t){return b(this,e,t)},enumerable:!0})};H?s&&(_=e((function(t,e,i,r){return l(t,m),O(function(){return x(e)?Q(e)?void 0!==r?new d(e,y(i,o),r):void 0!==i?new d(e,y(i,o)):new d(e):K(e)?$(_,e):a(A,_,e):new d(p(e))}(),t,_)})),w&&w(_,U),E(C(d),(function(t){t in _||f(_,t,d[t])})),_.prototype=m):(_=e((function(t,e,i,r){l(t,m);var n,s,c,h=0,u=0;if(x(e)){if(!Q(e))return K(e)?$(_,e):a(A,_,e);n=e,u=y(i,o);var f=e.byteLength;if(void 0===r){if(f%o)throw z(J);if(s=f-u,s<0)throw z(J)}else if(s=v(r)*o,s+u>f)throw z(J);c=s/o}else c=p(e),s=c*o,n=new V(s);L(t,{buffer:n,byteOffset:u,byteLength:s,length:c,view:new j(n)});while(h<c)M(t,h++)})),w&&w(_,U),m=_.prototype=k(X)),m.constructor!==_&&f(m,"constructor",_),f(m,Y,_),W&&f(m,W,c),g[c]=_,r({global:!0,forced:_!=d,sham:!H},g),Z in _||f(_,Z,o),Z in m||f(m,Z,o),P(c)}):t.exports=function(){}},"77a7":function(t,e,i){var r=i("da84"),n=r.Array,a=Math.abs,o=Math.pow,s=Math.floor,c=Math.log,h=Math.LN2,l=function(t,e,i){var r,l,u,f=n(i),d=8*i-e-1,v=(1<<d)-1,p=v>>1,y=23===e?o(2,-24)-o(2,-77):0,_=t<0||0===t&&1/t<0?1:0,m=0;t=a(t),t!=t||t===1/0?(l=t!=t?1:0,r=v):(r=s(c(t)/h),u=o(2,-r),t*u<1&&(r--,u*=2),t+=r+p>=1?y/u:y*o(2,1-p),t*u>=2&&(r++,u/=2),r+p>=v?(l=0,r=v):r+p>=1?(l=(t*u-1)*o(2,e),r+=p):(l=t*o(2,p-1)*o(2,e),r=0));while(e>=8)f[m++]=255&l,l/=256,e-=8;r=r<<e|l,d+=e;while(d>0)f[m++]=255&r,r/=256,d-=8;return f[--m]|=128*_,f},u=function(t,e){var i,r=t.length,n=8*r-e-1,a=(1<<n)-1,s=a>>1,c=n-7,h=r-1,l=t[h--],u=127&l;l>>=7;while(c>0)u=256*u+t[h--],c-=8;i=u&(1<<-c)-1,u>>=-c,c+=e;while(c>0)i=256*i+t[h--],c-=8;if(0===u)u=1-s;else{if(u===a)return i?NaN:l?-1/0:1/0;i+=o(2,e),u-=s}return(l?-1:1)*i*o(2,u-e)};t.exports={pack:l,unpack:u}},"81d5":function(t,e,i){"use strict";var r=i("7b0b"),n=i("23cb"),a=i("07fa");t.exports=function(t){var e=r(this),i=a(e),o=arguments.length,s=n(o>1?arguments[1]:void 0,i),c=o>2?arguments[2]:void 0,h=void 0===c?i:n(c,i);while(h>s)e[s++]=t;return e}},"82f8":function(t,e,i){"use strict";var r=i("ebb5"),n=i("4d64").includes,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("includes",(function(t){return n(a(this),t,arguments.length>1?arguments[1]:void 0)}))},"8aa7":function(t,e,i){var r=i("da84"),n=i("d039"),a=i("1c7e"),o=i("ebb5").NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,c=r.Int8Array;t.exports=!o||!n((function(){c(1)}))||!n((function(){new c(-1)}))||!a((function(t){new c,new c(null),new c(1.5),new c(t)}),!0)||n((function(){return 1!==new c(new s(2),1,void 0).length}))},"907a":function(t,e,i){"use strict";var r=i("ebb5"),n=i("07fa"),a=i("5926"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("at",(function(t){var e=o(this),i=n(e),r=a(t),s=r>=0?r:i+r;return s<0||s>=i?void 0:e[s]}))},"9a8c":function(t,e,i){"use strict";var r=i("e330"),n=i("ebb5"),a=i("145e"),o=r(a),s=n.aTypedArray,c=n.exportTypedArrayMethod;c("copyWithin",(function(t,e){return o(s(this),t,e,arguments.length>2?arguments[2]:void 0)}))},a078:function(t,e,i){var r=i("0366"),n=i("c65b"),a=i("5087"),o=i("7b0b"),s=i("07fa"),c=i("9a1f"),h=i("35a1"),l=i("e95a"),u=i("ebb5").aTypedArrayConstructor;t.exports=function(t){var e,i,f,d,v,p,y=a(this),_=o(t),m=arguments.length,g=m>1?arguments[1]:void 0,x=void 0!==g,S=h(_);if(S&&!l(S)){v=c(_,S),p=v.next,_=[];while(!(d=n(p,v)).done)_.push(d.value)}for(x&&m>2&&(g=r(g,arguments[2])),i=s(_),f=new(u(y))(i),e=0;i>e;e++)f[e]=x?g(_[e],e):_[e];return f}},a3e4:function(t,e,i){},a434:function(t,e,i){"use strict";var r=i("23e7"),n=i("da84"),a=i("23cb"),o=i("5926"),s=i("07fa"),c=i("7b0b"),h=i("65f0"),l=i("8418"),u=i("1dde"),f=u("splice"),d=n.TypeError,v=Math.max,p=Math.min,y=9007199254740991,_="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f},{splice:function(t,e){var i,r,n,u,f,m,g=c(this),x=s(g),S=a(t,x),k=arguments.length;if(0===k?i=r=0:1===k?(i=0,r=x-S):(i=k-2,r=p(v(o(e),0),x-S)),x+i-r>y)throw d(_);for(n=h(g,r),u=0;u<r;u++)f=S+u,f in g&&l(n,u,g[f]);if(n.length=r,i<r){for(u=S;u<x-r;u++)f=u+r,m=u+i,f in g?g[m]=g[f]:delete g[m];for(u=x;u>x-r+i;u--)delete g[u-1]}else if(i>r)for(u=x-r;u>S;u--)f=u+r-1,m=u+i-1,f in g?g[m]=g[f]:delete g[m];for(u=0;u<i;u++)g[u+S]=arguments[u+2];return g.length=x-r+i,n}})},a975:function(t,e,i){"use strict";var r=i("ebb5"),n=i("b727").every,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("every",(function(t){return n(a(this),t,arguments.length>1?arguments[1]:void 0)}))},a981:function(t,e){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},addb:function(t,e,i){var r=i("4dae"),n=Math.floor,a=function(t,e){var i=t.length,c=n(i/2);return i<8?o(t,e):s(t,a(r(t,0,c),e),a(r(t,c),e),e)},o=function(t,e){var i,r,n=t.length,a=1;while(a<n){r=a,i=t[a];while(r&&e(t[r-1],i)>0)t[r]=t[--r];r!==a++&&(t[r]=i)}return t},s=function(t,e,i,r){var n=e.length,a=i.length,o=0,s=0;while(o<n||s<a)t[o+s]=o<n&&s<a?r(e[o],i[s])<=0?e[o++]:i[s++]:o<n?e[o++]:i[s++];return t};t.exports=a},b39a:function(t,e,i){"use strict";var r=i("da84"),n=i("2ba4"),a=i("ebb5"),o=i("d039"),s=i("f36a"),c=r.Int8Array,h=a.aTypedArray,l=a.exportTypedArrayMethod,u=[].toLocaleString,f=!!c&&o((function(){u.call(new c(1))})),d=o((function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()}))||!o((function(){c.prototype.toLocaleString.call([1,2])}));l("toLocaleString",(function(){return n(u,f?s(h(this)):h(this),s(arguments))}),d)},b6b7:function(t,e,i){var r=i("ebb5"),n=i("4840"),a=r.TYPED_ARRAY_CONSTRUCTOR,o=r.aTypedArrayConstructor;t.exports=function(t){return o(n(t,t[a]))}},c1ac:function(t,e,i){"use strict";var r=i("ebb5"),n=i("b727").filter,a=i("1448"),o=r.aTypedArray,s=r.exportTypedArrayMethod;s("filter",(function(t){var e=n(o(this),t,arguments.length>1?arguments[1]:void 0);return a(this,e)}))},c9fd:function(t,e,i){"use strict";t.exports=i("68f9")},ca91:function(t,e,i){"use strict";var r=i("ebb5"),n=i("d58f").left,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("reduce",(function(t){var e=arguments.length;return n(a(this),t,e,e>1?arguments[1]:void 0)}))},cd26:function(t,e,i){"use strict";var r=i("ebb5"),n=r.aTypedArray,a=r.exportTypedArrayMethod,o=Math.floor;a("reverse",(function(){var t,e=this,i=n(e).length,r=o(i/2),a=0;while(a<r)t=e[a],e[a++]=e[--i],e[i]=t;return e}))},d139:function(t,e,i){"use strict";var r=i("ebb5"),n=i("b727").find,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("find",(function(t){return n(a(this),t,arguments.length>1?arguments[1]:void 0)}))},d58f:function(t,e,i){var r=i("da84"),n=i("59ed"),a=i("7b0b"),o=i("44ad"),s=i("07fa"),c=r.TypeError,h=function(t){return function(e,i,r,h){n(i);var l=a(e),u=o(l),f=s(l),d=t?f-1:0,v=t?-1:1;if(r<2)while(1){if(d in u){h=u[d],d+=v;break}if(d+=v,t?d<0:f<=d)throw c("Reduce of empty array with no initial value")}for(;t?d>=0:f>d;d+=v)d in u&&(h=i(h,u[d],d,l));return h}};t.exports={left:h(!1),right:h(!0)}},d5d6:function(t,e,i){"use strict";var r=i("ebb5"),n=i("b727").forEach,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("forEach",(function(t){n(a(this),t,arguments.length>1?arguments[1]:void 0)}))},d998:function(t,e,i){var r=i("342f");t.exports=/MSIE|Trident/.test(r)},dfb9:function(t,e,i){var r=i("07fa");t.exports=function(t,e){var i=0,n=r(e),a=new t(n);while(n>i)a[i]=e[i++];return a}},e58c:function(t,e,i){"use strict";var r=i("2ba4"),n=i("fc6a"),a=i("5926"),o=i("07fa"),s=i("a640"),c=Math.min,h=[].lastIndexOf,l=!!h&&1/[1].lastIndexOf(1,-0)<0,u=s("lastIndexOf"),f=l||!u;t.exports=f?function(t){if(l)return r(h,this,arguments)||0;var e=n(this),i=o(e),s=i-1;for(arguments.length>1&&(s=c(s,a(arguments[1]))),s<0&&(s=i+s);s>=0;s--)if(s in e&&e[s]===t)return s||0;return-1}:h},e91f:function(t,e,i){"use strict";var r=i("ebb5"),n=i("4d64").indexOf,a=r.aTypedArray,o=r.exportTypedArrayMethod;o("indexOf",(function(t){return n(a(this),t,arguments.length>1?arguments[1]:void 0)}))},eac50:function(t,e,i){var r=i("861d"),n=Math.floor;t.exports=Number.isInteger||function(t){return!r(t)&&isFinite(t)&&n(t)===t}},ebb5:function(t,e,i){"use strict";var r,n,a,o=i("a981"),s=i("83ab"),c=i("da84"),h=i("1626"),l=i("861d"),u=i("1a2d"),f=i("f5df"),d=i("0d51"),v=i("9112"),p=i("6eeb"),y=i("9bf2").f,_=i("3a9b"),m=i("e163"),g=i("d2bb"),x=i("b622"),S=i("90e3"),k=c.Int8Array,b=k&&k.prototype,w=c.Uint8ClampedArray,C=w&&w.prototype,A=k&&m(k),E=b&&m(b),P=Object.prototype,M=c.TypeError,T=x("toStringTag"),I=S("TYPED_ARRAY_TAG"),O=S("TYPED_ARRAY_CONSTRUCTOR"),D=o&&!!g&&"Opera"!==f(c.opera),L=!1,R={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},B={BigInt64Array:8,BigUint64Array:8},F=function(t){if(!l(t))return!1;var e=f(t);return"DataView"===e||u(R,e)||u(B,e)},z=function(t){if(!l(t))return!1;var e=f(t);return u(R,e)||u(B,e)},V=function(t){if(z(t))return t;throw M("Target is not a typed array")},N=function(t){if(h(t)&&(!g||_(A,t)))return t;throw M(d(t)+" is not a typed array constructor")},j=function(t,e,i,r){if(s){if(i)for(var n in R){var a=c[n];if(a&&u(a.prototype,t))try{delete a.prototype[t]}catch(o){try{a.prototype[t]=e}catch(h){}}}E[t]&&!i||p(E,t,i?e:D&&b[t]||e,r)}},H=function(t,e,i){var r,n;if(s){if(g){if(i)for(r in R)if(n=c[r],n&&u(n,t))try{delete n[t]}catch(a){}if(A[t]&&!i)return;try{return p(A,t,i?e:D&&A[t]||e)}catch(a){}}for(r in R)n=c[r],!n||n[t]&&!i||p(n,t,e)}};for(r in R)n=c[r],a=n&&n.prototype,a?v(a,O,n):D=!1;for(r in B)n=c[r],a=n&&n.prototype,a&&v(a,O,n);if((!D||!h(A)||A===Function.prototype)&&(A=function(){throw M("Incorrect invocation")},D))for(r in R)c[r]&&g(c[r],A);if((!D||!E||E===P)&&(E=A.prototype,D))for(r in R)c[r]&&g(c[r].prototype,E);if(D&&m(C)!==E&&g(C,E),s&&!u(E,T))for(r in L=!0,y(E,T,{get:function(){return l(this)?this[I]:void 0}}),R)c[r]&&v(c[r],I,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:D,TYPED_ARRAY_CONSTRUCTOR:O,TYPED_ARRAY_TAG:L&&I,aTypedArray:V,aTypedArrayConstructor:N,exportTypedArrayMethod:j,exportTypedArrayStaticMethod:H,isView:F,isTypedArray:z,TypedArray:A,TypedArrayPrototype:E}},f8cd:function(t,e,i){var r=i("da84"),n=i("5926"),a=r.RangeError;t.exports=function(t){var e=n(t);if(e<0)throw a("The argument can't be less than 0");return e}}}]);
//# sourceMappingURL=chunk-f30a5c68.fdbdd714.js.map